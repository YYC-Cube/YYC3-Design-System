{"file":"/Users/yanyu/Downloads/yyc3-Design-System/src/security/XSSProtection.tsx","mappings":"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","names":[],"sources":["/Users/yanyu/Downloads/yyc3-Design-System/src/security/XSSProtection.tsx"],"sourcesContent":["/**\n * @file XSS 防护模块\n * @description 提供 XSS 攻击防护和 HTML 清理功能\n * @module security/XSSProtection\n * @author YYC³\n * @version 1.0.0\n * @created 2026-02-19\n */\n\nimport React, { useMemo, useCallback, useRef } from 'react';\n\ndeclare global {\n  interface Window {\n    DOMPurify?: {\n      sanitize: (source: string, options?: object) => string;\n      addHook: (hookName: string, callback: () => void) => void;\n      removeHook: (hookName: string, callback: () => void) => void;\n    };\n  }\n}\n\nexport interface XSSProtectionConfig {\n  allowedTags?: string[];\n  allowedAttributes?: Record<string, string[]>;\n  allowedSchemes?: string[];\n  allowedScriptHostnames?: string[];\n  allowedScriptDomains?: string[];\n  forceSafeDomain?: boolean;\n  addTags?: string[];\n  addAttributes?: Record<string, string[]>;\n  removeAttributes?: string[];\n  forbidTags?: string[];\n  forbidAttributes?: string[];\n  allowCustomElements?: boolean;\n  allowComments?: boolean;\n  allowUnknownMarkup?: boolean;\n  forbidElements?: string[];\n  ignoreMarkup?: string[];\n}\n\nexport interface XSSContextType {\n  sanitize: (html: string, config?: Partial<XSSProtectionConfig>) => Promise<string>;\n  sanitizeDOM: (element: Element, config?: Partial<XSSProtectionConfig>) => Promise<void>;\n  isSafe: (html: string) => Promise<boolean>;\n  config: XSSProtectionConfig;\n}\n\nconst DEFAULT_CONFIG: XSSProtectionConfig = {\n  allowedTags: [\n    'a',\n    'abbr',\n    'acronym',\n    'address',\n    'area',\n    'article',\n    'aside',\n    'audio',\n    'b',\n    'bdi',\n    'bdo',\n    'blockquote',\n    'br',\n    'button',\n    'canvas',\n    'caption',\n    'cite',\n    'code',\n    'col',\n    'colgroup',\n    'data',\n    'datalist',\n    'dd',\n    'del',\n    'details',\n    'dfn',\n    'dialog',\n    'div',\n    'dl',\n    'dt',\n    'em',\n    'embed',\n    'fieldset',\n    'figcaption',\n    'figure',\n    'footer',\n    'form',\n    'h1',\n    'h2',\n    'h3',\n    'h4',\n    'h5',\n    'h6',\n    'header',\n    'hgroup',\n    'hr',\n    'i',\n    'iframe',\n    'img',\n    'input',\n    'ins',\n    'kbd',\n    'label',\n    'legend',\n    'li',\n    'link',\n    'main',\n    'map',\n    'mark',\n    'menu',\n    'menuitem',\n    'meter',\n    'nav',\n    'noscript',\n    'object',\n    'ol',\n    'optgroup',\n    'option',\n    'output',\n    'p',\n    'param',\n    'picture',\n    'pre',\n    'progress',\n    'q',\n    'rp',\n    'rt',\n    'ruby',\n    's',\n    'samp',\n    'section',\n    'select',\n    'small',\n    'source',\n    'span',\n    'strong',\n    'sub',\n    'summary',\n    'sup',\n    'table',\n    'tbody',\n    'td',\n    'template',\n    'textarea',\n    'tfoot',\n    'th',\n    'thead',\n    'time',\n    'tr',\n    'track',\n    'u',\n    'ul',\n    'var',\n    'video',\n    'wbr',\n  ],\n  allowedAttributes: {\n    '*': ['class', 'id', 'style', 'title', 'lang', 'dir', 'aria-*', 'data-*'],\n    a: ['href', 'target', 'rel', 'type', 'hreflang', 'download', 'referrerpolicy'],\n    img: ['src', 'alt', 'width', 'height', 'loading', 'decoding', 'srcset', 'sizes'],\n    video: ['src', 'poster', 'preload', 'autoplay', 'loop', 'muted', 'controls', 'playsinline'],\n    audio: ['src', 'preload', 'autoplay', 'loop', 'muted', 'controls'],\n    iframe: ['src', 'width', 'height', 'name', 'allow', 'allowfullscreen', 'sandbox'],\n    input: [\n      'type',\n      'name',\n      'value',\n      'placeholder',\n      'required',\n      'disabled',\n      'readonly',\n      'min',\n      'max',\n      'step',\n      'pattern',\n    ],\n    button: ['type', 'name', 'value', 'disabled', 'form'],\n    form: ['action', 'method', 'enctype', 'target', 'autocomplete'],\n    select: ['name', 'required', 'disabled', 'multiple', 'form'],\n    textarea: ['name', 'rows', 'cols', 'placeholder', 'required', 'disabled', 'readonly', 'form'],\n    link: ['rel', 'href', 'type', 'media', 'sizes', 'hreflang'],\n    meta: ['name', 'content', 'http-equiv', 'charset'],\n    source: ['src', 'type', 'media', 'sizes'],\n    track: ['src', 'kind', 'srclang', 'label', 'default'],\n    object: ['data', 'type', 'width', 'height', 'name'],\n    embed: ['src', 'type', 'width', 'height'],\n    col: ['span'],\n    colgroup: ['span'],\n    td: ['colspan', 'rowspan', 'headers'],\n    th: ['colspan', 'rowspan', 'scope', 'headers'],\n    time: ['datetime'],\n    data: ['value'],\n  },\n  allowedSchemes: ['http', 'https', 'mailto', 'tel', 'data', 'sms', 'app', 'blob'],\n  allowCustomElements: false,\n  allowComments: false,\n  allowUnknownMarkup: false,\n};\n\nconst loadDOMPurify = async (): Promise<Window['DOMPurify'] | null> => {\n  if (typeof window !== 'undefined' && window.DOMPurify) {\n    return window.DOMPurify;\n  }\n\n  try {\n    const dompurify = await import('dompurify');\n    const purify =\n      (dompurify as unknown as { default?: Window['DOMPurify'] }).default ||\n      (dompurify as unknown as Window['DOMPurify']);\n    return purify;\n  } catch (error) {\n    console.error('Failed to load DOMPurify:', error);\n    return null;\n  }\n};\n\nexport const XSSContext = React.createContext<XSSContextType | undefined>(undefined);\n\nexport const XSSProvider: React.FC<{\n  children: React.ReactNode;\n  config?: Partial<XSSProtectionConfig>;\n}> = ({ children, config = {} }) => {\n  const currentConfig = useMemo(\n    () => ({\n      ...DEFAULT_CONFIG,\n      ...config,\n    }),\n    [config]\n  );\n\n  const purifyCache = useRef<Window['DOMPurify'] | null>(null);\n\n  const getPurify = useCallback(async () => {\n    if (!purifyCache.current) {\n      purifyCache.current = await loadDOMPurify();\n    }\n    return purifyCache.current;\n  }, []);\n\n  const sanitize = useCallback(\n    async (html: string, customConfig?: Partial<XSSProtectionConfig>): Promise<string> => {\n      const purify = await getPurify();\n      if (!purify) {\n        console.warn('DOMPurify not available, returning original HTML');\n        return html;\n      }\n\n      const mergedConfig = customConfig\n        ? {\n            ...currentConfig,\n            ...customConfig,\n            allowedTags: [...currentConfig.allowedTags!, ...(customConfig.allowedTags || [])],\n            allowedAttributes: {\n              ...currentConfig.allowedAttributes,\n              ...(customConfig.allowedAttributes || {}),\n            },\n          }\n        : currentConfig;\n\n      return purify.sanitize(html, {\n        ALLOWED_TAGS: mergedConfig.allowedTags,\n        ALLOWED_ATTR: Object.values(mergedConfig.allowedAttributes!).flat(),\n        ALLOWED_URI_REGEXP:\n          /^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|data|app|blob):|[^a-z]|[a-z+.-]+(?:[^a-z+.-:]|$))/i,\n        WHOLE_DOCUMENT: false,\n        RETURN_DOM: false,\n        RETURN_DOM_FRAGMENT: false,\n        RETURN_DOM_IMPORT: false,\n        SANITIZE_DOM: true,\n        SAFE_FOR_TEMPLATES: false,\n        SAFE_FOR_JQUERY: true,\n        KEEP_CONTENT: true,\n        USE_PROFILES: { html: true, svg: true, svgFilters: true, mathMl: true },\n        ADD_ATTR: mergedConfig.addAttributes\n          ? Object.values(mergedConfig.addAttributes).flat()\n          : [],\n        ADD_TAGS: mergedConfig.addTags || [],\n        FORBID_ATTR: mergedConfig.removeAttributes || [],\n        FORBID_TAGS: mergedConfig.forbidTags || [],\n        ALLOW_DATA_ATTR: true,\n        ALLOW_UNKNOWN_PROTOCOLS: false,\n        SAFE_JQUERY: true,\n        SANITIZE_NAMED_PROPS: true,\n        HOOKS: {},\n      });\n    },\n    [currentConfig, getPurify]\n  );\n\n  const sanitizeDOM = useCallback(\n    async (element: Element, customConfig?: Partial<XSSProtectionConfig>): Promise<void> => {\n      const purify = await getPurify();\n      if (!purify) {\n        console.warn('DOMPurify not available');\n        return;\n      }\n\n      const html = element.outerHTML;\n      const sanitized = await sanitize(html, customConfig);\n      element.outerHTML = sanitized;\n    },\n    [getPurify, sanitize]\n  );\n\n  const isSafe = useCallback(\n    async (html: string): Promise<boolean> => {\n      const sanitized = await sanitize(html);\n      return sanitized === html;\n    },\n    [sanitize]\n  );\n\n  const value = useMemo(\n    () => ({\n      sanitize,\n      sanitizeDOM,\n      isSafe,\n      config: currentConfig,\n    }),\n    [sanitize, sanitizeDOM, isSafe, currentConfig]\n  );\n\n  return <XSSContext.Provider value={value}>{children}</XSSContext.Provider>;\n};\n\nexport const useXSS = (): XSSContextType => {\n  const context = React.useContext(XSSContext);\n  if (!context) {\n    throw new Error('useXSS must be used within an XSSProvider');\n  }\n  return context;\n};\n\nexport const SafeHTML: React.FC<{\n  html: string;\n  className?: string;\n  config?: Partial<XSSProtectionConfig>;\n  as?: React.ElementType;\n}> = ({ html, className, config, as: Component = 'div' }) => {\n  const { sanitize } = useXSS();\n  const [sanitizedHTML, setSanitizedHTML] = React.useState('');\n\n  React.useEffect(() => {\n    sanitize(html, config).then(setSanitizedHTML);\n  }, [html, config, sanitize]);\n\n  return React.createElement(Component, {\n    className,\n    dangerouslySetInnerHTML: { __html: sanitizedHTML },\n  });\n};\n\nexport const SafeInput: React.FC<{\n  value: string;\n  onChange: (value: string) => void;\n  sanitizeOnInput?: boolean;\n  maxLength?: number;\n  allowedPattern?: RegExp;\n}> = ({ value, onChange, sanitizeOnInput = true, maxLength, allowedPattern }) => {\n  const { sanitize } = useXSS();\n  const [localValue, setLocalValue] = React.useState(value);\n\n  const handleChange = useCallback(\n    async (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n      let newValue = e.target.value;\n\n      if (maxLength && newValue.length > maxLength) {\n        newValue = newValue.substring(0, maxLength);\n      }\n\n      if (allowedPattern && !allowedPattern.test(newValue)) {\n        return;\n      }\n\n      if (sanitizeOnInput) {\n        const sanitized = await sanitize(newValue);\n        setLocalValue(sanitized);\n        onChange(sanitized);\n      } else {\n        setLocalValue(newValue);\n        onChange(newValue);\n      }\n    },\n    [sanitize, sanitizeOnInput, maxLength, allowedPattern, onChange]\n  );\n\n  return <input type=\"text\" value={localValue} onChange={handleChange} maxLength={maxLength} />;\n};\n\nexport const createSafeURL = (\n  url: string,\n  allowedSchemes: string[] = ['http', 'https']\n): string | null => {\n  try {\n    const parsed = new URL(url);\n    if (!allowedSchemes.includes(parsed.protocol.replace(':', ''))) {\n      return null;\n    }\n    return url;\n  } catch {\n    return null;\n  }\n};\n\nexport const validateURL = (url: string): boolean => {\n  try {\n    new URL(url);\n    return true;\n  } catch {\n    return false;\n  }\n};\n\nexport const sanitizeURL = (url: string): string => {\n  const safeURL = createSafeURL(url);\n  return safeURL || 'about:blank';\n};\n\nexport const escapeHTML = (html: string): string => {\n  const div = document.createElement('div');\n  div.textContent = html;\n  return div.innerHTML;\n};\n\nexport const unescapeHTML = (html: string): string => {\n  const textarea = document.createElement('textarea');\n  textarea.innerHTML = html;\n  return textarea.value;\n};\n\nexport const sanitizeAttributeValue = (_attribute: string, value: string): string => {\n  const dangerousPatterns = [/javascript:/i, /data:\\s*text\\/html/i, /vbscript:/i, /on\\w+\\s*=/i];\n\n  for (const pattern of dangerousPatterns) {\n    if (pattern.test(value)) {\n      return '';\n    }\n  }\n\n  return value;\n};\n\nexport const createXSSHook = () => {\n  const originalCreateElement = document.createElement.bind(document);\n  const originalSetAttribute = Element.prototype.setAttribute.bind(Element.prototype);\n\n  return {\n    enable: () => {\n      document.createElement = function (tagName: string, options?: { is?: string }) {\n        const element = originalCreateElement(tagName, options);\n\n        if (tagName.toLowerCase() === 'script') {\n          element.addEventListener('beforescriptexecute', (e: Event) => {\n            e.preventDefault();\n            console.warn('Blocked inline script execution');\n          });\n        }\n\n        return element;\n      };\n\n      Element.prototype.setAttribute = function (this: Element, name: string, value: string) {\n        const sanitized = sanitizeAttributeValue(name, value);\n        originalSetAttribute.call(this, name, sanitized);\n      };\n    },\n    disable: () => {\n      document.createElement = originalCreateElement;\n      Element.prototype.setAttribute = originalSetAttribute;\n    },\n  };\n};\n\nexport const withXSSProtection = <P extends object>(\n  Component: React.ComponentType<P>,\n  config?: Partial<XSSProtectionConfig>\n) => {\n  const WrappedComponent = (props: P) => (\n    <XSSProvider config={config}>\n      <Component {...props} />\n    </XSSProvider>\n  );\n\n  WrappedComponent.displayName = `withXSSProtection(${Component.displayName || Component.name})`;\n  return WrappedComponent;\n};\n\nexport const createStrictConfig = (): XSSProtectionConfig => ({\n  ...DEFAULT_CONFIG,\n  allowedTags: ['p', 'br', 'strong', 'em', 'a', 'ul', 'ol', 'li', 'blockquote', 'code', 'pre'],\n  allowedAttributes: {\n    a: ['href'],\n  },\n  allowedSchemes: ['https', 'mailto'],\n});\n\nexport const createModerateConfig = (): XSSProtectionConfig => DEFAULT_CONFIG;\n\nexport const createPermissiveConfig = (): XSSProtectionConfig => ({\n  ...DEFAULT_CONFIG,\n  allowCustomElements: true,\n  allowComments: true,\n  allowUnknownMarkup: true,\n});\n\nexport default {\n  XSSProvider,\n  useXSS,\n  SafeHTML,\n  SafeInput,\n  createSafeURL,\n  validateURL,\n  sanitizeURL,\n  escapeHTML,\n  unescapeHTML,\n  sanitizeAttributeValue,\n  createXSSHook,\n  withXSSProtection,\n  createStrictConfig,\n  createModerateConfig,\n  createPermissiveConfig,\n};\n"],"version":3}