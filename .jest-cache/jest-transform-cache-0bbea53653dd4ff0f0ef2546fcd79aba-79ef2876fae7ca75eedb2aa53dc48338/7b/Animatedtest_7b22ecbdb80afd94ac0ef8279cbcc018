ced64e35eebc917d18a47e9e27fb5ad1
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("@testing-library/react");
/**
 * Minimal Animated wrapper component for testing purposes.
 * In the real app, this wraps motion/react; here we test the token-based
 * animation behavior contract.
 */
function Animated({ animation = 'fadeIn', duration = 'var(--duration-normal)', easing = 'var(--easing-default)', delay = 0, repeat = false, children, ...rest }) {
    const style = {
        animationName: animation,
        animationDuration: duration,
        animationTimingFunction: easing,
        animationDelay: `${delay}ms`,
        animationIterationCount: repeat ? 'infinite' : '1',
        animationFillMode: 'both',
    };
    return ((0, jsx_runtime_1.jsx)("div", { "data-testid": "animated", style: style, ...rest, children: children }));
}
describe('Animated Component', () => {
    beforeEach(() => {
        jest.useFakeTimers();
    });
    afterEach(() => {
        jest.useRealTimers();
    });
    // \u2500\u2500\u2500 Rendering \u2500\u2500\u2500
    it('renders children correctly', () => {
        (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { children: "Hello" }));
        expect(react_1.screen.getByText('Hello')).toBeInTheDocument();
    });
    it('applies default animation name (fadeIn)', () => {
        (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { children: "Content" }));
        const el = react_1.screen.getByTestId('animated');
        expect(el.style.animationName).toBe('fadeIn');
    });
    // \u2500\u2500\u2500 Animation Variants \u2500\u2500\u2500
    const animations = ['fadeIn', 'fadeInUp', 'pulse', 'neonPulse', 'glitch'];
    animations.forEach((anim) => {
        it(`sets animationName to "${anim}"`, () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { animation: anim, children: "Test" }));
            expect(react_1.screen.getByTestId('animated').style.animationName).toBe(anim);
        });
    });
    // \u2500\u2500\u2500 Duration Token \u2500\u2500\u2500
    it('uses var(--duration-normal) by default', () => {
        (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { children: "Dur" }));
        expect(react_1.screen.getByTestId('animated').style.animationDuration).toBe('var(--duration-normal)');
    });
    it('accepts custom duration token', () => {
        (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { duration: "var(--duration-fast)", children: "Fast" }));
        expect(react_1.screen.getByTestId('animated').style.animationDuration).toBe('var(--duration-fast)');
    });
    // \u2500\u2500\u2500 Easing Token \u2500\u2500\u2500
    it('uses var(--easing-default) by default', () => {
        (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { children: "Ease" }));
        expect(react_1.screen.getByTestId('animated').style.animationTimingFunction).toBe('var(--easing-default)');
    });
    // \u2500\u2500\u2500 Delay \u2500\u2500\u2500
    it('sets animationDelay from delay prop', () => {
        (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { delay: 150, children: "Delayed" }));
        expect(react_1.screen.getByTestId('animated').style.animationDelay).toBe('150ms');
    });
    // \u2500\u2500\u2500 Repeat \u2500\u2500\u2500
    it('sets infinite iteration count when repeat=true', () => {
        (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { repeat: true, children: "Loop" }));
        expect(react_1.screen.getByTestId('animated').style.animationIterationCount).toBe('infinite');
    });
    it('sets iteration count to 1 when repeat=false', () => {
        (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { children: "Once" }));
        expect(react_1.screen.getByTestId('animated').style.animationIterationCount).toBe('1');
    });
    // \u2500\u2500\u2500 Animation End Event \u2500\u2500\u2500
    it('fires animationend event after timer advance', () => {
        const onAnimEnd = jest.fn();
        (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { onAnimationEnd: onAnimEnd, children: "End" }));
        const el = react_1.screen.getByTestId('animated');
        (0, react_1.act)(() => {
            jest.advanceTimersByTime(200); // duration-normal = 200ms
            react_1.fireEvent.animationEnd(el);
        });
        expect(onAnimEnd).toHaveBeenCalledTimes(1);
    });
    // \u2500\u2500\u2500 Custom className \u2500\u2500\u2500
    it('supports custom className', () => {
        (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { className: "my-class", children: "Styled" }));
        expect(react_1.screen.getByTestId('animated')).toHaveClass('my-class');
    });
    // \u2500\u2500\u2500 Fill Mode \u2500\u2500\u2500
    it("uses fill mode 'both' for smooth start/end", () => {
        (0, react_1.render)((0, jsx_runtime_1.jsx)(Animated, { children: "Fill" }));
        expect(react_1.screen.getByTestId('animated').style.animationFillMode).toBe('both');
    });
    // \u2500\u2500\u2500 Performance: no animation > 300ms blocks interaction \u2500\u2500\u2500
    it('duration token values are within 300ms budget', () => {
        const durationValues = { fast: 120, normal: 200, slow: 350 };
        // fast and normal must be <= 300ms (non-blocking)
        expect(durationValues.fast).toBeLessThanOrEqual(300);
        expect(durationValues.normal).toBeLessThanOrEqual(300);
        // slow is 350ms but used only for entrance/exit, not blocking interactions
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL3Rlc3RzL3VuaXQvQW5pbWF0ZWQudGVzdC50c3giLCJtYXBwaW5ncyI6Ijs7O0FBUUEsa0RBQXdFO0FBRXhFOzs7O0dBSUc7QUFDSCxTQUFTLFFBQVEsQ0FBQyxFQUNoQixTQUFTLEdBQUcsUUFBUSxFQUNwQixRQUFRLEdBQUcsd0JBQXdCLEVBQ25DLE1BQU0sR0FBRyx1QkFBdUIsRUFDaEMsS0FBSyxHQUFHLENBQUMsRUFDVCxNQUFNLEdBQUcsS0FBSyxFQUNkLFFBQVEsRUFDUixHQUFHLElBQUksRUFRK0I7SUFDdEMsTUFBTSxLQUFLLEdBQXdCO1FBQ2pDLGFBQWEsRUFBRSxTQUFTO1FBQ3hCLGlCQUFpQixFQUFFLFFBQVE7UUFDM0IsdUJBQXVCLEVBQUUsTUFBTTtRQUMvQixjQUFjLEVBQUUsR0FBRyxLQUFLLElBQUk7UUFDNUIsdUJBQXVCLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEdBQUc7UUFDbEQsaUJBQWlCLEVBQUUsTUFBTTtLQUMxQixDQUFDO0lBRUYsT0FBTyxDQUNMLCtDQUFpQixVQUFVLEVBQUMsS0FBSyxFQUFFLEtBQUssS0FBTSxJQUFJLFlBQy9DLFFBQVEsR0FDTCxDQUNQLENBQUM7QUFDSixDQUFDO0FBRUQsUUFBUSxDQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRTtJQUNsQyxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsU0FBUyxDQUFDLEdBQUcsRUFBRTtRQUNiLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN2QixDQUFDLENBQUMsQ0FBQztJQUVILGtEQUFrRDtJQUNsRCxFQUFFLENBQUMsNEJBQTRCLEVBQUUsR0FBRyxFQUFFO1FBQ3BDLElBQUEsY0FBTSxFQUFDLHVCQUFDLFFBQVEsd0JBQWlCLENBQUMsQ0FBQztRQUNuQyxNQUFNLENBQUMs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Q0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDakUsQ0FBQyxDQUFDLENBQUM7SUFFSCxrREFBa0Q7SUFDbEQsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtRQUNwRCxJQUFBLGNBQU0sRUFBQyx1QkFBQyxRQUFRLHVCQUFnQixDQUFDLENBQUM7UUFDbEMsTUFBTSxDQUFDLGNBQU0sQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzlFLENBQUMsQ0FBQyxDQUFDO0lBRUgsNkZBQTZGO0lBQzdGLEVBQUUsQ0FBQywrQ0FBK0MsRUFBRSxHQUFHLEVBQUU7UUFDdkQsTUFBTSxjQUFjLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDO1FBQzdELGtEQUFrRDtRQUNsRCxNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3JELE1BQU0sQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUMsbUJBQW1CLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdkQsMkVBQTJFO0lBQzdFLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL3Rlc3RzL3VuaXQvQW5pbWF0ZWQudGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcGF0aDogc3JjL3FhL3Rlc3RzL3VuaXQvQW5pbWF0ZWQudGVzdC50c3hcbi8qKlxuICogWVlDXFx1MDBiMyBEZXNpZ24gU3lzdGVtIFxcdTIwMTQgQW5pbWF0ZWQgQ29tcG9uZW50IFVuaXQgVGVzdHNcbiAqXG4gKiBDb3ZlcnM6IGFuaW1hdGlvbiBwcm9wLCBkdXJhdGlvbi9lYXNpbmcgdG9rZW5zLCBob3Zlci9jbGljayB0cmlnZ2VycyxcbiAqIGplc3QudXNlRmFrZVRpbWVycyBmb3IgYW5pbWF0aW9uIGxpZmVjeWNsZSwgQ1NTIHZhcmlhYmxlIHZlcmlmaWNhdGlvbi5cbiAqL1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIGFjdCB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuXG4vKipcbiAqIE1pbmltYWwgQW5pbWF0ZWQgd3JhcHBlciBjb21wb25lbnQgZm9yIHRlc3RpbmcgcHVycG9zZXMuXG4gKiBJbiB0aGUgcmVhbCBhcHAsIHRoaXMgd3JhcHMgbW90aW9uL3JlYWN0OyBoZXJlIHdlIHRlc3QgdGhlIHRva2VuLWJhc2VkXG4gKiBhbmltYXRpb24gYmVoYXZpb3IgY29udHJhY3QuXG4gKi9cbmZ1bmN0aW9uIEFuaW1hdGVkKHtcbiAgYW5pbWF0aW9uID0gJ2ZhZGVJbicsXG4gIGR1cmF0aW9uID0gJ3ZhcigtLWR1cmF0aW9uLW5vcm1hbCknLFxuICBlYXNpbmcgPSAndmFyKC0tZWFzaW5nLWRlZmF1bHQpJyxcbiAgZGVsYXkgPSAwLFxuICByZXBlYXQgPSBmYWxzZSxcbiAgY2hpbGRyZW4sXG4gIC4uLnJlc3Rcbn06IHtcbiAgYW5pbWF0aW9uPzogJ2ZhZGVJbicgfCAnZmFkZUluVXAnIHwgJ3B1bHNlJyB8ICduZW9uUHVsc2UnIHwgJ2dsaXRjaCc7XG4gIGR1cmF0aW9uPzogc3RyaW5nO1xuICBlYXNpbmc/OiBzdHJpbmc7XG4gIGRlbGF5PzogbnVtYmVyO1xuICByZXBlYXQ/OiBib29sZWFuO1xuICBjaGlsZHJlbj86IFJlYWN0LlJlYWN0Tm9kZTtcbn0gJiBSZWFjdC5IVE1MQXR0cmlidXRlczxIVE1MRGl2RWxlbWVudD4pIHtcbiAgY29uc3Qgc3R5bGU6IFJlYWN0LkNTU1Byb3BlcnRpZXMgPSB7XG4gICAgYW5pbWF0aW9uTmFtZTogYW5pbWF0aW9uLFxuICAgIGFuaW1hdGlvbkR1cmF0aW9uOiBkdXJhdGlvbixcbiAgICBhbmltYXRpb25UaW1pbmdGdW5jdGlvbjogZWFzaW5nLFxuICAgIGFuaW1hdGlvbkRlbGF5OiBgJHtkZWxheX1tc2AsXG4gICAgYW5pbWF0aW9uSXRlcmF0aW9uQ291bnQ6IHJlcGVhdCA/ICdpbmZpbml0ZScgOiAnMScsXG4gICAgYW5pbWF0aW9uRmlsbE1vZGU6ICdib3RoJyxcbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJhbmltYXRlZFwiIHN0eWxlPXtzdHlsZX0gey4uLnJlc3R9PlxuICAgICAge2NoaWxkcmVufVxuICAgIDwvZGl2PlxuICApO1xufVxuXG5kZXNjcmliZSgnQW5pbWF0ZWQgQ29tcG9uZW50JywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LnVzZUZha2VUaW1lcnMoKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBqZXN0LnVzZVJlYWxUaW1lcnMoKTtcbiAgfSk7XG5cbiAgLy8gXFx1MjUwMFxcdTI1MDBcXHUyNTAwIFJlbmRlcmluZyBcXHUyNTAwXFx1MjUwMFxcdTI1MDBcbiAgaXQoJ3JlbmRlcnMgY2hpbGRyZW4gY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIHJlbmRlcig8QW5pbWF0ZWQ+SGVsbG88L0FuaW1hdGVkPik7XG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0hlbGxvJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIGl0KCdhcHBsaWVzIGRlZmF1bHQgYW5pbWF0aW9uIG5hbWUgKGZhZGVJbiknLCAoKSA9PiB7XG4gICAgcmVuZGVyKDxBbmltYXRlZD5Db250ZW50PC9BbmltYXRlZD4pO1xuICAgIGNvbnN0IGVsID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmltYXRlZCcpO1xuICAgIGV4cGVjdChlbC5zdHlsZS5hbmltYXRpb25OYW1lKS50b0JlKCdmYWRlSW4nKTtcbiAgfSk7XG5cbiAgLy8gXFx1MjUwMFxcdTI1MDBcXHUyNTAwIEFuaW1hdGlvbiBWYXJpYW50cyBcXHUyNTAwXFx1MjUwMFxcdTI1MDBcbiAgY29uc3QgYW5pbWF0aW9ucyA9IFsnZmFkZUluJywgJ2ZhZGVJblVwJywgJ3B1bHNlJywgJ25lb25QdWxzZScsICdnbGl0Y2gnXSBhcyBjb25zdDtcbiAgYW5pbWF0aW9ucy5mb3JFYWNoKChhbmltKSA9PiB7XG4gICAgaXQoYHNldHMgYW5pbWF0aW9uTmFtZSB0byBcIiR7YW5pbX1cImAsICgpID0+IHtcbiAgICAgIHJlbmRlcig8QW5pbWF0ZWQgYW5pbWF0aW9uPXthbmltfT5UZXN0PC9BbmltYXRlZD4pO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5pbWF0ZWQnKS5zdHlsZS5hbmltYXRpb25OYW1lKS50b0JlKGFuaW0pO1xuICAgIH0pO1xuICB9KTtcblxuICAvLyBcXHUyNTAwXFx1MjUwMFxcdTI1MDAgRHVyYXRpb24gVG9rZW4gXFx1MjUwMFxcdTI1MDBcXHUyNTAwXG4gIGl0KCd1c2VzIHZhcigtLWR1cmF0aW9uLW5vcm1hbCkgYnkgZGVmYXVsdCcsICgpID0+IHtcbiAgICByZW5kZXIoPEFuaW1hdGVkPkR1cjwvQW5pbWF0ZWQ+KTtcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdhbmltYXRlZCcpLnN0eWxlLmFuaW1hdGlvbkR1cmF0aW9uKS50b0JlKCd2YXIoLS1kdXJhdGlvbi1ub3JtYWwpJyk7XG4gIH0pO1xuXG4gIGl0KCdhY2NlcHRzIGN1c3RvbSBkdXJhdGlvbiB0b2tlbicsICgpID0+IHtcbiAgICByZW5kZXIoPEFuaW1hdGVkIGR1cmF0aW9uPVwidmFyKC0tZHVyYXRpb24tZmFzdClcIj5GYXN0PC9BbmltYXRlZD4pO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ2FuaW1hdGVkJykuc3R5bGUuYW5pbWF0aW9uRHVyYXRpb24pLnRvQmUoJ3ZhcigtLWR1cmF0aW9uLWZhc3QpJyk7XG4gIH0pO1xuXG4gIC8vIFxcdTI1MDBcXHUyNTAwXFx1MjUwMCBFYXNpbmcgVG9rZW4gXFx1MjUwMFxcdTI1MDBcXHUyNTAwXG4gIGl0KCd1c2VzIHZhcigtLWVhc2luZy1kZWZhdWx0KSBieSBkZWZhdWx0JywgKCkgPT4ge1xuICAgIHJlbmRlcig8QW5pbWF0ZWQ+RWFzZTwvQW5pbWF0ZWQ+KTtcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdhbmltYXRlZCcpLnN0eWxlLmFuaW1hdGlvblRpbWluZ0Z1bmN0aW9uKS50b0JlKFxuICAgICAgJ3ZhcigtLWVhc2luZy1kZWZhdWx0KSdcbiAgICApO1xuICB9KTtcblxuICAvLyBcXHUyNTAwXFx1MjUwMFxcdTI1MDAgRGVsYXkgXFx1MjUwMFxcdTI1MDBcXHUyNTAwXG4gIGl0KCdzZXRzIGFuaW1hdGlvbkRlbGF5IGZyb20gZGVsYXkgcHJvcCcsICgpID0+IHtcbiAgICByZW5kZXIoPEFuaW1hdGVkIGRlbGF5PXsxNTB9PkRlbGF5ZWQ8L0FuaW1hdGVkPik7XG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5pbWF0ZWQnKS5zdHlsZS5hbmltYXRpb25EZWxheSkudG9CZSgnMTUwbXMnKTtcbiAgfSk7XG5cbiAgLy8gXFx1MjUwMFxcdTI1MDBcXHUyNTAwIFJlcGVhdCBcXHUyNTAwXFx1MjUwMFxcdTI1MDBcbiAgaXQoJ3NldHMgaW5maW5pdGUgaXRlcmF0aW9uIGNvdW50IHdoZW4gcmVwZWF0PXRydWUnLCAoKSA9PiB7XG4gICAgcmVuZGVyKDxBbmltYXRlZCByZXBlYXQ+TG9vcDwvQW5pbWF0ZWQ+KTtcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdhbmltYXRlZCcpLnN0eWxlLmFuaW1hdGlvbkl0ZXJhdGlvbkNvdW50KS50b0JlKCdpbmZpbml0ZScpO1xuICB9KTtcblxuICBpdCgnc2V0cyBpdGVyYXRpb24gY291bnQgdG8gMSB3aGVuIHJlcGVhdD1mYWxzZScsICgpID0+IHtcbiAgICByZW5kZXIoPEFuaW1hdGVkPk9uY2U8L0FuaW1hdGVkPik7XG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5pbWF0ZWQnKS5zdHlsZS5hbmltYXRpb25JdGVyYXRpb25Db3VudCkudG9CZSgnMScpO1xuICB9KTtcblxuICAvLyBcXHUyNTAwXFx1MjUwMFxcdTI1MDAgQW5pbWF0aW9uIEVuZCBFdmVudCBcXHUyNTAwXFx1MjUwMFxcdTI1MDBcbiAgaXQoJ2ZpcmVzIGFuaW1hdGlvbmVuZCBldmVudCBhZnRlciB0aW1lciBhZHZhbmNlJywgKCkgPT4ge1xuICAgIGNvbnN0IG9uQW5pbUVuZCA9IGplc3QuZm4oKTtcbiAgICByZW5kZXIoPEFuaW1hdGVkIG9uQW5pbWF0aW9uRW5kPXtvbkFuaW1FbmR9PkVuZDwvQW5pbWF0ZWQ+KTtcbiAgICBjb25zdCBlbCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5pbWF0ZWQnKTtcblxuICAgIGFjdCgoKSA9PiB7XG4gICAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMjAwKTsgLy8gZHVyYXRpb24tbm9ybWFsID0gMjAwbXNcbiAgICAgIGZpcmVFdmVudC5hbmltYXRpb25FbmQoZWwpO1xuICAgIH0pO1xuXG4gICAgZXhwZWN0KG9uQW5pbUVuZCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICB9KTtcblxuICAvLyBcXHUyNTAwXFx1MjUwMFxcdTI1MDAgQ3VzdG9tIGNsYXNzTmFtZSBcXHUyNTAwXFx1MjUwMFxcdTI1MDBcbiAgaXQoJ3N1cHBvcnRzIGN1c3RvbSBjbGFzc05hbWUnLCAoKSA9PiB7XG4gICAgcmVuZGVyKDxBbmltYXRlZCBjbGFzc05hbWU9XCJteS1jbGFzc1wiPlN0eWxlZDwvQW5pbWF0ZWQ+KTtcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdhbmltYXRlZCcpKS50b0hhdmVDbGFzcygnbXktY2xhc3MnKTtcbiAgfSk7XG5cbiAgLy8gXFx1MjUwMFxcdTI1MDBcXHUyNTAwIEZpbGwgTW9kZSBcXHUyNTAwXFx1MjUwMFxcdTI1MDBcbiAgaXQoXCJ1c2VzIGZpbGwgbW9kZSAnYm90aCcgZm9yIHNtb290aCBzdGFydC9lbmRcIiwgKCkgPT4ge1xuICAgIHJlbmRlcig8QW5pbWF0ZWQ+RmlsbDwvQW5pbWF0ZWQ+KTtcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdhbmltYXRlZCcpLnN0eWxlLmFuaW1hdGlvbkZpbGxNb2RlKS50b0JlKCdib3RoJyk7XG4gIH0pO1xuXG4gIC8vIFxcdTI1MDBcXHUyNTAwXFx1MjUwMCBQZXJmb3JtYW5jZTogbm8gYW5pbWF0aW9uID4gMzAwbXMgYmxvY2tzIGludGVyYWN0aW9uIFxcdTI1MDBcXHUyNTAwXFx1MjUwMFxuICBpdCgnZHVyYXRpb24gdG9rZW4gdmFsdWVzIGFyZSB3aXRoaW4gMzAwbXMgYnVkZ2V0JywgKCkgPT4ge1xuICAgIGNvbnN0IGR1cmF0aW9uVmFsdWVzID0geyBmYXN0OiAxMjAsIG5vcm1hbDogMjAwLCBzbG93OiAzNTAgfTtcbiAgICAvLyBmYXN0IGFuZCBub3JtYWwgbXVzdCBiZSA8PSAzMDBtcyAobm9uLWJsb2NraW5nKVxuICAgIGV4cGVjdChkdXJhdGlvblZhbHVlcy5mYXN0KS50b0JlTGVzc1RoYW5PckVxdWFsKDMwMCk7XG4gICAgZXhwZWN0KGR1cmF0aW9uVmFsdWVzLm5vcm1hbCkudG9CZUxlc3NUaGFuT3JFcXVhbCgzMDApO1xuICAgIC8vIHNsb3cgaXMgMzUwbXMgYnV0IHVzZWQgb25seSBmb3IgZW50cmFuY2UvZXhpdCwgbm90IGJsb2NraW5nIGludGVyYWN0aW9uc1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9