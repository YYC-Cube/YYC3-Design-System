{"file":"/Users/yanyu/Downloads/yyc3-Design-System/src/resource-optimization/__tests__/index.test.ts","mappings":"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","names":[],"sources":["/Users/yanyu/Downloads/yyc3-Design-System/src/resource-optimization/__tests__/index.test.ts"],"sourcesContent":["/**\n * @file 资源优化测试\n * @description 测试资源优化相关的工具函数\n * @module __tests__/resource-optimization.test\n * @author YYC³\n * @version 1.0.0\n * @created 2026-02-22\n */\n\nimport {\n  observeLazyImage,\n  preloadLazyImage,\n  createLazyImageBatchLoader,\n  getLazyImageStats,\n  destroyAllLazyImages,\n  clearImageCache,\n} from '../../utils/image-lazy-loader';\n\nimport { preloadFont, clearFontCache, getFontPreloaderStats } from '../../utils/font-preloader';\n\nimport {\n  preloadResource,\n  preloadResources,\n  preloadCriticalResources,\n  preconnect,\n  preconnectOrigins,\n  prefetch,\n  prefetchResources,\n  preloadScript,\n  preloadStyle,\n  preloadImage as preloadResourceImage,\n  preloadFont as preloadResourceFont,\n  isPreloaded,\n  isPreconnected,\n  isPrefetched,\n  clearAllResources,\n  getResourcePreloaderStats,\n  generatePreloadHints,\n} from '../resource-preloader';\n\ndescribe('资源优化测试', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    clearImageCache();\n    clearFontCache();\n    clearAllResources();\n  });\n\n  describe('图片懒加载测试', () => {\n    it('应该观察图片并延迟加载', () => {\n      const mockElement = document.createElement('img');\n      const mockObserver = {\n        observe: jest.fn(),\n        disconnect: jest.fn(),\n      };\n      jest.spyOn(window, 'IntersectionObserver').mockImplementation((callback) => {\n        mockObserver.observe = jest.fn();\n        return mockObserver as any;\n      });\n\n      const unobserve = observeLazyImage(mockElement, {\n        placeholder: 'data:image/svg+xml;base64,placeholder',\n      });\n\n      expect(mockObserver.observe).toHaveBeenCalledWith(mockElement);\n\n      unobserve();\n      expect(mockObserver.disconnect).toHaveBeenCalled();\n    });\n\n    it('应该使用占位符', () => {\n      const mockElement = document.createElement('img');\n      const placeholder = 'data:image/svg+xml;base64,placeholder';\n\n      observeLazyImage(mockElement, { placeholder });\n\n      expect(mockElement.src).toBe(placeholder);\n    });\n\n    it('应该处理加载完成', () => {\n      const mockElement = document.createElement('img');\n      const onLoad = jest.fn();\n\n      observeLazyImage(mockElement, { onLoad });\n\n      mockElement.dispatchEvent(new Event('load'));\n\n      expect(onLoad).toHaveBeenCalled();\n    });\n\n    it('应该处理加载错误', () => {\n      const mockElement = document.createElement('img');\n      const onError = jest.fn();\n\n      observeLazyImage(mockElement, { onError });\n\n      mockElement.dispatchEvent(new Event('error'));\n\n      expect(onError).toHaveBeenCalled();\n    });\n  });\n\n  describe('图片预加载测试', () => {\n    it('应该预加载单张图片', async () => {\n      const mockSrc = 'https://example.com/image.jpg';\n      const mockImage = {\n        onload: null,\n        onerror: null,\n      };\n      jest\n        .spyOn(window, 'Image')\n        .mockImplementation(() => mockImage as unknown as HTMLImageElement);\n\n      await preloadLazyImage(mockSrc);\n\n      expect(mockImage.onload).toBeDefined();\n    });\n  });\n\n  describe('字体预加载测试', () => {\n    it('应该预加载单个字体', async () => {\n      const mockFont = {\n        fontFamily: 'Test Font',\n        fontSrc: 'https://example.com/font.woff2',\n      };\n\n      await preloadFont(mockFont.fontFamily, mockFont.fontSrc);\n\n      const stats = getFontPreloaderStats();\n      expect(stats).toBeDefined();\n    });\n\n    it('应该清空字体缓存', async () => {\n      const mockFont = {\n        fontFamily: 'Test Font',\n        fontSrc: 'https://example.com/font.woff2',\n      };\n\n      await preloadFont(mockFont.fontFamily, mockFont.fontSrc);\n\n      clearFontCache();\n\n      const stats = getFontPreloaderStats();\n      expect(stats.cacheSize).toBe(0);\n    });\n  });\n\n  describe('资源预加载测试', () => {\n    it('应该预加载单个资源', async () => {\n      const mockUrl = 'https://example.com/script.js';\n\n      preloadResource(mockUrl, 'script');\n\n      expect(isPreloaded(mockUrl)).toBe(true);\n    });\n\n    it('应该批量预加载资源', async () => {\n      const mockResources = [\n        { url: 'https://example.com/script.js', type: 'script' as const },\n        { url: 'https://example.com/style.css', type: 'style' as const },\n      ];\n\n      preloadResources(mockResources);\n\n      expect(isPreloaded(mockResources[0].url)).toBe(true);\n      expect(isPreloaded(mockResources[1].url)).toBe(true);\n    });\n\n    it('应该预加载关键资源', async () => {\n      const mockResources = [{ url: 'https://example.com/script.js', type: 'script' as const }];\n\n      preloadCriticalResources(mockResources);\n\n      expect(isPreloaded(mockResources[0].url)).toBe(true);\n    });\n\n    it('应该预连接到源', async () => {\n      const mockUrl = 'https://example.com';\n\n      preconnect(mockUrl);\n\n      expect(isPreconnected(mockUrl)).toBe(true);\n    });\n\n    it('应该批量预连接到源', async () => {\n      const mockUrls = ['https://example1.com', 'https://example2.com'];\n\n      preconnectOrigins(mockUrls);\n\n      expect(isPreconnected(mockUrls[0])).toBe(true);\n      expect(isPreconnected(mockUrls[1])).toBe(true);\n    });\n\n    it('应该预取资源', async () => {\n      const mockUrl = 'https://example.com/script.js';\n\n      prefetch(mockUrl, 'script');\n\n      expect(isPrefetched(mockUrl)).toBe(true);\n    });\n\n    it('应该批量预取资源', async () => {\n      const mockResources = [\n        { url: 'https://example.com/script.js', type: 'script' as const },\n        { url: 'https://example.com/style.css', type: 'style' as const },\n      ];\n\n      prefetchResources(mockResources);\n\n      expect(isPrefetched(mockResources[0].url)).toBe(true);\n      expect(isPrefetched(mockResources[1].url)).toBe(true);\n    });\n\n    it('应该预加载脚本', async () => {\n      const mockUrl = 'https://example.com/script.js';\n\n      preloadScript(mockUrl);\n\n      expect(isPreloaded(mockUrl)).toBe(true);\n    });\n\n    it('应该预加载样式', async () => {\n      const mockUrl = 'https://example.com/style.css';\n\n      preloadStyle(mockUrl);\n\n      expect(isPreloaded(mockUrl)).toBe(true);\n    });\n\n    it('应该预加载图片', async () => {\n      const mockUrl = 'https://example.com/image.jpg';\n\n      preloadResourceImage(mockUrl);\n\n      expect(isPreloaded(mockUrl)).toBe(true);\n    });\n\n    it('应该预加载字体', async () => {\n      const mockUrl = 'https://example.com/font.woff2';\n\n      preloadResourceFont(mockUrl);\n\n      expect(isPreloaded(mockUrl)).toBe(true);\n    });\n\n    it('应该清空所有资源缓存', async () => {\n      const mockUrl = 'https://example.com/script.js';\n\n      preloadResource(mockUrl, 'script');\n      expect(getResourcePreloaderStats().count).toBeGreaterThan(0);\n\n      clearAllResources();\n\n      expect(getResourcePreloaderStats().count).toBe(0);\n    });\n\n    it('应该生成预加载提示', async () => {\n      const mockUrl = 'https://example.com/script.js';\n\n      preloadResource(mockUrl, 'script');\n\n      const hints = generatePreloadHints();\n      expect(hints.length).toBeGreaterThan(0);\n    });\n  });\n\n  describe('性能基准测试', () => {\n    it('应该测量图片加载性能', async () => {\n      const mockSrc = 'https://example.com/image.jpg';\n      const mockImage = {\n        onload: null,\n        onerror: null,\n      };\n      jest\n        .spyOn(window, 'Image')\n        .mockImplementation(() => mockImage as unknown as HTMLImageElement);\n\n      const start = performance.now();\n\n      await preloadLazyImage(mockSrc);\n\n      const end = performance.now();\n      const loadTime = end - start;\n\n      expect(loadTime).toBeLessThan(1000);\n    });\n\n    it('应该测量字体加载性能', async () => {\n      const mockFont = {\n        fontFamily: 'Test Font',\n        fontSrc: 'https://example.com/font.woff2',\n      };\n\n      const start = performance.now();\n\n      await preloadFont(mockFont.fontFamily, mockFont.fontSrc);\n\n      const end = performance.now();\n      const loadTime = end - start;\n\n      expect(loadTime).toBeLessThan(1000);\n    });\n\n    it('应该测量资源预加载性能', async () => {\n      const mockUrl = 'https://example.com/script.js';\n\n      const start = performance.now();\n\n      preloadResource(mockUrl, 'script');\n\n      const end = performance.now();\n      const loadTime = end - start;\n\n      expect(loadTime).toBeLessThan(1000);\n    });\n  });\n});\n"],"version":3}