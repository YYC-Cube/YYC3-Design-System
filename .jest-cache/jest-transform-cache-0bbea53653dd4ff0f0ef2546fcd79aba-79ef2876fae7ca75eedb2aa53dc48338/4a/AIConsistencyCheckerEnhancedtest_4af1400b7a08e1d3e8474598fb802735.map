{"file":"/Users/yanyu/Downloads/yyc3-Design-System/src/components/__tests__/AIConsistencyCheckerEnhanced.test.tsx","mappings":"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","names":[],"sources":["/Users/yanyu/Downloads/yyc3-Design-System/src/components/__tests__/AIConsistencyCheckerEnhanced.test.tsx"],"sourcesContent":["import { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport '@testing-library/jest-dom';\nimport { ThemeProvider } from '../../theme/ThemeProvider';\nimport { AIConsistencyCheckerEnhanced } from '../AIConsistencyCheckerEnhanced';\n\nconst renderWithTheme = (component: React.ReactElement) => {\n  return render(<ThemeProvider>{component}</ThemeProvider>);\n};\n\ndescribe('AIConsistencyCheckerEnhanced', () => {\n  beforeEach(() => {\n    jest.useFakeTimers();\n  });\n\n  afterEach(() => {\n    jest.useRealTimers();\n  });\n\n  it('应该渲染增强的一致性检查器', () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced />);\n    expect(screen.getByText('AI 设计一致性检查 (增强版)')).toBeInTheDocument();\n  });\n\n  it('应该显示实时检查徽章', () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced realtimeCheck />);\n    expect(screen.getByText('实时检查')).toBeInTheDocument();\n  });\n\n  it('应该显示开始检查按钮', () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced />);\n    expect(screen.getByText('开始检查')).toBeInTheDocument();\n  });\n\n  it('应该显示自动修复复选框', () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced />);\n    expect(screen.getByLabelText('启用自动修复')).toBeInTheDocument();\n  });\n\n  it('应该显示对比度标准选择器', () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced />);\n    expect(screen.getByText('对比度标准:')).toBeInTheDocument();\n    expect(screen.getByText('WCAG AA (4.5:1)')).toBeInTheDocument();\n    expect(screen.getByText('WCAG AAA (7:1)')).toBeInTheDocument();\n  });\n\n  it('应该允许切换对比度标准', () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced />);\n\n    const select = screen.getByText('WCAG AA (4.5:1)').closest('select');\n    if (select) {\n      fireEvent.change(select, { target: { value: 'AAA' } });\n      expect(select).toHaveValue('AAA');\n    }\n  });\n\n  it('应该允许启用/禁用自动修复', () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced />);\n\n    const checkbox = screen.getByLabelText('启用自动修复') as HTMLInputElement;\n    expect(checkbox.checked).toBe(false);\n\n    fireEvent.click(checkbox);\n    expect(checkbox.checked).toBe(true);\n  });\n\n  it('应该在点击开始检查时执行检查', () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced realtimeCheck={false} />);\n\n    const button = screen.getByText('开始检查');\n    fireEvent.click(button);\n\n    expect(screen.getByText('检查中...')).toBeInTheDocument();\n  });\n\n  it('应该显示一致性评分', async () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced realtimeCheck={false} />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      expect(screen.getByText('一致性评分')).toBeInTheDocument();\n    });\n  });\n\n  it('应该显示问题摘要', async () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced realtimeCheck={false} />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      const errorBadge = screen.queryByText(/错误:/);\n      const warningBadge = screen.queryByText(/警告:/);\n      const infoBadge = screen.queryByText(/信息:/);\n\n      expect(errorBadge !== null || warningBadge !== null || infoBadge !== null).toBe(true);\n    });\n  });\n\n  it('应该显示 AI 推荐', async () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced realtimeCheck={false} />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      expect(screen.getByText('AI 推荐')).toBeInTheDocument();\n    });\n  });\n\n  it('应该显示检测到的问题列表', async () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced realtimeCheck={false} />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      const issuesHeading = screen.queryByText(/检测到的问题/);\n      expect(issuesHeading !== null).toBe(true);\n    });\n  });\n\n  it('应该允许展开问题详情', async () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced realtimeCheck={false} />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      const issue = screen.queryByText(/影响令牌/);\n      if (issue) {\n        fireEvent.click(issue);\n      }\n    });\n  });\n\n  it('应该显示自动修复按钮当存在可修复的问题', async () => {\n    renderWithTheme(<AIConsistencyCheckerEnhanced realtimeCheck={false} />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      const autoFixButton = screen.queryByText(/自动修复/);\n      const fixButton = screen.queryByText(/修复此问题/);\n      expect(autoFixButton !== null || fixButton !== null).toBe(true);\n    });\n  });\n\n  it('应该调用 onAutoFix 回调', async () => {\n    const onAutoFix = jest.fn();\n    renderWithTheme(<AIConsistencyCheckerEnhanced onAutoFix={onAutoFix} realtimeCheck={false} />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      const autoFixButton = screen.queryByText(/自动修复/);\n      if (autoFixButton) {\n        fireEvent.click(autoFixButton);\n      }\n    });\n  });\n\n  it('应该在无问题时显示成功消息', async () => {\n    renderWithTheme(\n      <AIConsistencyCheckerEnhanced\n        tokens={{\n          'color.primary': '#3b82f6',\n          'color.foreground': '#000000',\n          'color.background': '#ffffff',\n        }}\n        realtimeCheck={false}\n      />\n    );\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      expect(screen.getByText('完美！')).toBeInTheDocument();\n      expect(screen.getByText('未发现一致性问题')).toBeInTheDocument();\n    });\n  });\n\n  it('应该定期执行实时检查', () => {\n    const setIntervalSpy = jest.spyOn(window, 'setInterval');\n\n    renderWithTheme(<AIConsistencyCheckerEnhanced realtimeCheck />);\n\n    expect(setIntervalSpy).toHaveBeenCalled();\n    expect(setIntervalSpy).toHaveBeenCalledWith(expect.any(Function), 30000);\n\n    setIntervalSpy.mockRestore();\n  });\n\n  it('应该在组件卸载时清除定时器', () => {\n    const clearIntervalSpy = jest.spyOn(window, 'clearInterval');\n    const setIntervalSpy = jest.spyOn(window, 'setInterval');\n\n    const { unmount } = renderWithTheme(<AIConsistencyCheckerEnhanced realtimeCheck />);\n\n    unmount();\n\n    expect(clearIntervalSpy).toHaveBeenCalled();\n\n    clearIntervalSpy.mockRestore();\n    setIntervalSpy.mockRestore();\n  });\n});\n"],"version":3}