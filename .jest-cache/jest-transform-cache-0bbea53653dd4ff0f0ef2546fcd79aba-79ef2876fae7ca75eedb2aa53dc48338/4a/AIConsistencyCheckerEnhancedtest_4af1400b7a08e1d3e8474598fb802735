f98c52d7027d06431e7272d2da3f925e
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("@testing-library/react");
require("@testing-library/jest-dom");
const ThemeProvider_1 = require("../../theme/ThemeProvider");
const AIConsistencyCheckerEnhanced_1 = require("../AIConsistencyCheckerEnhanced");
const renderWithTheme = (component) => {
    return (0, react_1.render)((0, jsx_runtime_1.jsx)(ThemeProvider_1.ThemeProvider, { children: component }));
};
describe('AIConsistencyCheckerEnhanced', () => {
    beforeEach(() => {
        jest.useFakeTimers();
    });
    afterEach(() => {
        jest.useRealTimers();
    });
    it('应该渲染增强的一致性检查器', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, {}));
        expect(react_1.screen.getByText('AI 设计一致性检查 (增强版)')).toBeInTheDocument();
    });
    it('应该显示实时检查徽章', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { realtimeCheck: true }));
        expect(react_1.screen.getByText('实时检查')).toBeInTheDocument();
    });
    it('应该显示开始检查按钮', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, {}));
        expect(react_1.screen.getByText('开始检查')).toBeInTheDocument();
    });
    it('应该显示自动修复复选框', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, {}));
        expect(react_1.screen.getByLabelText('启用自动修复')).toBeInTheDocument();
    });
    it('应该显示对比度标准选择器', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, {}));
        expect(react_1.screen.getByText('对比度标准:')).toBeInTheDocument();
        expect(react_1.screen.getByText('WCAG AA (4.5:1)')).toBeInTheDocument();
        expect(react_1.screen.getByText('WCAG AAA (7:1)')).toBeInTheDocument();
    });
    it('应该允许切换对比度标准', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, {}));
        const select = react_1.screen.getByText('WCAG AA (4.5:1)').closest('select');
        if (select) {
            react_1.fireEvent.change(select, { target: { value: 'AAA' } });
            expect(select).toHaveValue('AAA');
        }
    });
    it('应该允许启用/禁用自动修复', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, {}));
        const checkbox = react_1.screen.getByLabelText('启用自动修复');
        expect(checkbox.checked).toBe(false);
        react_1.fireEvent.click(checkbox);
        expect(checkbox.checked).toBe(true);
    });
    it('应该在点击开始检查时执行检查', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { realtimeCheck: false }));
        const button = react_1.screen.getByText('开始检查');
        react_1.fireEvent.click(button);
        expect(react_1.screen.getByText('检查中...')).toBeInTheDocument();
    });
    it('应该显示一致性评分', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { realtimeCheck: false }));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            expect(react_1.screen.getByText('一致性评分')).toBeInTheDocument();
        });
    });
    it('应该显示问题摘要', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { realtimeCheck: false }));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            const errorBadge = react_1.screen.queryByText(/错误:/);
            const warningBadge = react_1.screen.queryByText(/警告:/);
            const infoBadge = react_1.screen.queryByText(/信息:/);
            expect(errorBadge !== null || warningBadge !== null || infoBadge !== null).toBe(true);
        });
    });
    it('应该显示 AI 推荐', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { realtimeCheck: false }));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            expect(react_1.screen.getByText('AI 推荐')).toBeInTheDocument();
        });
    });
    it('应该显示检测到的问题列表', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { realtimeCheck: false }));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            const issuesHeading = react_1.screen.queryByText(/检测到的问题/);
            expect(issuesHeading !== null).toBe(true);
        });
    });
    it('应该允许展开问题详情', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { realtimeCheck: false }));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            const issue = react_1.screen.queryByText(/影响令牌/);
            if (issue) {
                react_1.fireEvent.click(issue);
            }
        });
    });
    it('应该显示自动修复按钮当存在可修复的问题', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { realtimeCheck: false }));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            const autoFixButton = react_1.screen.queryByText(/自动修复/);
            const fixButton = react_1.screen.queryByText(/修复此问题/);
            expect(autoFixButton !== null || fixButton !== null).toBe(true);
        });
    });
    it('应该调用 onAutoFix 回调', async () => {
        const onAutoFix = jest.fn();
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { onAutoFix: onAutoFix, realtimeCheck: false }));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            const autoFixButton = react_1.screen.queryByText(/自动修复/);
            if (autoFixButton) {
                react_1.fireEvent.click(autoFixButton);
            }
        });
    });
    it('应该在无问题时显示成功消息', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { tokens: {
                'color.primary': '#3b82f6',
                'color.foreground': '#000000',
                'color.background': '#ffffff',
            }, realtimeCheck: false }));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            expect(react_1.screen.getByText('完美！')).toBeInTheDocument();
            expect(react_1.screen.getByText('未发现一致性问题')).toBeInTheDocument();
        });
    });
    it('应该定期执行实时检查', () => {
        const setIntervalSpy = jest.spyOn(window, 'setInterval');
        renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { realtimeCheck: true }));
        expect(setIntervalSpy).toHaveBeenCalled();
        expect(setIntervalSpy).toHaveBeenCalledWith(expect.any(Function), 30000);
        setIntervalSpy.mockRestore();
    });
    it('应该在组件卸载时清除定时器', () => {
        const clearIntervalSpy = jest.spyOn(window, 'clearInterval');
        const setIntervalSpy = jest.spyOn(window, 'setInterval');
        const { unmount } = renderWithTheme((0, jsx_runtime_1.jsx)(AIConsistencyCheckerEnhanced_1.AIConsistencyCheckerEnhanced, { realtimeCheck: true }));
        unmount();
        expect(clearIntervalSpy).toHaveBeenCalled();
        clearIntervalSpy.mockRestore();
        setIntervalSpy.mockRestore();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL2NvbXBvbmVudHMvX190ZXN0c19fL0FJQ29uc2lzdGVuY3lDaGVja2VyRW5oYW5jZWQudGVzdC50c3giLCJtYXBwaW5ncyI6Ijs7O0FBQUEsa0RBQTRFO0FBQzVFLHFDQUFtQztBQUNuQyw2REFBMEQ7QUFDMUQsa0ZBQStFO0FBRS9FLE1BQU0sZUFBZSxHQUFHLENBQUMsU0FBNkIsRUFBRSxFQUFFO0lBQ3hELE9BQU8sSUFBQSxjQUFNLEVBQUMsdUJBQUMsNkJBQWEsY0FBRSxTQUFTLEdBQWlCLENBQUMsQ0FBQztBQUM1RCxDQUFDLENBQUM7QUFFRixRQUFRLENBQUMsOEJBQThCLEVBQUUsR0FBRyxFQUFFO0lBQzVDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCxTQUFTLENBQUMsR0FBRyxFQUFFO1FBQ2IsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7UUFDdkIsZUFBZSxDQUFDLHVCQUFDLDJEQUE0QixLQUFHLENBQUMsQ0FBQztRQUNsRCxNQUFNLENBQUMsY0FBTSxDQUFDLFNBQVMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztJQUNuRSxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFO1FBQ3BCLGVBQWUsQ0FBQyx1QkFBQywyREFBNEIsSUFBQyxhQUFhLFNBQUcsQ0FBQyxDQUFDO1FBQ2hFLE1BQU0sQ0FBQyxjQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztJQUN2RCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFO1FBQ3BCLGVBQWUsQ0FB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QUFDLENBQUM7UUFFaEUsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDMUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFFekUsY0FBYyxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQy9CLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7UUFDdkIsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxlQUFlLENBQUMsQ0FBQztRQUM3RCxNQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxhQUFhLENBQUMsQ0FBQztRQUV6RCxNQUFNLEVBQUUsT0FBTyxFQUFFLEdBQUcsZUFBZSxDQUFDLHVCQUFDLDJEQUE0QixJQUFDLGFBQWEsU0FBRyxDQUFDLENBQUM7UUFFcEYsT0FBTyxFQUFFLENBQUM7UUFFVixNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBRTVDLGdCQUFnQixDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQy9CLGNBQWMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUMvQixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy95YW55dS9Eb3dubG9hZHMveXljMy1EZXNpZ24tU3lzdGVtL3NyYy9jb21wb25lbnRzL19fdGVzdHNfXy9BSUNvbnNpc3RlbmN5Q2hlY2tlckVuaGFuY2VkLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCAnQHRlc3RpbmctbGlicmFyeS9qZXN0LWRvbSc7XG5pbXBvcnQgeyBUaGVtZVByb3ZpZGVyIH0gZnJvbSAnLi4vLi4vdGhlbWUvVGhlbWVQcm92aWRlcic7XG5pbXBvcnQgeyBBSUNvbnNpc3RlbmN5Q2hlY2tlckVuaGFuY2VkIH0gZnJvbSAnLi4vQUlDb25zaXN0ZW5jeUNoZWNrZXJFbmhhbmNlZCc7XG5cbmNvbnN0IHJlbmRlcldpdGhUaGVtZSA9IChjb21wb25lbnQ6IFJlYWN0LlJlYWN0RWxlbWVudCkgPT4ge1xuICByZXR1cm4gcmVuZGVyKDxUaGVtZVByb3ZpZGVyPntjb21wb25lbnR9PC9UaGVtZVByb3ZpZGVyPik7XG59O1xuXG5kZXNjcmliZSgnQUlDb25zaXN0ZW5jeUNoZWNrZXJFbmhhbmNlZCcsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC51c2VGYWtlVGltZXJzKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC51c2VSZWFsVGltZXJzKCk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XmuLLmn5Plop7lvLrnmoTkuIDoh7TmgKfmo4Dmn6XlmagnLCAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUNvbnNpc3RlbmN5Q2hlY2tlckVuaGFuY2VkIC8+KTtcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQUkg6K6+6K6h5LiA6Ie05oCn5qOA5p+lICjlop7lvLrniYgpJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XmmL7npLrlrp7ml7bmo4Dmn6Xlvr3nq6AnLCAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUNvbnNpc3RlbmN5Q2hlY2tlckVuaGFuY2VkIHJlYWx0aW1lQ2hlY2sgLz4pO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCflrp7ml7bmo4Dmn6UnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeaYvuekuuW8gOWni+ajgOafpeaMiemSricsICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPEFJQ29uc2lzdGVuY3lDaGVja2VyRW5oYW5jZWQgLz4pO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCflvIDlp4vmo4Dmn6UnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeaYvuekuuiHquWKqOS/ruWkjeWkjemAieahhicsICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPEFJQ29uc2lzdGVuY3lDaGVja2VyRW5oYW5jZWQgLz4pO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ+WQr+eUqOiHquWKqOS/ruWkjScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5pi+56S65a+55q+U5bqm5qCH5YeG6YCJ5oup5ZmoJywgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8QUlDb25zaXN0ZW5jeUNoZWNrZXJFbmhhbmNlZCAvPik7XG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ+WvueavlOW6puagh+WHhjonKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnV0NBRyBBQSAoNC41OjEpJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1dDQUcgQUFBICg3OjEpJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XlhYHorrjliIfmjaLlr7nmr5TluqbmoIflh4YnLCAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUNvbnNpc3RlbmN5Q2hlY2tlckVuaGFuY2VkIC8+KTtcblxuICAgIGNvbnN0IHNlbGVjdCA9IHNjcmVlbi5nZXRCeVRleHQoJ1dDQUcgQUEgKDQuNToxKScpLmNsb3Nlc3QoJ3NlbGVjdCcpO1xuICAgIGlmIChzZWxlY3QpIHtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2Uoc2VsZWN0LCB7IHRhcmdldDogeyB2YWx1ZTogJ0FBQScgfSB9KTtcbiAgICAgIGV4cGVjdChzZWxlY3QpLnRvSGF2ZVZhbHVlKCdBQUEnKTtcbiAgICB9XG4gIH0pO1xuXG4gIGl0KCflupTor6XlhYHorrjlkK/nlKgv56aB55So6Ieq5Yqo5L+u5aSNJywgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8QUlDb25zaXN0ZW5jeUNoZWNrZXJFbmhhbmNlZCAvPik7XG5cbiAgICBjb25zdCBjaGVja2JveCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgn5ZCv55So6Ieq5Yqo5L+u5aSNJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICBleHBlY3QoY2hlY2tib3guY2hlY2tlZCkudG9CZShmYWxzZSk7XG5cbiAgICBmaXJlRXZlbnQuY2xpY2soY2hlY2tib3gpO1xuICAgIGV4cGVjdChjaGVja2JveC5jaGVja2VkKS50b0JlKHRydWUpO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5Zyo54K55Ye75byA5aeL5qOA5p+l5pe25omn6KGM5qOA5p+lJywgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8QUlDb25zaXN0ZW5jeUNoZWNrZXJFbmhhbmNlZCByZWFsdGltZUNoZWNrPXtmYWxzZX0gLz4pO1xuXG4gICAgY29uc3QgYnV0dG9uID0gc2NyZWVuLmdldEJ5VGV4dCgn5byA5aeL5qOA5p+lJyk7XG4gICAgZmlyZUV2ZW50LmNsaWNrKGJ1dHRvbik7XG5cbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgn5qOA5p+l5LitLi4uJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XmmL7npLrkuIDoh7TmgKfor4TliIYnLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUNvbnNpc3RlbmN5Q2hlY2tlckVuaGFuY2VkIHJlYWx0aW1lQ2hlY2s9e2ZhbHNlfSAvPik7XG5cbiAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgn5byA5aeL5qOA5p+lJykpO1xuXG4gICAgamVzdC5hZHZhbmNlVGltZXJzQnlUaW1lKDEwMCk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCfkuIDoh7TmgKfor4TliIYnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeaYvuekuumXrumimOaRmOimgScsIGFzeW5jICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPEFJQ29uc2lzdGVuY3lDaGVja2VyRW5oYW5jZWQgcmVhbHRpbWVDaGVjaz17ZmFsc2V9IC8+KTtcblxuICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCflvIDlp4vmo4Dmn6UnKSk7XG5cbiAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMTAwKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3JCYWRnZSA9IHNjcmVlbi5xdWVyeUJ5VGV4dCgv6ZSZ6K+vOi8pO1xuICAgICAgY29uc3Qgd2FybmluZ0JhZGdlID0gc2NyZWVuLnF1ZXJ5QnlUZXh0KC/orablkYo6Lyk7XG4gICAgICBjb25zdCBpbmZvQmFkZ2UgPSBzY3JlZW4ucXVlcnlCeVRleHQoL+S/oeaBrzovKTtcblxuICAgICAgZXhwZWN0KGVycm9yQmFkZ2UgIT09IG51bGwgfHwgd2FybmluZ0JhZGdlICE9PSBudWxsIHx8IGluZm9CYWRnZSAhPT0gbnVsbCkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeaYvuekuiBBSSDmjqjojZAnLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUNvbnNpc3RlbmN5Q2hlY2tlckVuaGFuY2VkIHJlYWx0aW1lQ2hlY2s9e2ZhbHNlfSAvPik7XG5cbiAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgn5byA5aeL5qOA5p+lJykpO1xuXG4gICAgamVzdC5hZHZhbmNlVGltZXJzQnlUaW1lKDEwMCk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdBSSDmjqjojZAnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeaYvuekuuajgOa1i+WIsOeahOmXrumimOWIl+ihqCcsIGFzeW5jICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPEFJQ29uc2lzdGVuY3lDaGVja2VyRW5oYW5jZWQgcmVhbHRpbWVDaGVjaz17ZmFsc2V9IC8+KTtcblxuICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCflvIDlp4vmo4Dmn6UnKSk7XG5cbiAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMTAwKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgY29uc3QgaXNzdWVzSGVhZGluZyA9IHNjcmVlbi5xdWVyeUJ5VGV4dCgv5qOA5rWL5Yiw55qE6Zeu6aKYLyk7XG4gICAgICBleHBlY3QoaXNzdWVzSGVhZGluZyAhPT0gbnVsbCkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeWFgeiuuOWxleW8gOmXrumimOivpuaDhScsIGFzeW5jICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPEFJQ29uc2lzdGVuY3lDaGVja2VyRW5oYW5jZWQgcmVhbHRpbWVDaGVjaz17ZmFsc2V9IC8+KTtcblxuICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCflvIDlp4vmo4Dmn6UnKSk7XG5cbiAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMTAwKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgY29uc3QgaXNzdWUgPSBzY3JlZW4ucXVlcnlCeVRleHQoL+W9seWTjeS7pOeJjC8pO1xuICAgICAgaWYgKGlzc3VlKSB7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhpc3N1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XmmL7npLroh6rliqjkv67lpI3mjInpkq7lvZPlrZjlnKjlj6/kv67lpI3nmoTpl67popgnLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUNvbnNpc3RlbmN5Q2hlY2tlckVuaGFuY2VkIHJlYWx0aW1lQ2hlY2s9e2ZhbHNlfSAvPik7XG5cbiAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgn5byA5aeL5qOA5p+lJykpO1xuXG4gICAgamVzdC5hZHZhbmNlVGltZXJzQnlUaW1lKDEwMCk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGNvbnN0IGF1dG9GaXhCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVRleHQoL+iHquWKqOS/ruWkjS8pO1xuICAgICAgY29uc3QgZml4QnV0dG9uID0gc2NyZWVuLnF1ZXJ5QnlUZXh0KC/kv67lpI3mraTpl67popgvKTtcbiAgICAgIGV4cGVjdChhdXRvRml4QnV0dG9uICE9PSBudWxsIHx8IGZpeEJ1dHRvbiAhPT0gbnVsbCkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeiwg+eUqCBvbkF1dG9GaXgg5Zue6LCDJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IG9uQXV0b0ZpeCA9IGplc3QuZm4oKTtcbiAgICByZW5kZXJXaXRoVGhlbWUoPEFJQ29uc2lzdGVuY3lDaGVja2VyRW5oYW5jZWQgb25BdXRvRml4PXtvbkF1dG9GaXh9IHJlYWx0aW1lQ2hlY2s9e2ZhbHNlfSAvPik7XG5cbiAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgn5byA5aeL5qOA5p+lJykpO1xuXG4gICAgamVzdC5hZHZhbmNlVGltZXJzQnlUaW1lKDEwMCk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGNvbnN0IGF1dG9GaXhCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVRleHQoL+iHquWKqOS/ruWkjS8pO1xuICAgICAgaWYgKGF1dG9GaXhCdXR0b24pIHtcbiAgICAgICAgZmlyZUV2ZW50LmNsaWNrKGF1dG9GaXhCdXR0b24pO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5Zyo5peg6Zeu6aKY5pe25pi+56S65oiQ5Yqf5raI5oGvJywgYXN5bmMgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZShcbiAgICAgIDxBSUNvbnNpc3RlbmN5Q2hlY2tlckVuaGFuY2VkXG4gICAgICAgIHRva2Vucz17e1xuICAgICAgICAgICdjb2xvci5wcmltYXJ5JzogJyMzYjgyZjYnLFxuICAgICAgICAgICdjb2xvci5mb3JlZ3JvdW5kJzogJyMwMDAwMDAnLFxuICAgICAgICAgICdjb2xvci5iYWNrZ3JvdW5kJzogJyNmZmZmZmYnLFxuICAgICAgICB9fVxuICAgICAgICByZWFsdGltZUNoZWNrPXtmYWxzZX1cbiAgICAgIC8+XG4gICAgKTtcblxuICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCflvIDlp4vmo4Dmn6UnKSk7XG5cbiAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMTAwKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ+WujOe+ju+8gScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ+acquWPkeeOsOS4gOiHtOaAp+mXrumimCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5a6a5pyf5omn6KGM5a6e5pe25qOA5p+lJywgKCkgPT4ge1xuICAgIGNvbnN0IHNldEludGVydmFsU3B5ID0gamVzdC5zcHlPbih3aW5kb3csICdzZXRJbnRlcnZhbCcpO1xuXG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUNvbnNpc3RlbmN5Q2hlY2tlckVuaGFuY2VkIHJlYWx0aW1lQ2hlY2sgLz4pO1xuXG4gICAgZXhwZWN0KHNldEludGVydmFsU3B5KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgZXhwZWN0KHNldEludGVydmFsU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3QuYW55KEZ1bmN0aW9uKSwgMzAwMDApO1xuXG4gICAgc2V0SW50ZXJ2YWxTcHkubW9ja1Jlc3RvcmUoKTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeWcqOe7hOS7tuWNuOi9veaXtua4hemZpOWumuaXtuWZqCcsICgpID0+IHtcbiAgICBjb25zdCBjbGVhckludGVydmFsU3B5ID0gamVzdC5zcHlPbih3aW5kb3csICdjbGVhckludGVydmFsJyk7XG4gICAgY29uc3Qgc2V0SW50ZXJ2YWxTcHkgPSBqZXN0LnNweU9uKHdpbmRvdywgJ3NldEludGVydmFsJyk7XG5cbiAgICBjb25zdCB7IHVubW91bnQgfSA9IHJlbmRlcldpdGhUaGVtZSg8QUlDb25zaXN0ZW5jeUNoZWNrZXJFbmhhbmNlZCByZWFsdGltZUNoZWNrIC8+KTtcblxuICAgIHVubW91bnQoKTtcblxuICAgIGV4cGVjdChjbGVhckludGVydmFsU3B5KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG5cbiAgICBjbGVhckludGVydmFsU3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgc2V0SW50ZXJ2YWxTcHkubW9ja1Jlc3RvcmUoKTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==