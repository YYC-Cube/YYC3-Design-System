021517d349fad6fb4d5df776e7c09684
"use strict";
/**
 * @file 资源优化测试
 * @description 测试资源优化相关的工具函数
 * @module __tests__/resource-optimization.test
 * @author YYC³
 * @version 1.0.0
 * @created 2026-02-22
 */
Object.defineProperty(exports, "__esModule", { value: true });
const image_lazy_loader_1 = require("../../utils/image-lazy-loader");
const font_preloader_1 = require("../../utils/font-preloader");
const resource_preloader_1 = require("../resource-preloader");
describe('资源优化测试', () => {
    beforeEach(() => {
        jest.clearAllMocks();
        (0, image_lazy_loader_1.clearImageCache)();
        (0, font_preloader_1.clearFontCache)();
        (0, resource_preloader_1.clearAllResources)();
    });
    describe('图片懒加载测试', () => {
        it('应该观察图片并延迟加载', () => {
            const mockElement = document.createElement('img');
            const mockObserver = {
                observe: jest.fn(),
                disconnect: jest.fn(),
            };
            jest.spyOn(window, 'IntersectionObserver').mockImplementation((_callback) => {
                mockObserver.observe = jest.fn();
                return mockObserver;
            });
            const unobserve = (0, image_lazy_loader_1.observeLazyImage)(mockElement, {
                placeholder: 'data:image/svg+xml;base64,placeholder',
            });
            expect(mockObserver.observe).toHaveBeenCalledWith(mockElement);
            unobserve();
            expect(mockObserver.disconnect).toHaveBeenCalled();
        });
        it('应该使用占位符', () => {
            const mockElement = document.createElement('img');
            const placeholder = 'data:image/svg+xml;base64,placeholder';
            (0, image_lazy_loader_1.observeLazyImage)(mockElement, { placeholder });
            expect(mockElement.src).toBe(placeholder);
        });
        it('应该处理加载完成', () => {
            const mockElement = document.createElement('img');
            const onLoad = jest.fn();
            (0, image_lazy_loader_1.observeLazyImage)(mockElement, { onLoad });
            mockElement.dispatchEvent(new Event('load'));
            expect(onLoad).toHaveBeenCalled();
        });
        it('应该处理加载错误', () => {
            const mockElement = document.createElement('img');
            const onError = jest.fn();
            (0, image_lazy_loader_1.observeLazyImage)(mockElement, { onError });
            mockElement.dispatchEvent(new Event('error'));
            expect(onError).toHaveBeenCalled();
        });
    });
    describe('图片预加载测试', () => {
        it('应该预加载单张图片', async () => {
            jest.useFakeTimers();
            const mockSrc = 'https://example.com/image.jpg';
            let resolveLoad;
            const loadPromise = new Promise((resolve) => {
                resolveLoad = resolve;
            });
            const mockImage = {
                onload: null,
                onerror: null,
                src: '',
            };
            jest
                .spyOn(window, 'Image')
                .mockImplementation(() => {
                setTimeout(() => {
                    if (mockImage.onload) {
                        mockImage.onload.call(mockImage, new Event('load'));
                    }
                    resolveLoad();
                }, 100);
                return mockImage;
            });
            await (0, image_lazy_loader_1.preloadLazyImage)(mockSrc);
            expect(mockImage.onload).toBeDefined();
            await loadPromise;
            jest.useRealTimers();
        }, 10000);
    });
    describe('字体预加载测试', () => {
        it('应该预加载单个字体', async () => {
            const mockFont = {
                fontFamily: 'Test Font',
                fontSrc: 'https://example.com/font.woff2',
            };
            await (0, font_preloader_1.preloadFont)(mockFont.fontFamily, mockFont.fontSrc);
            const stats = (0, font_preloader_1.getFontPreloaderStats)();
            expect(stats).toBeDefined();
        });
        it('应该清空字体缓存', async () => {
            const mockFont = {
                fontFamily: 'Test Font',
                fontSrc: 'https://example.com/font.woff2',
            };
            await (0, font_preloader_1.preloadFont)(mockFont.fontFamily, mockFont.fontSrc);
            (0, font_preloader_1.clearFontCache)();
            const stats = (0, font_preloader_1.getFontPreloaderStats)();
            expect(stats.cacheSize).toBe(0);
        });
    });
    describe('资源预加载测试', () => {
        it('应该预加载单个资源', async () => {
            const mockUrl = 'https://example.com/script.js';
            (0, resource_preloader_1.preloadResource)(mockUrl, 'script');
            expect((0, resource_preloader_1.isPreloaded)(mockUrl)).toBe(true);
        });
        it('应该批量预加载资源', async () => {
            const mockResources = [
                { url: 'https://example.com/script.js', type: 'script' },
                { url: 'https://example.com/style.css', type: 'style' },
            ];
            (0, resource_preloader_1.preloadResources)(mockResources);
            expect((0, resource_preloader_1.isPreloaded)(mockResources[0].url)).toBe(true);
            expect((0, resource_preloader_1.isPreloaded)(mockResources[1].url)).toBe(true);
        });
        it('应该预加载关键资源', async () => {
            const mockResources = [{ url: 'https://example.com/script.js', type: 'script' }];
            (0, resource_preloader_1.preloadCriticalResources)(mockResources);
            expect((0, resource_preloader_1.isPreloaded)(mockResources[0].url)).toBe(true);
        });
        it('应该预连接到源', async () => {
            const mockUrl = 'https://example.com';
            (0, resource_preloader_1.preconnect)(mockUrl);
            expect((0, resource_preloader_1.isPreconnected)(mockUrl)).toBe(true);
        });
        it('应该批量预连接到源', async () => {
            const mockUrls = ['https://example1.com', 'https://example2.com'];
            (0, resource_preloader_1.preconnectOrigins)(mockUrls);
            expect((0, resource_preloader_1.isPreconnected)(mockUrls[0])).toBe(true);
            expect((0, resource_preloader_1.isPreconnected)(mockUrls[1])).toBe(true);
        });
        it('应该预取资源', async () => {
            const mockUrl = 'https://example.com/script.js';
            (0, resource_preloader_1.prefetch)(mockUrl, 'script');
            expect((0, resource_preloader_1.isPrefetched)(mockUrl)).toBe(true);
        });
        it('应该批量预取资源', async () => {
            const mockResources = [
                { url: 'https://example.com/script.js', type: 'script' },
                { url: 'https://example.com/style.css', type: 'style' },
            ];
            (0, resource_preloader_1.prefetchResources)(mockResources);
            expect((0, resource_preloader_1.isPrefetched)(mockResources[0].url)).toBe(true);
            expect((0, resource_preloader_1.isPrefetched)(mockResources[1].url)).toBe(true);
        });
        it('应该预加载脚本', async () => {
            const mockUrl = 'https://example.com/script.js';
            (0, resource_preloader_1.preloadScript)(mockUrl);
            expect((0, resource_preloader_1.isPreloaded)(mockUrl)).toBe(true);
        });
        it('应该预加载样式', async () => {
            const mockUrl = 'https://example.com/style.css';
            (0, resource_preloader_1.preloadStyle)(mockUrl);
            expect((0, resource_preloader_1.isPreloaded)(mockUrl)).toBe(true);
        });
        it('应该预加载图片', async () => {
            const mockUrl = 'https://example.com/image.jpg';
            (0, resource_preloader_1.preloadImage)(mockUrl);
            expect((0, resource_preloader_1.isPreloaded)(mockUrl)).toBe(true);
        });
        it('应该预加载字体', async () => {
            const mockUrl = 'https://example.com/font.woff2';
            (0, resource_preloader_1.preloadFont)(mockUrl);
            expect((0, resource_preloader_1.isPreloaded)(mockUrl)).toBe(true);
        });
        it('应该清空所有资源缓存', async () => {
            const mockUrl = 'https://example.com/script.js';
            (0, resource_preloader_1.preloadResource)(mockUrl, 'script');
            await new Promise(resolve => setTimeout(resolve, 100));
            expect((0, resource_preloader_1.getResourcePreloaderStats)().count).toBeGreaterThan(0);
            (0, resource_preloader_1.clearAllResources)();
            expect((0, resource_preloader_1.getResourcePreloaderStats)().count).toBe(0);
        });
        it('应该生成预加载提示', async () => {
            const mockUrl = 'https://example.com/script.js';
            (0, resource_preloader_1.preloadResource)(mockUrl, 'script');
            await new Promise(resolve => setTimeout(resolve, 100));
            const hints = (0, resource_preloader_1.generatePreloadHints)();
            expect(hints.length).toBeGreaterThan(0);
        });
    });
    describe('性能基准测试', () => {
        it('应该测量图片加载性能', async () => {
            jest.useFakeTimers();
            const mockSrc = 'https://example.com/image.jpg';
            let resolveLoad;
            const loadPromise = new Promise((resolve) => {
                resolveLoad = resolve;
            });
            const mockImage = {
                onload: null,
                onerror: null,
                src: '',
            };
            jest
                .spyOn(window, 'Image')
                .mockImplementation(() => {
                setTimeout(() => {
                    if (mockImage.onload) {
                        mockImage.onload(new Event('load'));
                    }
                    resolveLoad();
                }, 100);
                return mockImage;
            });
            const start = performance.now();
            await (0, image_lazy_loader_1.preloadLazyImage)(mockSrc);
            jest.runAllTimers();
            await loadPromise;
            const end = performance.now();
            const loadTime = end - start;
            expect(loadTime).toBeLessThan(1000);
            jest.useRealTimers();
        }, 10000);
        it('应该测量字体加载性能', async () => {
            jest.useFakeTimers();
            jest.spyOn(document.head, 'appendChild').mockImplementation((node) => {
                setTimeout(() => {
                    const event = new Event('load');
                    node.dispatchEvent(event);
                }, 100);
                return node;
            });
            const mockFont = {
                fontFamily: 'Test Font',
                fontSrc: 'https://example.com/font.woff2',
            };
            const start = performance.now();
            await (0, font_preloader_1.preloadFont)(mockFont.fontFamily, mockFont.fontSrc);
            jest.runAllTimers();
            await new Promise(resolve => setTimeout(resolve, 200));
            const end = performance.now();
            const loadTime = end - start;
            expect(loadTime).toBeLessThan(500);
            jest.useRealTimers();
        }, 10000);
        it('应该测量资源预加载性能', async () => {
            jest.useFakeTimers();
            jest.spyOn(document.head, 'appendChild').mockImplementation((node) => {
                setTimeout(() => {
                    const event = new Event('load');
                    node.dispatchEvent(event);
                }, 100);
                return node;
            });
            const mockUrl = 'https://example.com/script.js';
            const start = performance.now();
            (0, resource_preloader_1.preloadResource)(mockUrl, 'script');
            jest.runAllTimers();
            await new Promise(resolve => setTimeout(resolve, 200));
            const end = performance.now();
            const loadTime = end - start;
            expect(loadTime).toBeLessThan(500);
            jest.useRealTimers();
        }, 10000);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL3Jlc291cmNlLW9wdGltaXphdGlvbi9fX3Rlc3RzX18vaW5kZXgudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7R0FPRzs7QUFFSCxxRUFJdUM7QUFFdkMsK0RBQWdHO0FBRWhHLDhEQWtCK0I7QUFFL0IsUUFBUSxDQUFDLFFBQVEsRUFBRSxHQUFHLEVBQUU7SUFDdEIsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNyQixJQUFBLG1DQUFlLEdBQUUsQ0FBQztRQUNsQixJQUFBLCtCQUFjLEdBQUUsQ0FBQztRQUNqQixJQUFBLHNDQUFpQixHQUFFLENBQUM7SUFDdEIsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsU0FBUyxFQUFFLEdBQUcsRUFBRTtRQUN2QixFQUFFLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtZQUNyQixNQUFNLFdBQVcsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2xELE1BQU0sWUFBWSxHQUFHO2dCQUNuQixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtnQkFDbEIsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7YUFDdEIsQ0FBQztZQUNGLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLHNCQUFzQixDQUFDLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBRTtnQkFDMUUsWUFBWSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7Z0JBQ2pDLE9BQU8sWUFBbUIsQ0FBQztZQUM3QixDQUFDLENBQUMsQ0FBQztZQUVILE1BQU0sU0FBUyxHQUFHLElBQUEsb0NBQWdCLEVBQUMsV0FBVyxFQUFFO2dCQUM5QyxXQUFXLEVBQUUsdUNBQXVDO2FBQ3JELENBQUMsQ0FBQztZQUVILE1BQU0sQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFD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TSxRQUFRLEdBQUcsR0FBRyxHQUFHLEtBQUssQ0FBQztZQUU3QixNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRW5DLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUN2QixDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDWixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy95YW55dS9Eb3dubG9hZHMveXljMy1EZXNpZ24tU3lzdGVtL3NyYy9yZXNvdXJjZS1vcHRpbWl6YXRpb24vX190ZXN0c19fL2luZGV4LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAZmlsZSDotYTmupDkvJjljJbmtYvor5VcbiAqIEBkZXNjcmlwdGlvbiDmtYvor5XotYTmupDkvJjljJbnm7jlhbPnmoTlt6Xlhbflh73mlbBcbiAqIEBtb2R1bGUgX190ZXN0c19fL3Jlc291cmNlLW9wdGltaXphdGlvbi50ZXN0XG4gKiBAYXV0aG9yIFlZQ8KzXG4gKiBAdmVyc2lvbiAxLjAuMFxuICogQGNyZWF0ZWQgMjAyNi0wMi0yMlxuICovXG5cbmltcG9ydCB7XG4gIG9ic2VydmVMYXp5SW1hZ2UsXG4gIHByZWxvYWRMYXp5SW1hZ2UsXG4gIGNsZWFySW1hZ2VDYWNoZSxcbn0gZnJvbSAnLi4vLi4vdXRpbHMvaW1hZ2UtbGF6eS1sb2FkZXInO1xuXG5pbXBvcnQgeyBwcmVsb2FkRm9udCwgY2xlYXJGb250Q2FjaGUsIGdldEZvbnRQcmVsb2FkZXJTdGF0cyB9IGZyb20gJy4uLy4uL3V0aWxzL2ZvbnQtcHJlbG9hZGVyJztcblxuaW1wb3J0IHtcbiAgcHJlbG9hZFJlc291cmNlLFxuICBwcmVsb2FkUmVzb3VyY2VzLFxuICBwcmVsb2FkQ3JpdGljYWxSZXNvdXJjZXMsXG4gIHByZWNvbm5lY3QsXG4gIHByZWNvbm5lY3RPcmlnaW5zLFxuICBwcmVmZXRjaCxcbiAgcHJlZmV0Y2hSZXNvdXJjZXMsXG4gIHByZWxvYWRTY3JpcHQsXG4gIHByZWxvYWRTdHlsZSxcbiAgcHJlbG9hZEltYWdlIGFzIHByZWxvYWRSZXNvdXJjZUltYWdlLFxuICBwcmVsb2FkRm9udCBhcyBwcmVsb2FkUmVzb3VyY2VGb250LFxuICBpc1ByZWxvYWRlZCxcbiAgaXNQcmVjb25uZWN0ZWQsXG4gIGlzUHJlZmV0Y2hlZCxcbiAgY2xlYXJBbGxSZXNvdXJjZXMsXG4gIGdldFJlc291cmNlUHJlbG9hZGVyU3RhdHMsXG4gIGdlbmVyYXRlUHJlbG9hZEhpbnRzLFxufSBmcm9tICcuLi9yZXNvdXJjZS1wcmVsb2FkZXInO1xuXG5kZXNjcmliZSgn6LWE5rqQ5LyY5YyW5rWL6K+VJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICBjbGVhckltYWdlQ2FjaGUoKTtcbiAgICBjbGVhckZvbnRDYWNoZSgpO1xuICAgIGNsZWFyQWxsUmVzb3VyY2VzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCflm77niYfmh5LliqDovb3mtYvor5UnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpeinguWvn+WbvueJh+W5tuW7tui/n+WKoOi9vScsICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgICBjb25zdCBtb2NrT2JzZXJ2ZXIgPSB7XG4gICAgICAgIG9ic2VydmU6IGplc3QuZm4oKSxcbiAgICAgICAgZGlzY29ubmVjdDogamVzdC5mbigpLFxuICAgICAgfTtcbiAgICAgIGplc3Quc3B5T24od2luZG93LCAnSW50ZXJzZWN0aW9uT2JzZXJ2ZXInKS5tb2NrSW1wbGVtZW50YXRpb24oKF9jYWxsYmFjaykgPT4ge1xuICAgICAgICBtb2NrT2JzZXJ2ZXIub2JzZXJ2ZSA9IGplc3QuZm4oKTtcbiAgICAgICAgcmV0dXJuIG1vY2tPYnNlcnZlciBhcyBhbnk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdW5vYnNlcnZlID0gb2JzZXJ2ZUxhenlJbWFnZShtb2NrRWxlbWVudCwge1xuICAgICAgICBwbGFjZWhvbGRlcjogJ2RhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQscGxhY2Vob2xkZXInLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChtb2NrT2JzZXJ2ZXIub2JzZXJ2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0VsZW1lbnQpO1xuXG4gICAgICB1bm9ic2VydmUoKTtcbiAgICAgIGV4cGVjdChtb2NrT2JzZXJ2ZXIuZGlzY29ubmVjdCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeS9v+eUqOWNoOS9jeespicsICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgICBjb25zdCBwbGFjZWhvbGRlciA9ICdkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LHBsYWNlaG9sZGVyJztcblxuICAgICAgb2JzZXJ2ZUxhenlJbWFnZShtb2NrRWxlbWVudCwgeyBwbGFjZWhvbGRlciB9KTtcblxuICAgICAgZXhwZWN0KG1vY2tFbGVtZW50LnNyYykudG9CZShwbGFjZWhvbGRlcik7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5aSE55CG5Yqg6L295a6M5oiQJywgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICAgIGNvbnN0IG9uTG9hZCA9IGplc3QuZm4oKTtcblxuICAgICAgb2JzZXJ2ZUxhenlJbWFnZShtb2NrRWxlbWVudCwgeyBvbkxvYWQgfSk7XG5cbiAgICAgIG1vY2tFbGVtZW50LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdsb2FkJykpO1xuXG4gICAgICBleHBlY3Qob25Mb2FkKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5aSE55CG5Yqg6L296ZSZ6K+vJywgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICAgIGNvbnN0IG9uRXJyb3IgPSBqZXN0LmZuKCk7XG5cbiAgICAgIG9ic2VydmVMYXp5SW1hZ2UobW9ja0VsZW1lbnQsIHsgb25FcnJvciB9KTtcblxuICAgICAgbW9ja0VsZW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2Vycm9yJykpO1xuXG4gICAgICBleHBlY3Qob25FcnJvcikudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgn5Zu+54mH6aKE5Yqg6L295rWL6K+VJywgKCkgPT4ge1xuICAgIGl0KCflupTor6XpooTliqDovb3ljZXlvKDlm77niYcnLCBhc3luYyAoKSA9PiB7XG4gICAgICBqZXN0LnVzZUZha2VUaW1lcnMoKTtcblxuICAgICAgY29uc3QgbW9ja1NyYyA9ICdodHRwczovL2V4YW1wbGUuY29tL2ltYWdlLmpwZyc7XG4gICAgICBsZXQgcmVzb2x2ZUxvYWQ6ICgpID0+IHZvaWQ7XG4gICAgICBjb25zdCBsb2FkUHJvbWlzZSA9IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlKSA9PiB7XG4gICAgICAgIHJlc29sdmVMb2FkID0gcmVzb2x2ZTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBtb2NrSW1hZ2UgPSB7XG4gICAgICAgIG9ubG9hZDogbnVsbCBhcyAoKGV2OiBFdmVudCkgPT4gYW55KSB8IG51bGwsXG4gICAgICAgIG9uZXJyb3I6IG51bGwgYXMgKChldjogRXZlbnQpID0+IGFueSkgfCBudWxsLFxuICAgICAgICBzcmM6ICcnLFxuICAgICAgfTtcblxuICAgICAgamVzdFxuICAgICAgICAuc3B5T24od2luZG93LCAnSW1hZ2UnKVxuICAgICAgICAubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmIChtb2NrSW1hZ2Uub25sb2FkKSB7XG4gICAgICAgICAgICAgIG1vY2tJbWFnZS5vbmxvYWQuY2FsbChtb2NrSW1hZ2UsIG5ldyBFdmVudCgnbG9hZCcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc29sdmVMb2FkKCk7XG4gICAgICAgICAgfSwgMTAwKTtcblxuICAgICAgICAgIHJldHVybiBtb2NrSW1hZ2UgYXMgdW5rbm93biBhcyBIVE1MSW1hZ2VFbGVtZW50O1xuICAgICAgICB9KTtcblxuICAgICAgYXdhaXQgcHJlbG9hZExhenlJbWFnZShtb2NrU3JjKTtcblxuICAgICAgZXhwZWN0KG1vY2tJbWFnZS5vbmxvYWQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBhd2FpdCBsb2FkUHJvbWlzZTtcblxuICAgICAgamVzdC51c2VSZWFsVGltZXJzKCk7XG4gICAgfSwgMTAwMDApO1xuICB9KTtcblxuICBkZXNjcmliZSgn5a2X5L2T6aKE5Yqg6L295rWL6K+VJywgKCkgPT4ge1xuICAgIGl0KCflupTor6XpooTliqDovb3ljZXkuKrlrZfkvZMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRm9udCA9IHtcbiAgICAgICAgZm9udEZhbWlseTogJ1Rlc3QgRm9udCcsXG4gICAgICAgIGZvbnRTcmM6ICdodHRwczovL2V4YW1wbGUuY29tL2ZvbnQud29mZjInLFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgcHJlbG9hZEZvbnQobW9ja0ZvbnQuZm9udEZhbWlseSwgbW9ja0ZvbnQuZm9udFNyYyk7XG5cbiAgICAgIGNvbnN0IHN0YXRzID0gZ2V0Rm9udFByZWxvYWRlclN0YXRzKCk7XG4gICAgICBleHBlY3Qoc3RhdHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5riF56m65a2X5L2T57yT5a2YJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0ZvbnQgPSB7XG4gICAgICAgIGZvbnRGYW1pbHk6ICdUZXN0IEZvbnQnLFxuICAgICAgICBmb250U3JjOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9mb250LndvZmYyJyxcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IHByZWxvYWRGb250KG1vY2tGb250LmZvbnRGYW1pbHksIG1vY2tGb250LmZvbnRTcmMpO1xuXG4gICAgICBjbGVhckZvbnRDYWNoZSgpO1xuXG4gICAgICBjb25zdCBzdGF0cyA9IGdldEZvbnRQcmVsb2FkZXJTdGF0cygpO1xuICAgICAgZXhwZWN0KHN0YXRzLmNhY2hlU2l6ZSkudG9CZSgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ+i1hOa6kOmihOWKoOi9vea1i+ivlScsICgpID0+IHtcbiAgICBpdCgn5bqU6K+l6aKE5Yqg6L295Y2V5Liq6LWE5rqQJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VybCA9ICdodHRwczovL2V4YW1wbGUuY29tL3NjcmlwdC5qcyc7XG5cbiAgICAgIHByZWxvYWRSZXNvdXJjZShtb2NrVXJsLCAnc2NyaXB0Jyk7XG5cbiAgICAgIGV4cGVjdChpc1ByZWxvYWRlZChtb2NrVXJsKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6Xmibnph4/pooTliqDovb3otYTmupAnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUmVzb3VyY2VzID0gW1xuICAgICAgICB7IHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vc2NyaXB0LmpzJywgdHlwZTogJ3NjcmlwdCcgYXMgY29uc3QgfSxcbiAgICAgICAgeyB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3N0eWxlLmNzcycsIHR5cGU6ICdzdHlsZScgYXMgY29uc3QgfSxcbiAgICAgIF07XG5cbiAgICAgIHByZWxvYWRSZXNvdXJjZXMobW9ja1Jlc291cmNlcyk7XG5cbiAgICAgIGV4cGVjdChpc1ByZWxvYWRlZChtb2NrUmVzb3VyY2VzWzBdLnVybCkpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoaXNQcmVsb2FkZWQobW9ja1Jlc291cmNlc1sxXS51cmwpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpemihOWKoOi9veWFs+mUrui1hOa6kCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tSZXNvdXJjZXMgPSBbeyB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3NjcmlwdC5qcycsIHR5cGU6ICdzY3JpcHQnIGFzIGNvbnN0IH1dO1xuXG4gICAgICBwcmVsb2FkQ3JpdGljYWxSZXNvdXJjZXMobW9ja1Jlc291cmNlcyk7XG5cbiAgICAgIGV4cGVjdChpc1ByZWxvYWRlZChtb2NrUmVzb3VyY2VzWzBdLnVybCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l6aKE6L+e5o6l5Yiw5rqQJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VybCA9ICdodHRwczovL2V4YW1wbGUuY29tJztcblxuICAgICAgcHJlY29ubmVjdChtb2NrVXJsKTtcblxuICAgICAgZXhwZWN0KGlzUHJlY29ubmVjdGVkKG1vY2tVcmwpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeaJuemHj+mihOi/nuaOpeWIsOa6kCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tVcmxzID0gWydodHRwczovL2V4YW1wbGUxLmNvbScsICdodHRwczovL2V4YW1wbGUyLmNvbSddO1xuXG4gICAgICBwcmVjb25uZWN0T3JpZ2lucyhtb2NrVXJscyk7XG5cbiAgICAgIGV4cGVjdChpc1ByZWNvbm5lY3RlZChtb2NrVXJsc1swXSkpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoaXNQcmVjb25uZWN0ZWQobW9ja1VybHNbMV0pKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpemihOWPlui1hOa6kCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tVcmwgPSAnaHR0cHM6Ly9leGFtcGxlLmNvbS9zY3JpcHQuanMnO1xuXG4gICAgICBwcmVmZXRjaChtb2NrVXJsLCAnc2NyaXB0Jyk7XG5cbiAgICAgIGV4cGVjdChpc1ByZWZldGNoZWQobW9ja1VybCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5om56YeP6aKE5Y+W6LWE5rqQJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Jlc291cmNlcyA9IFtcbiAgICAgICAgeyB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3NjcmlwdC5qcycsIHR5cGU6ICdzY3JpcHQnIGFzIGNvbnN0IH0sXG4gICAgICAgIHsgdXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9zdHlsZS5jc3MnLCB0eXBlOiAnc3R5bGUnIGFzIGNvbnN0IH0sXG4gICAgICBdO1xuXG4gICAgICBwcmVmZXRjaFJlc291cmNlcyhtb2NrUmVzb3VyY2VzKTtcblxuICAgICAgZXhwZWN0KGlzUHJlZmV0Y2hlZChtb2NrUmVzb3VyY2VzWzBdLnVybCkpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoaXNQcmVmZXRjaGVkKG1vY2tSZXNvdXJjZXNbMV0udXJsKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XpooTliqDovb3ohJrmnKwnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vc2NyaXB0LmpzJztcblxuICAgICAgcHJlbG9hZFNjcmlwdChtb2NrVXJsKTtcblxuICAgICAgZXhwZWN0KGlzUHJlbG9hZGVkKG1vY2tVcmwpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpemihOWKoOi9veagt+W8jycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tVcmwgPSAnaHR0cHM6Ly9leGFtcGxlLmNvbS9zdHlsZS5jc3MnO1xuXG4gICAgICBwcmVsb2FkU3R5bGUobW9ja1VybCk7XG5cbiAgICAgIGV4cGVjdChpc1ByZWxvYWRlZChtb2NrVXJsKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XpooTliqDovb3lm77niYcnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vaW1hZ2UuanBnJztcblxuICAgICAgcHJlbG9hZFJlc291cmNlSW1hZ2UobW9ja1VybCk7XG5cbiAgICAgIGV4cGVjdChpc1ByZWxvYWRlZChtb2NrVXJsKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XpooTliqDovb3lrZfkvZMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vZm9udC53b2ZmMic7XG5cbiAgICAgIHByZWxvYWRSZXNvdXJjZUZvbnQobW9ja1VybCk7XG5cbiAgICAgIGV4cGVjdChpc1ByZWxvYWRlZChtb2NrVXJsKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XmuIXnqbrmiYDmnInotYTmupDnvJPlrZgnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vc2NyaXB0LmpzJztcblxuICAgICAgcHJlbG9hZFJlc291cmNlKG1vY2tVcmwsICdzY3JpcHQnKTtcblxuICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMCkpO1xuXG4gICAgICBleHBlY3QoZ2V0UmVzb3VyY2VQcmVsb2FkZXJTdGF0cygpLmNvdW50KS50b0JlR3JlYXRlclRoYW4oMCk7XG5cbiAgICAgIGNsZWFyQWxsUmVzb3VyY2VzKCk7XG5cbiAgICAgIGV4cGVjdChnZXRSZXNvdXJjZVByZWxvYWRlclN0YXRzKCkuY291bnQpLnRvQmUoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l55Sf5oiQ6aKE5Yqg6L295o+Q56S6JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VybCA9ICdodHRwczovL2V4YW1wbGUuY29tL3NjcmlwdC5qcyc7XG5cbiAgICAgIHByZWxvYWRSZXNvdXJjZShtb2NrVXJsLCAnc2NyaXB0Jyk7XG5cbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKTtcblxuICAgICAgY29uc3QgaGludHMgPSBnZW5lcmF0ZVByZWxvYWRIaW50cygpO1xuICAgICAgZXhwZWN0KGhpbnRzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgn5oCn6IO95Z+65YeG5rWL6K+VJywgKCkgPT4ge1xuICAgIGl0KCflupTor6XmtYvph4/lm77niYfliqDovb3mgKfog70nLCBhc3luYyAoKSA9PiB7XG4gICAgICBqZXN0LnVzZUZha2VUaW1lcnMoKTtcblxuICAgICAgY29uc3QgbW9ja1NyYyA9ICdodHRwczovL2V4YW1wbGUuY29tL2ltYWdlLmpwZyc7XG4gICAgICBsZXQgcmVzb2x2ZUxvYWQ6ICgpID0+IHZvaWQ7XG4gICAgICBjb25zdCBsb2FkUHJvbWlzZSA9IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlKSA9PiB7XG4gICAgICAgIHJlc29sdmVMb2FkID0gcmVzb2x2ZTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBtb2NrSW1hZ2UgPSB7XG4gICAgICAgIG9ubG9hZDogbnVsbCBhcyAoKGV2OiBFdmVudCkgPT4gYW55KSB8IG51bGwsXG4gICAgICAgIG9uZXJyb3I6IG51bGwgYXMgKChldjogRXZlbnQpID0+IGFueSkgfCBudWxsLFxuICAgICAgICBzcmM6ICcnLFxuICAgICAgfTtcblxuICAgICAgamVzdFxuICAgICAgICAuc3B5T24od2luZG93LCAnSW1hZ2UnKVxuICAgICAgICAubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmIChtb2NrSW1hZ2Uub25sb2FkKSB7XG4gICAgICAgICAgICAgIG1vY2tJbWFnZS5vbmxvYWQobmV3IEV2ZW50KCdsb2FkJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzb2x2ZUxvYWQoKTtcbiAgICAgICAgICB9LCAxMDApO1xuXG4gICAgICAgICAgcmV0dXJuIG1vY2tJbWFnZSBhcyB1bmtub3duIGFzIEhUTUxJbWFnZUVsZW1lbnQ7XG4gICAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXG4gICAgICBhd2FpdCBwcmVsb2FkTGF6eUltYWdlKG1vY2tTcmMpO1xuXG4gICAgICBqZXN0LnJ1bkFsbFRpbWVycygpO1xuICAgICAgYXdhaXQgbG9hZFByb21pc2U7XG5cbiAgICAgIGNvbnN0IGVuZCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgY29uc3QgbG9hZFRpbWUgPSBlbmQgLSBzdGFydDtcblxuICAgICAgZXhwZWN0KGxvYWRUaW1lKS50b0JlTGVzc1RoYW4oMTAwMCk7XG5cbiAgICAgIGplc3QudXNlUmVhbFRpbWVycygpO1xuICAgIH0sIDEwMDAwKTtcblxuICAgIGl0KCflupTor6XmtYvph4/lrZfkvZPliqDovb3mgKfog70nLCBhc3luYyAoKSA9PiB7XG4gICAgICBqZXN0LnVzZUZha2VUaW1lcnMoKTtcblxuICAgICAgamVzdC5zcHlPbihkb2N1bWVudC5oZWFkLCAnYXBwZW5kQ2hpbGQnKS5tb2NrSW1wbGVtZW50YXRpb24oKG5vZGUpID0+IHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgRXZlbnQoJ2xvYWQnKTtcbiAgICAgICAgICAobm9kZSBhcyBIVE1MRWxlbWVudCkuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgIH0sIDEwMCk7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG1vY2tGb250ID0ge1xuICAgICAgICBmb250RmFtaWx5OiAnVGVzdCBGb250JyxcbiAgICAgICAgZm9udFNyYzogJ2h0dHBzOi8vZXhhbXBsZS5jb20vZm9udC53b2ZmMicsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBzdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXG4gICAgICBhd2FpdCBwcmVsb2FkRm9udChtb2NrRm9udC5mb250RmFtaWx5LCBtb2NrRm9udC5mb250U3JjKTtcblxuICAgICAgamVzdC5ydW5BbGxUaW1lcnMoKTtcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDApKTtcblxuICAgICAgY29uc3QgZW5kID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBjb25zdCBsb2FkVGltZSA9IGVuZCAtIHN0YXJ0O1xuXG4gICAgICBleHBlY3QobG9hZFRpbWUpLnRvQmVMZXNzVGhhbig1MDApO1xuXG4gICAgICBqZXN0LnVzZVJlYWxUaW1lcnMoKTtcbiAgICB9LCAxMDAwMCk7XG5cbiAgICBpdCgn5bqU6K+l5rWL6YeP6LWE5rqQ6aKE5Yqg6L295oCn6IO9JywgYXN5bmMgKCkgPT4ge1xuICAgICAgamVzdC51c2VGYWtlVGltZXJzKCk7XG5cbiAgICAgIGplc3Quc3B5T24oZG9jdW1lbnQuaGVhZCwgJ2FwcGVuZENoaWxkJykubW9ja0ltcGxlbWVudGF0aW9uKChub2RlKSA9PiB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEV2ZW50KCdsb2FkJyk7XG4gICAgICAgICAgKG5vZGUgYXMgSFRNTEVsZW1lbnQpLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgICB9LCAxMDApO1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBtb2NrVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vc2NyaXB0LmpzJztcblxuICAgICAgY29uc3Qgc3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTtcblxuICAgICAgcHJlbG9hZFJlc291cmNlKG1vY2tVcmwsICdzY3JpcHQnKTtcblxuICAgICAgamVzdC5ydW5BbGxUaW1lcnMoKTtcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDApKTtcblxuICAgICAgY29uc3QgZW5kID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBjb25zdCBsb2FkVGltZSA9IGVuZCAtIHN0YXJ0O1xuXG4gICAgICBleHBlY3QobG9hZFRpbWUpLnRvQmVMZXNzVGhhbig1MDApO1xuXG4gICAgICBqZXN0LnVzZVJlYWxUaW1lcnMoKTtcbiAgICB9LCAxMDAwMCk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=