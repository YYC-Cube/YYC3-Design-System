{"file":"/Users/yanyu/Downloads/yyc3-Design-System/src/components/__tests__/AIAccessibilityChecker.test.tsx","mappings":"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","names":[],"sources":["/Users/yanyu/Downloads/yyc3-Design-System/src/components/__tests__/AIAccessibilityChecker.test.tsx"],"sourcesContent":["import { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport '@testing-library/jest-dom';\nimport { ThemeProvider } from '../../theme/ThemeProvider';\nimport { AIAccessibilityChecker } from '../AIAccessibilityChecker';\n\nconst renderWithTheme = (component: React.ReactElement) => {\n  return render(<ThemeProvider>{component}</ThemeProvider>);\n};\n\ndescribe('AIAccessibilityChecker', () => {\n  beforeEach(() => {\n    jest.useFakeTimers();\n  });\n\n  afterEach(() => {\n    jest.useRealTimers();\n  });\n\n  it('应该渲染可访问性检查器', () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n    expect(screen.getByText('AI 可访问性检查器')).toBeInTheDocument();\n  });\n\n  it('应该显示自动检查徽章', () => {\n    renderWithTheme(<AIAccessibilityChecker autoCheck />);\n    expect(screen.getByText('自动检查')).toBeInTheDocument();\n  });\n\n  it('应该显示开始检查按钮', () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n    expect(screen.getByText('开始检查')).toBeInTheDocument();\n  });\n\n  it('应该显示 WCAG 级别选择器', () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n    expect(screen.getByText('WCAG 级别')).toBeInTheDocument();\n    expect(screen.getByText('WCAG A (3:1)')).toBeInTheDocument();\n    expect(screen.getByText('WCAG AA (4.5:1)')).toBeInTheDocument();\n    expect(screen.getByText('WCAG AAA (7:1)')).toBeInTheDocument();\n  });\n\n  it('应该显示检查项目复选框', () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n    expect(screen.getByText('对比度')).toBeInTheDocument();\n    expect(screen.getByText('键盘')).toBeInTheDocument();\n    expect(screen.getByText('ARIA')).toBeInTheDocument();\n    expect(screen.getByText('表单')).toBeInTheDocument();\n    expect(screen.getByText('标题')).toBeInTheDocument();\n  });\n\n  it('应该允许切换 WCAG 级别', () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n\n    const select = screen.getByText('WCAG AA (4.5:1)').closest('select');\n    if (select) {\n      fireEvent.change(select, { target: { value: 'AAA' } });\n      expect(select).toHaveValue('AAA');\n    }\n  });\n\n  it('应该允许启用/禁用检查项目', () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n\n    const checkboxes = screen.getAllByRole('checkbox');\n    checkboxes.forEach((checkbox) => {\n      const checkboxElement = checkbox as HTMLInputElement;\n      if (checkboxElement.checked) {\n        fireEvent.click(checkbox);\n        expect(checkboxElement.checked).toBe(false);\n      }\n    });\n  });\n\n  it('应该在点击开始检查时执行检查', () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n\n    const button = screen.getByText('开始检查');\n    fireEvent.click(button);\n\n    expect(screen.getByText('检查中...')).toBeInTheDocument();\n  });\n\n  it('应该显示可访问性评分', async () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      expect(screen.getByText('可访问性评分')).toBeInTheDocument();\n    });\n  });\n\n  it('应该显示 WCAG 合规等级', async () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      const wcagBadge = screen.queryByText(/WCAG/);\n      expect(wcagBadge !== null).toBe(true);\n    });\n  });\n\n  it('应该显示问题摘要', async () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      const summaryBadges = screen.queryAllByText(/严重:|中等:|轻微:/);\n      expect(summaryBadges.length > 0).toBe(true);\n    });\n  });\n\n  it('应该显示 AI 建议', async () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      expect(screen.getByText('AI 建议')).toBeInTheDocument();\n    });\n  });\n\n  it('应该显示检测到的问题列表', async () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      const issuesHeading = screen.queryByText(/检测到的问题/);\n      expect(issuesHeading !== null).toBe(true);\n    });\n  });\n\n  it('应该允许展开问题详情', async () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      const issueCard = screen.queryByText(/建议:/);\n      if (issueCard) {\n        fireEvent.click(issueCard);\n      }\n    });\n  });\n\n  it('应该显示修复按钮当存在可修复的问题', async () => {\n    renderWithTheme(<AIAccessibilityChecker />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      const fixButton = screen.queryByText(/修复此问题/);\n      const autoFixButton = screen.queryByText(/自动修复/);\n      expect(fixButton !== null || autoFixButton !== null).toBe(true);\n    });\n  });\n\n  it('应该在无问题时显示成功消息', async () => {\n    const mockElement = document.createElement('div');\n    mockElement.innerHTML = `\n      <div style=\"color: #000000; background-color: #ffffff; font-size: 16px;\">\n        <h1>标题</h1>\n        <p>内容</p>\n      </div>\n    `;\n    document.body.appendChild(mockElement);\n\n    renderWithTheme(<AIAccessibilityChecker targetElement={mockElement} />);\n\n    fireEvent.click(screen.getByText('开始检查'));\n\n    jest.advanceTimersByTime(100);\n\n    await waitFor(() => {\n      expect(screen.getByText('完美！')).toBeInTheDocument();\n      expect(screen.getByText(/页面完全符合 WCAG/)).toBeInTheDocument();\n    });\n\n    document.body.removeChild(mockElement);\n  });\n\n  it('应该定期执行自动检查', () => {\n    const setIntervalSpy = jest.spyOn(window, 'setInterval');\n\n    renderWithTheme(<AIAccessibilityChecker autoCheck />);\n\n    expect(setIntervalSpy).toHaveBeenCalled();\n\n    setIntervalSpy.mockRestore();\n  });\n\n  it('应该在组件卸载时清除定时器', () => {\n    const clearIntervalSpy = jest.spyOn(window, 'clearInterval');\n    const setIntervalSpy = jest.spyOn(window, 'setInterval');\n\n    const { unmount } = renderWithTheme(<AIAccessibilityChecker autoCheck />);\n\n    unmount();\n\n    expect(clearIntervalSpy).toHaveBeenCalled();\n\n    clearIntervalSpy.mockRestore();\n    setIntervalSpy.mockRestore();\n  });\n});\n"],"version":3}