26690083c745779ebf77c6b935912c2d
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("@testing-library/react");
require("@testing-library/jest-dom");
const ThemeProvider_1 = require("../../theme/ThemeProvider");
const AIAccessibilityChecker_1 = require("../AIAccessibilityChecker");
const renderWithTheme = (component) => {
    return (0, react_1.render)((0, jsx_runtime_1.jsx)(ThemeProvider_1.ThemeProvider, { children: component }));
};
describe('AIAccessibilityChecker', () => {
    beforeEach(() => {
        jest.useFakeTimers();
    });
    afterEach(() => {
        jest.useRealTimers();
    });
    it('应该渲染可访问性检查器', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        expect(react_1.screen.getByText('AI 可访问性检查器')).toBeInTheDocument();
    });
    it('应该显示自动检查徽章', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, { autoCheck: true }));
        expect(react_1.screen.getByText('自动检查')).toBeInTheDocument();
    });
    it('应该显示开始检查按钮', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        expect(react_1.screen.getByText('开始检查')).toBeInTheDocument();
    });
    it('应该显示 WCAG 级别选择器', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        expect(react_1.screen.getByText('WCAG 级别')).toBeInTheDocument();
        expect(react_1.screen.getByText('WCAG A (3:1)')).toBeInTheDocument();
        expect(react_1.screen.getByText('WCAG AA (4.5:1)')).toBeInTheDocument();
        expect(react_1.screen.getByText('WCAG AAA (7:1)')).toBeInTheDocument();
    });
    it('应该显示检查项目复选框', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        expect(react_1.screen.getByText('对比度')).toBeInTheDocument();
        expect(react_1.screen.getByText('键盘')).toBeInTheDocument();
        expect(react_1.screen.getByText('ARIA')).toBeInTheDocument();
        expect(react_1.screen.getByText('表单')).toBeInTheDocument();
        expect(react_1.screen.getByText('标题')).toBeInTheDocument();
    });
    it('应该允许切换 WCAG 级别', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        const select = react_1.screen.getByText('WCAG AA (4.5:1)').closest('select');
        if (select) {
            react_1.fireEvent.change(select, { target: { value: 'AAA' } });
            expect(select).toHaveValue('AAA');
        }
    });
    it('应该允许启用/禁用检查项目', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        const checkboxes = react_1.screen.getAllByRole('checkbox');
        checkboxes.forEach((checkbox) => {
            const checkboxElement = checkbox;
            if (checkboxElement.checked) {
                react_1.fireEvent.click(checkbox);
                expect(checkboxElement.checked).toBe(false);
            }
        });
    });
    it('应该在点击开始检查时执行检查', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        const button = react_1.screen.getByText('开始检查');
        react_1.fireEvent.click(button);
        expect(react_1.screen.getByText('检查中...')).toBeInTheDocument();
    });
    it('应该显示可访问性评分', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            expect(react_1.screen.getByText('可访问性评分')).toBeInTheDocument();
        });
    });
    it('应该显示 WCAG 合规等级', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            const wcagBadge = react_1.screen.queryByText(/WCAG/);
            expect(wcagBadge !== null).toBe(true);
        });
    });
    it('应该显示问题摘要', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            const summaryBadges = react_1.screen.queryAllByText(/严重:|中等:|轻微:/);
            expect(summaryBadges.length > 0).toBe(true);
        });
    });
    it('应该显示 AI 建议', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            expect(react_1.screen.getByText('AI 建议')).toBeInTheDocument();
        });
    });
    it('应该显示检测到的问题列表', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            const issuesHeading = react_1.screen.queryByText(/检测到的问题/);
            expect(issuesHeading !== null).toBe(true);
        });
    });
    it('应该允许展开问题详情', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            const issueCard = react_1.screen.queryByText(/建议:/);
            if (issueCard) {
                react_1.fireEvent.click(issueCard);
            }
        });
    });
    it('应该显示修复按钮当存在可修复的问题', async () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, {}));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            const fixButton = react_1.screen.queryByText(/修复此问题/);
            const autoFixButton = react_1.screen.queryByText(/自动修复/);
            expect(fixButton !== null || autoFixButton !== null).toBe(true);
        });
    });
    it('应该在无问题时显示成功消息', async () => {
        const mockElement = document.createElement('div');
        mockElement.innerHTML = `
      <div style="color: #000000; background-color: #ffffff; font-size: 16px;">
        <h1>标题</h1>
        <p>内容</p>
      </div>
    `;
        document.body.appendChild(mockElement);
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, { targetElement: mockElement }));
        react_1.fireEvent.click(react_1.screen.getByText('开始检查'));
        jest.advanceTimersByTime(100);
        await (0, react_1.waitFor)(() => {
            expect(react_1.screen.getByText('完美！')).toBeInTheDocument();
            expect(react_1.screen.getByText(/页面完全符合 WCAG/)).toBeInTheDocument();
        });
        document.body.removeChild(mockElement);
    });
    it('应该定期执行自动检查', () => {
        const setIntervalSpy = jest.spyOn(window, 'setInterval');
        renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, { autoCheck: true }));
        expect(setIntervalSpy).toHaveBeenCalled();
        setIntervalSpy.mockRestore();
    });
    it('应该在组件卸载时清除定时器', () => {
        const clearIntervalSpy = jest.spyOn(window, 'clearInterval');
        const setIntervalSpy = jest.spyOn(window, 'setInterval');
        const { unmount } = renderWithTheme((0, jsx_runtime_1.jsx)(AIAccessibilityChecker_1.AIAccessibilityChecker, { autoCheck: true }));
        unmount();
        expect(clearIntervalSpy).toHaveBeenCalled();
        clearIntervalSpy.mockRestore();
        setIntervalSpy.mockRestore();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL2NvbXBvbmVudHMvX190ZXN0c19fL0FJQWNjZXNzaWJpbGl0eUNoZWNrZXIudGVzdC50c3giLCJtYXBwaW5ncyI6Ijs7O0FBQUEsa0RBQTRFO0FBQzVFLHFDQUFtQztBQUNuQyw2REFBMEQ7QUFDMUQsc0VBQW1FO0FBRW5FLE1BQU0sZUFBZSxHQUFHLENBQUMsU0FBNkIsRUFBRSxFQUFFO0lBQ3hELE9BQU8sSUFBQSxjQUFNLEVBQUMsdUJBQUMsNkJBQWEsY0FBRSxTQUFTLEdBQWlCLENBQUMsQ0FBQztBQUM1RCxDQUFDLENBQUM7QUFFRixRQUFRLENBQUMsd0JBQXdCLEVBQUUsR0FBRyxFQUFFO0lBQ3RDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCxTQUFTLENBQUMsR0FBRyxFQUFFO1FBQ2IsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDckIsZUFBZSxDQUFDLHVCQUFDLCtDQUFzQixLQUFHLENBQUMsQ0FBQztRQUM1QyxNQUFNLENBQUMsY0FBTSxDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUM7SUFDN0QsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsWUFBWSxFQUFFLEdBQUcsRUFBRTtRQUNwQixlQUFlLENBQUMsdUJBQUMsK0NBQXNCLElBQUMsU0FBUyxTQUFHLENBQUMsQ0FBQztRQUN0RCxNQUFNLENBQUMsY0FBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUM7SUFDdkQsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsWUFBWSxFQUFFLEdBQUcsRUFBRTtRQUNwQixlQUFlLENBQUMsdUJBQUMs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QUN6QyxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFO1FBQ3BCLE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLGFBQWEsQ0FBQyxDQUFDO1FBRXpELGVBQWUsQ0FBQyx1QkFBQywrQ0FBc0IsSUFBQyxTQUFTLFNBQUcsQ0FBQyxDQUFDO1FBRXRELE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBRTFDLGNBQWMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUMvQixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO1FBQ3ZCLE1BQU0sZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsZUFBZSxDQUFDLENBQUM7UUFDN0QsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFFekQsTUFBTSxFQUFFLE9BQU8sRUFBRSxHQUFHLGVBQWUsQ0FBQyx1QkFBQywrQ0FBc0IsSUFBQyxTQUFTLFNBQUcsQ0FBQyxDQUFDO1FBRTFFLE9BQU8sRUFBRSxDQUFDO1FBRVYsTUFBTSxDQUFDLGdCQUFnQixDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUU1QyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMvQixjQUFjLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDL0IsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMveWFueXUvRG93bmxvYWRzL3l5YzMtRGVzaWduLVN5c3RlbS9zcmMvY29tcG9uZW50cy9fX3Rlc3RzX18vQUlBY2Nlc3NpYmlsaXR5Q2hlY2tlci50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgZmlyZUV2ZW50LCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgJ0B0ZXN0aW5nLWxpYnJhcnkvamVzdC1kb20nO1xuaW1wb3J0IHsgVGhlbWVQcm92aWRlciB9IGZyb20gJy4uLy4uL3RoZW1lL1RoZW1lUHJvdmlkZXInO1xuaW1wb3J0IHsgQUlBY2Nlc3NpYmlsaXR5Q2hlY2tlciB9IGZyb20gJy4uL0FJQWNjZXNzaWJpbGl0eUNoZWNrZXInO1xuXG5jb25zdCByZW5kZXJXaXRoVGhlbWUgPSAoY29tcG9uZW50OiBSZWFjdC5SZWFjdEVsZW1lbnQpID0+IHtcbiAgcmV0dXJuIHJlbmRlcig8VGhlbWVQcm92aWRlcj57Y29tcG9uZW50fTwvVGhlbWVQcm92aWRlcj4pO1xufTtcblxuZGVzY3JpYmUoJ0FJQWNjZXNzaWJpbGl0eUNoZWNrZXInLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QudXNlRmFrZVRpbWVycygpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QudXNlUmVhbFRpbWVycygpO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5riy5p+T5Y+v6K6/6Zeu5oCn5qOA5p+l5ZmoJywgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8QUlBY2Nlc3NpYmlsaXR5Q2hlY2tlciAvPik7XG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0FJIOWPr+iuv+mXruaAp+ajgOafpeWZqCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5pi+56S66Ieq5Yqo5qOA5p+l5b6956ugJywgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8QUlBY2Nlc3NpYmlsaXR5Q2hlY2tlciBhdXRvQ2hlY2sgLz4pO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCfoh6rliqjmo4Dmn6UnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeaYvuekuuW8gOWni+ajgOafpeaMiemSricsICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPEFJQWNjZXNzaWJpbGl0eUNoZWNrZXIgLz4pO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCflvIDlp4vmo4Dmn6UnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeaYvuekuiBXQ0FHIOe6p+WIq+mAieaLqeWZqCcsICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPEFJQWNjZXNzaWJpbGl0eUNoZWNrZXIgLz4pO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdXQ0FHIOe6p+WIqycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdXQ0FHIEEgKDM6MSknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnV0NBRyBBQSAoNC41OjEpJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1dDQUcgQUFBICg3OjEpJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XmmL7npLrmo4Dmn6Xpobnnm67lpI3pgInmoYYnLCAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUFjY2Vzc2liaWxpdHlDaGVja2VyIC8+KTtcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgn5a+55q+U5bqmJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ+mUruebmCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdBUklBJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ+ihqOWNlScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCfmoIfpopgnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeWFgeiuuOWIh+aNoiBXQ0FHIOe6p+WIqycsICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPEFJQWNjZXNzaWJpbGl0eUNoZWNrZXIgLz4pO1xuXG4gICAgY29uc3Qgc2VsZWN0ID0gc2NyZWVuLmdldEJ5VGV4dCgnV0NBRyBBQSAoNC41OjEpJykuY2xvc2VzdCgnc2VsZWN0Jyk7XG4gICAgaWYgKHNlbGVjdCkge1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShzZWxlY3QsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnQUFBJyB9IH0pO1xuICAgICAgZXhwZWN0KHNlbGVjdCkudG9IYXZlVmFsdWUoJ0FBQScpO1xuICAgIH1cbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeWFgeiuuOWQr+eUqC/npoHnlKjmo4Dmn6Xpobnnm64nLCAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUFjY2Vzc2liaWxpdHlDaGVja2VyIC8+KTtcblxuICAgIGNvbnN0IGNoZWNrYm94ZXMgPSBzY3JlZW4uZ2V0QWxsQnlSb2xlKCdjaGVja2JveCcpO1xuICAgIGNoZWNrYm94ZXMuZm9yRWFjaCgoY2hlY2tib3gpID0+IHtcbiAgICAgIGNvbnN0IGNoZWNrYm94RWxlbWVudCA9IGNoZWNrYm94IGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICBpZiAoY2hlY2tib3hFbGVtZW50LmNoZWNrZWQpIHtcbiAgICAgICAgZmlyZUV2ZW50LmNsaWNrKGNoZWNrYm94KTtcbiAgICAgICAgZXhwZWN0KGNoZWNrYm94RWxlbWVudC5jaGVja2VkKS50b0JlKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeWcqOeCueWHu+W8gOWni+ajgOafpeaXtuaJp+ihjOajgOafpScsICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPEFJQWNjZXNzaWJpbGl0eUNoZWNrZXIgLz4pO1xuXG4gICAgY29uc3QgYnV0dG9uID0gc2NyZWVuLmdldEJ5VGV4dCgn5byA5aeL5qOA5p+lJyk7XG4gICAgZmlyZUV2ZW50LmNsaWNrKGJ1dHRvbik7XG5cbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgn5qOA5p+l5LitLi4uJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XmmL7npLrlj6/orr/pl67mgKfor4TliIYnLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUFjY2Vzc2liaWxpdHlDaGVja2VyIC8+KTtcblxuICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCflvIDlp4vmo4Dmn6UnKSk7XG5cbiAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMTAwKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ+WPr+iuv+mXruaAp+ivhOWIhicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5pi+56S6IFdDQUcg5ZCI6KeE562J57qnJywgYXN5bmMgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8QUlBY2Nlc3NpYmlsaXR5Q2hlY2tlciAvPik7XG5cbiAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgn5byA5aeL5qOA5p+lJykpO1xuXG4gICAgamVzdC5hZHZhbmNlVGltZXJzQnlUaW1lKDEwMCk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGNvbnN0IHdjYWdCYWRnZSA9IHNjcmVlbi5xdWVyeUJ5VGV4dCgvV0NBRy8pO1xuICAgICAgZXhwZWN0KHdjYWdCYWRnZSAhPT0gbnVsbCkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeaYvuekuumXrumimOaRmOimgScsIGFzeW5jICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPEFJQWNjZXNzaWJpbGl0eUNoZWNrZXIgLz4pO1xuXG4gICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRleHQoJ+W8gOWni+ajgOafpScpKTtcblxuICAgIGplc3QuYWR2YW5jZVRpbWVyc0J5VGltZSgxMDApO1xuXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBjb25zdCBzdW1tYXJ5QmFkZ2VzID0gc2NyZWVuLnF1ZXJ5QWxsQnlUZXh0KC/kuKXph406fOS4reetiTp86L275b6uOi8pO1xuICAgICAgZXhwZWN0KHN1bW1hcnlCYWRnZXMubGVuZ3RoID4gMCkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeaYvuekuiBBSSDlu7rorq4nLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUFjY2Vzc2liaWxpdHlDaGVja2VyIC8+KTtcblxuICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCflvIDlp4vmo4Dmn6UnKSk7XG5cbiAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMTAwKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0FJIOW7uuiuricpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5pi+56S65qOA5rWL5Yiw55qE6Zeu6aKY5YiX6KGoJywgYXN5bmMgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8QUlBY2Nlc3NpYmlsaXR5Q2hlY2tlciAvPik7XG5cbiAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgn5byA5aeL5qOA5p+lJykpO1xuXG4gICAgamVzdC5hZHZhbmNlVGltZXJzQnlUaW1lKDEwMCk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGNvbnN0IGlzc3Vlc0hlYWRpbmcgPSBzY3JlZW4ucXVlcnlCeVRleHQoL+ajgOa1i+WIsOeahOmXrumimC8pO1xuICAgICAgZXhwZWN0KGlzc3Vlc0hlYWRpbmcgIT09IG51bGwpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XlhYHorrjlsZXlvIDpl67popjor6bmg4UnLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUFjY2Vzc2liaWxpdHlDaGVja2VyIC8+KTtcblxuICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCflvIDlp4vmo4Dmn6UnKSk7XG5cbiAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMTAwKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgY29uc3QgaXNzdWVDYXJkID0gc2NyZWVuLnF1ZXJ5QnlUZXh0KC/lu7rorq46Lyk7XG4gICAgICBpZiAoaXNzdWVDYXJkKSB7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhpc3N1ZUNhcmQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5pi+56S65L+u5aSN5oyJ6ZKu5b2T5a2Y5Zyo5Y+v5L+u5aSN55qE6Zeu6aKYJywgYXN5bmMgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8QUlBY2Nlc3NpYmlsaXR5Q2hlY2tlciAvPik7XG5cbiAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgn5byA5aeL5qOA5p+lJykpO1xuXG4gICAgamVzdC5hZHZhbmNlVGltZXJzQnlUaW1lKDEwMCk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGNvbnN0IGZpeEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGV4dCgv5L+u5aSN5q2k6Zeu6aKYLyk7XG4gICAgICBjb25zdCBhdXRvRml4QnV0dG9uID0gc2NyZWVuLnF1ZXJ5QnlUZXh0KC/oh6rliqjkv67lpI0vKTtcbiAgICAgIGV4cGVjdChmaXhCdXR0b24gIT09IG51bGwgfHwgYXV0b0ZpeEJ1dHRvbiAhPT0gbnVsbCkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeWcqOaXoOmXrumimOaXtuaYvuekuuaIkOWKn+a2iOaBrycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBtb2NrRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIG1vY2tFbGVtZW50LmlubmVySFRNTCA9IGBcbiAgICAgIDxkaXYgc3R5bGU9XCJjb2xvcjogIzAwMDAwMDsgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjsgZm9udC1zaXplOiAxNnB4O1wiPlxuICAgICAgICA8aDE+5qCH6aKYPC9oMT5cbiAgICAgICAgPHA+5YaF5a65PC9wPlxuICAgICAgPC9kaXY+XG4gICAgYDtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vY2tFbGVtZW50KTtcblxuICAgIHJlbmRlcldpdGhUaGVtZSg8QUlBY2Nlc3NpYmlsaXR5Q2hlY2tlciB0YXJnZXRFbGVtZW50PXttb2NrRWxlbWVudH0gLz4pO1xuXG4gICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRleHQoJ+W8gOWni+ajgOafpScpKTtcblxuICAgIGplc3QuYWR2YW5jZVRpbWVyc0J5VGltZSgxMDApO1xuXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgn5a6M576O77yBJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgv6aG16Z2i5a6M5YWo56ym5ZCIIFdDQUcvKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobW9ja0VsZW1lbnQpO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5a6a5pyf5omn6KGM6Ieq5Yqo5qOA5p+lJywgKCkgPT4ge1xuICAgIGNvbnN0IHNldEludGVydmFsU3B5ID0gamVzdC5zcHlPbih3aW5kb3csICdzZXRJbnRlcnZhbCcpO1xuXG4gICAgcmVuZGVyV2l0aFRoZW1lKDxBSUFjY2Vzc2liaWxpdHlDaGVja2VyIGF1dG9DaGVjayAvPik7XG5cbiAgICBleHBlY3Qoc2V0SW50ZXJ2YWxTcHkpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcblxuICAgIHNldEludGVydmFsU3B5Lm1vY2tSZXN0b3JlKCk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XlnKjnu4Tku7bljbjovb3ml7bmuIXpmaTlrprml7blmagnLCAoKSA9PiB7XG4gICAgY29uc3QgY2xlYXJJbnRlcnZhbFNweSA9IGplc3Quc3B5T24od2luZG93LCAnY2xlYXJJbnRlcnZhbCcpO1xuICAgIGNvbnN0IHNldEludGVydmFsU3B5ID0gamVzdC5zcHlPbih3aW5kb3csICdzZXRJbnRlcnZhbCcpO1xuXG4gICAgY29uc3QgeyB1bm1vdW50IH0gPSByZW5kZXJXaXRoVGhlbWUoPEFJQWNjZXNzaWJpbGl0eUNoZWNrZXIgYXV0b0NoZWNrIC8+KTtcblxuICAgIHVubW91bnQoKTtcblxuICAgIGV4cGVjdChjbGVhckludGVydmFsU3B5KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG5cbiAgICBjbGVhckludGVydmFsU3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgc2V0SW50ZXJ2YWxTcHkubW9ja1Jlc3RvcmUoKTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==