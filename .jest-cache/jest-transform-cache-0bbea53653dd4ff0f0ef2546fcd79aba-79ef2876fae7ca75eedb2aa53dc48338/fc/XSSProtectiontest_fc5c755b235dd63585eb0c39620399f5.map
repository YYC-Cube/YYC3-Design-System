{"file":"/Users/yanyu/Downloads/yyc3-Design-System/src/security/__tests__/XSSProtection.test.tsx","mappings":"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","names":[],"sources":["/Users/yanyu/Downloads/yyc3-Design-System/src/security/__tests__/XSSProtection.test.tsx"],"sourcesContent":["/**\n * @file XSS防护测试\n * @description 测试XSS防护功能\n * @module __tests__/security/XSSProtection.test\n * @author YYC³\n * @version 1.0.0\n * @created 2026-02-19\n */\n\nimport * as React from 'react';\nimport { XSSProvider, useXSS } from '../XSSProtection';\nimport { render, cleanup, fireEvent, waitFor, act } from '@testing-library/react';\nimport { screen } from '@testing-library/dom';\n\ndescribe('XSS Protection Module', () => {\n  beforeEach(() => {\n    cleanup();\n  });\n\n  describe('XSSProvider', () => {\n    it('应该提供默认配置', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [dirty, setDirty] = React.useState('<script>alert(\"xss\")</script>');\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize(dirty).then(setClean);\n        }, [dirty, sanitize]);\n\n        return (\n          <div>\n            <input data-testid=\"input\" value={dirty} onChange={(e) => setDirty(e.target.value)} />\n            <div data-testid=\"output\">{clean}</div>\n          </div>\n        );\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const input = screen.getByTestId('input');\n      const output = screen.getByTestId('output');\n\n      expect(input).toBeInTheDocument();\n      expect(output).toBeInTheDocument();\n\n      await waitFor(() => {\n        expect(output.textContent).not.toContain('<script>');\n      });\n    });\n\n    it('应该支持自定义配置', async () => {\n      const customConfig = {\n        allowedTags: ['b', 'i', 'em'],\n        allowedAttributes: {},\n      };\n\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [input] = React.useState('<b>bold</b><script>evil</script>');\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize(input).then(setClean);\n        }, [input, sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider config={customConfig}>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).toContain('bold');\n      });\n\n      expect(output.textContent).not.toContain('<script>');\n    });\n\n    it('应该处理HTML实体编码', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('&lt;script&gt;alert(1)&lt;/script&gt;').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).toBeDefined();\n      });\n    });\n\n    it('应该过滤危险属性', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('<div onclick=\"alert(1)\">click</div>').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).not.toContain('onclick');\n      });\n    });\n  });\n\n  describe('useXSS Hook', () => {\n    it('应该返回sanitize函数', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('<p>safe content</p>').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output).toBeInTheDocument();\n      });\n    });\n\n    it('应该处理空字符串', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).toBe('');\n      });\n    });\n\n    it('应该处理null和undefined', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [cleanNull, setCleanNull] = React.useState('');\n        const [cleanUndefined, setCleanUndefined] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize(null as unknown as string).then(setCleanNull);\n          sanitize(undefined as unknown as string).then(setCleanUndefined);\n        }, [sanitize]);\n\n        return (\n          <div>\n            <div data-testid=\"output-null\">{cleanNull}</div>\n            <div data-testid=\"output-undefined\">{cleanUndefined}</div>\n          </div>\n        );\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const outputNull = screen.getByTestId('output-null');\n      const outputUndefined = screen.getByTestId('output-undefined');\n\n      await waitFor(() => {\n        expect(outputNull).toBeInTheDocument();\n        expect(outputUndefined).toBeInTheDocument();\n      });\n    });\n\n    it('应该处理特殊字符', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('<>&\"\\'').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).toBeDefined();\n      });\n    });\n  });\n\n  describe('XSS攻击防护', () => {\n    it('应该阻止script标签注入', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('<script>alert(\"xss\")</script>').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).not.toContain('<script>');\n        expect(output.textContent).not.toContain('alert');\n      });\n    });\n\n    it('应该阻止iframe注入', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('<iframe src=\"evil.com\"></iframe>').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).not.toContain('<iframe');\n      });\n    });\n\n    it('应该阻止javascript:协议', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('<a href=\"javascript:alert(1)\">click</a>').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).not.toContain('javascript:');\n      });\n    });\n\n    it('应该阻止on事件处理器', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('<div onmouseover=\"alert(1)\">hover</div>').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).not.toContain('onmouseover');\n      });\n    });\n\n    it('应该阻止data:URL', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('<img src=\"data:text/html,<script>alert(1)</script>\">').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).not.toContain('data:');\n      });\n    });\n  });\n\n  describe('安全内容保留', () => {\n    it('应该保留安全的HTML标签', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('<p><strong>bold</strong> and <em>italic</em></p>').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).toContain('bold');\n        expect(output.textContent).toContain('italic');\n      });\n    });\n\n    it('应该保留链接', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('<a href=\"https://example.com\">safe link</a>').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).toContain('safe link');\n      });\n    });\n\n    it('应该保留图片', async () => {\n      const TestComponent = () => {\n        const { sanitize } = useXSS();\n        const [clean, setClean] = React.useState('');\n\n        React.useEffect(() => {\n          sanitize('<img src=\"https://example.com/image.jpg\" alt=\"image\">').then(setClean);\n        }, [sanitize]);\n\n        return <div data-testid=\"output\">{clean}</div>;\n      };\n\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n\n      const output = screen.getByTestId('output');\n\n      await waitFor(() => {\n        expect(output.textContent).toBeDefined();\n      });\n    });\n  });\n});\n"],"version":3}