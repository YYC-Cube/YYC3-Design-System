24939c9379a77fc8f8a81d6b1af2efc1
"use strict";
/**
 * @file 主题持久化工具测试
 * @description 测试主题持久化工具的各项功能
 * @module __tests__/utils/theme-persistence.test
 * @author YYC³
 * @version 1.0.0
 * @created 2026-02-21
 */
Object.defineProperty(exports, "__esModule", { value: true });
const theme_persistence_1 = require("./theme-persistence");
describe('theme-persistence', () => {
    beforeEach(() => {
        localStorage.clear();
        document.documentElement.removeAttribute('data-theme');
    });
    afterEach(() => {
        localStorage.clear();
        document.documentElement.removeAttribute('data-theme');
    });
    describe('getSystemTheme', () => {
        it('应该返回系统主题', () => {
            const theme = (0, theme_persistence_1.getSystemTheme)();
            expect(['light', 'dark']).toContain(theme);
        });
    });
    describe('getStoredTheme', () => {
        it('当没有存储的主题时应该返回light', () => {
            const theme = (0, theme_persistence_1.getStoredTheme)();
            expect(theme).toBe('light');
        });
        it('应该返回存储的light主题', () => {
            localStorage.setItem('yyc3-theme', JSON.stringify({
                mode: 'light',
                version: '1.0.0',
                timestamp: Date.now(),
            }));
            const theme = (0, theme_persistence_1.getStoredTheme)();
            expect(theme).toBe('light');
        });
        it('应该返回存储的dark主题', () => {
            localStorage.setItem('yyc3-theme', JSON.stringify({
                mode: 'dark',
                version: '1.0.0',
                timestamp: Date.now(),
            }));
            const theme = (0, theme_persistence_1.getStoredTheme)();
            expect(theme).toBe('dark');
        });
        it('当模式为system时应该返回系统主题', () => {
            localStorage.setItem('yyc3-theme', JSON.stringify({
                mode: 'system',
                version: '1.0.0',
                timestamp: Date.now(),
            }));
            const theme = (0, theme_persistence_1.getStoredTheme)();
            expect(['light', 'dark']).toContain(theme);
        });
        it('当版本不匹配时应该返回light', () => {
            localStorage.setItem('yyc3-theme', JSON.stringify({
                mode: 'dark',
                version: '0.9.0',
                timestamp: Date.now(),
            }));
            const theme = (0, theme_persistence_1.getStoredTheme)();
            expect(theme).toBe('light');
        });
    });
    describe('setStoredTheme', () => {
        it('应该保存light主题', () => {
            (0, theme_persistence_1.setStoredTheme)('light');
            const stored = localStorage.getItem('yyc3-theme');
            expect(stored).toBeTruthy();
            const config = JSON.parse(stored);
            expect(config.mode).toBe('light');
            expect(config.version).toBe('1.0.0');
        });
        it('应该保存dark主题', () => {
            (0, theme_persistence_1.setStoredTheme)('dark');
            const stored = localStorage.getItem('yyc3-theme');
            expect(stored).toBeTruthy();
            const config = JSON.parse(stored);
            expect(config.mode).toBe('dark');
        });
        it('应该保存system主题', () => {
            (0, theme_persistence_1.setStoredTheme)('system');
            const stored = localStorage.getItem('yyc3-theme');
            expect(stored).toBeTruthy();
            const config = JSON.parse(stored);
            expect(config.mode).toBe('system');
        });
        it('应该设置data-theme属性', () => {
            (0, theme_persistence_1.setStoredTheme)('dark');
            expect(document.documentElement.getAttribute('data-theme')).toBe('dark');
        });
        it('应该保存时间戳', () => {
            const beforeTime = Date.now();
            (0, theme_persistence_1.setStoredTheme)('light');
            const afterTime = Date.now();
            const stored = localStorage.getItem('yyc3-theme');
            const config = JSON.parse(stored);
            expect(config.timestamp).toBeGreaterThanOrEqual(beforeTime);
            expect(config.timestamp).toBeLessThanOrEqual(afterTime);
        });
    });
    describe('clearStoredTheme', () => {
        it('应该清除存储的主题', () => {
            localStorage.setItem('yyc3-theme', JSON.stringify({
                mode: 'dark',
                version: '1.0.0',
                timestamp: Date.now(),
            }));
            (0, theme_persistence_1.clearStoredTheme)();
            expect(localStorage.getItem('yyc3-theme')).toBeNull();
        });
        it('应该清除主题版本', () => {
            localStorage.setItem('yyc3-theme-version', '1.0.0');
            (0, theme_persistence_1.clearStoredTheme)();
            expect(localStorage.getItem('yyc3-theme-version')).toBeNull();
        });
        it('应该移除data-theme属性', () => {
            document.documentElement.setAttribute('data-theme', 'dark');
            (0, theme_persistence_1.clearStoredTheme)();
            expect(document.documentElement.getAttribute('data-theme')).toBeNull();
        });
    });
    describe('migrateTheme', () => {
        it('应该迁移主题版本', () => {
            localStorage.setItem('yyc3-theme', JSON.stringify({
                mode: 'dark',
                version: '0.9.0',
                timestamp: Date.now(),
            }));
            (0, theme_persistence_1.migrateTheme)('0.9.0');
            const stored = localStorage.getItem('yyc3-theme');
            const config = JSON.parse(stored);
            expect(config.version).toBe('1.0.0');
        });
        it('应该保留主题模式', () => {
            localStorage.setItem('yyc3-theme', JSON.stringify({
                mode: 'dark',
                version: '0.9.0',
                timestamp: Date.now(),
            }));
            (0, theme_persistence_1.migrateTheme)('0.9.0');
            const stored = localStorage.getItem('yyc3-theme');
            const config = JSON.parse(stored);
            expect(config.mode).toBe('dark');
        });
    });
    describe('syncThemeWithSystem', () => {
        it('当模式为system时应该同步系统主题', () => {
            localStorage.setItem('yyc3-theme', JSON.stringify({
                mode: 'system',
                version: '1.0.0',
                timestamp: Date.now(),
            }));
            (0, theme_persistence_1.syncThemeWithSystem)();
            const theme = document.documentElement.getAttribute('data-theme');
            expect(['light', 'dark']).toContain(theme);
        });
        it('当模式不为system时不应该同步', () => {
            localStorage.setItem('yyc3-theme', JSON.stringify({
                mode: 'dark',
                version: '1.0.0',
                timestamp: Date.now(),
            }));
            (0, theme_persistence_1.syncThemeWithSystem)();
            expect(document.documentElement.getAttribute('data-theme')).toBeNull();
        });
    });
    describe('getThemeInfo', () => {
        it('当没有存储的主题时应该返回null', () => {
            const info = (0, theme_persistence_1.getThemeInfo)();
            expect(info).toBeNull();
        });
        it('应该返回主题配置', () => {
            const config = {
                mode: 'dark',
                version: '1.0.0',
                timestamp: Date.now(),
            };
            localStorage.setItem('yyc3-theme', JSON.stringify(config));
            const info = (0, theme_persistence_1.getThemeInfo)();
            expect(info).toEqual(config);
        });
    });
    describe('isThemePersisted', () => {
        it('当没有存储的主题时应该返回false', () => {
            const persisted = (0, theme_persistence_1.isThemePersisted)();
            expect(persisted).toBe(false);
        });
        it('当有存储的主题时应该返回true', () => {
            localStorage.setItem('yyc3-theme', JSON.stringify({
                mode: 'dark',
                version: '1.0.0',
                timestamp: Date.now(),
            }));
            const persisted = (0, theme_persistence_1.isThemePersisted)();
            expect(persisted).toBe(true);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL3V0aWxzL3RoZW1lLXBlcnNpc3RlbmNlLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7O0dBT0c7O0FBRUgsMkRBUzZCO0FBRTdCLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7SUFDakMsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLFlBQVksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNyQixRQUFRLENBQUMsZUFBZSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUN6RCxDQUFDLENBQUMsQ0FBQztJQUVILFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixZQUFZLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDckIsUUFBUSxDQUFDLGVBQWUsQ0FBQyxlQUFlLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDekQsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLEVBQUUsQ0FBQyxVQUFVLEVBQUUsR0FBRyxFQUFFO1lBQ2xCLE1BQU0sS0FBSyxHQUFHLElBQUEsa0NBQWMsR0FBRSxDQUFDO1lBQy9CLE1BQU0sQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM3QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtRQUM5QixFQUFFLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFO1lBQzVCLE1BQU0sS0FBSyxHQUFHLElBQUEsa0NBQWMsR0FBRSxDQUFDO1lBQy9CLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDOUIsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1lBQ3hCLFlBQVksQ0FB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RSxJQUFJLENBQUMsR0FBRyxFQUFFO2FBQ3RCLENBQUMsQ0FDSCxDQUFDO1lBQ0YsTUFBTSxTQUFTLEdBQUcsSUFBQSxvQ0FBZ0IsR0FBRSxDQUFDO1lBQ3JDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDL0IsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy95YW55dS9Eb3dubG9hZHMveXljMy1EZXNpZ24tU3lzdGVtL3NyYy91dGlscy90aGVtZS1wZXJzaXN0ZW5jZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGZpbGUg5Li76aKY5oyB5LmF5YyW5bel5YW35rWL6K+VXG4gKiBAZGVzY3JpcHRpb24g5rWL6K+V5Li76aKY5oyB5LmF5YyW5bel5YW355qE5ZCE6aG55Yqf6IO9XG4gKiBAbW9kdWxlIF9fdGVzdHNfXy91dGlscy90aGVtZS1wZXJzaXN0ZW5jZS50ZXN0XG4gKiBAYXV0aG9yIFlZQ8KzXG4gKiBAdmVyc2lvbiAxLjAuMFxuICogQGNyZWF0ZWQgMjAyNi0wMi0yMVxuICovXG5cbmltcG9ydCB7XG4gIGdldFN5c3RlbVRoZW1lLFxuICBnZXRTdG9yZWRUaGVtZSxcbiAgc2V0U3RvcmVkVGhlbWUsXG4gIGNsZWFyU3RvcmVkVGhlbWUsXG4gIG1pZ3JhdGVUaGVtZSxcbiAgc3luY1RoZW1lV2l0aFN5c3RlbSxcbiAgZ2V0VGhlbWVJbmZvLFxuICBpc1RoZW1lUGVyc2lzdGVkLFxufSBmcm9tICcuL3RoZW1lLXBlcnNpc3RlbmNlJztcblxuZGVzY3JpYmUoJ3RoZW1lLXBlcnNpc3RlbmNlJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXRoZW1lJyk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7XG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS10aGVtZScpO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0U3lzdGVtVGhlbWUnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpei/lOWbnuezu+e7n+S4u+mimCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHRoZW1lID0gZ2V0U3lzdGVtVGhlbWUoKTtcbiAgICAgIGV4cGVjdChbJ2xpZ2h0JywgJ2RhcmsnXSkudG9Db250YWluKHRoZW1lKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFN0b3JlZFRoZW1lJywgKCkgPT4ge1xuICAgIGl0KCflvZPmsqHmnInlrZjlgqjnmoTkuLvpopjml7blupTor6Xov5Tlm55saWdodCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHRoZW1lID0gZ2V0U3RvcmVkVGhlbWUoKTtcbiAgICAgIGV4cGVjdCh0aGVtZSkudG9CZSgnbGlnaHQnKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6Xov5Tlm57lrZjlgqjnmoRsaWdodOS4u+mimCcsICgpID0+IHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFxuICAgICAgICAneXljMy10aGVtZScsXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBtb2RlOiAnbGlnaHQnLFxuICAgICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHRoZW1lID0gZ2V0U3RvcmVkVGhlbWUoKTtcbiAgICAgIGV4cGVjdCh0aGVtZSkudG9CZSgnbGlnaHQnKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6Xov5Tlm57lrZjlgqjnmoRkYXJr5Li76aKYJywgKCkgPT4ge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXG4gICAgICAgICd5eWMzLXRoZW1lJyxcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIG1vZGU6ICdkYXJrJyxcbiAgICAgICAgICB2ZXJzaW9uOiAnMS4wLjAnLFxuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgICBjb25zdCB0aGVtZSA9IGdldFN0b3JlZFRoZW1lKCk7XG4gICAgICBleHBlY3QodGhlbWUpLnRvQmUoJ2RhcmsnKTtcbiAgICB9KTtcblxuICAgIGl0KCflvZPmqKHlvI/kuLpzeXN0ZW3ml7blupTor6Xov5Tlm57ns7vnu5/kuLvpopgnLCAoKSA9PiB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcbiAgICAgICAgJ3l5YzMtdGhlbWUnLFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgbW9kZTogJ3N5c3RlbScsXG4gICAgICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgICAgY29uc3QgdGhlbWUgPSBnZXRTdG9yZWRUaGVtZSgpO1xuICAgICAgZXhwZWN0KFsnbGlnaHQnLCAnZGFyayddKS50b0NvbnRhaW4odGhlbWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W9k+eJiOacrOS4jeWMuemFjeaXtuW6lOivpei/lOWbnmxpZ2h0JywgKCkgPT4ge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXG4gICAgICAgICd5eWMzLXRoZW1lJyxcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIG1vZGU6ICdkYXJrJyxcbiAgICAgICAgICB2ZXJzaW9uOiAnMC45LjAnLFxuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgICBjb25zdCB0aGVtZSA9IGdldFN0b3JlZFRoZW1lKCk7XG4gICAgICBleHBlY3QodGhlbWUpLnRvQmUoJ2xpZ2h0Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZXRTdG9yZWRUaGVtZScsICgpID0+IHtcbiAgICBpdCgn5bqU6K+l5L+d5a2YbGlnaHTkuLvpopgnLCAoKSA9PiB7XG4gICAgICBzZXRTdG9yZWRUaGVtZSgnbGlnaHQnKTtcbiAgICAgIGNvbnN0IHN0b3JlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd5eWMzLXRoZW1lJyk7XG4gICAgICBleHBlY3Qoc3RvcmVkKS50b0JlVHJ1dGh5KCk7XG4gICAgICBjb25zdCBjb25maWcgPSBKU09OLnBhcnNlKHN0b3JlZCEpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5tb2RlKS50b0JlKCdsaWdodCcpO1xuICAgICAgZXhwZWN0KGNvbmZpZy52ZXJzaW9uKS50b0JlKCcxLjAuMCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeS/neWtmGRhcmvkuLvpopgnLCAoKSA9PiB7XG4gICAgICBzZXRTdG9yZWRUaGVtZSgnZGFyaycpO1xuICAgICAgY29uc3Qgc3RvcmVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3l5YzMtdGhlbWUnKTtcbiAgICAgIGV4cGVjdChzdG9yZWQpLnRvQmVUcnV0aHkoKTtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IEpTT04ucGFyc2Uoc3RvcmVkISk7XG4gICAgICBleHBlY3QoY29uZmlnLm1vZGUpLnRvQmUoJ2RhcmsnKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6Xkv53lrZhzeXN0ZW3kuLvpopgnLCAoKSA9PiB7XG4gICAgICBzZXRTdG9yZWRUaGVtZSgnc3lzdGVtJyk7XG4gICAgICBjb25zdCBzdG9yZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgneXljMy10aGVtZScpO1xuICAgICAgZXhwZWN0KHN0b3JlZCkudG9CZVRydXRoeSgpO1xuICAgICAgY29uc3QgY29uZmlnID0gSlNPTi5wYXJzZShzdG9yZWQhKTtcbiAgICAgIGV4cGVjdChjb25maWcubW9kZSkudG9CZSgnc3lzdGVtJyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l6K6+572uZGF0YS10aGVtZeWxnuaApycsICgpID0+IHtcbiAgICAgIHNldFN0b3JlZFRoZW1lKCdkYXJrJyk7XG4gICAgICBleHBlY3QoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS10aGVtZScpKS50b0JlKCdkYXJrJyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5L+d5a2Y5pe26Ze05oizJywgKCkgPT4ge1xuICAgICAgY29uc3QgYmVmb3JlVGltZSA9IERhdGUubm93KCk7XG4gICAgICBzZXRTdG9yZWRUaGVtZSgnbGlnaHQnKTtcbiAgICAgIGNvbnN0IGFmdGVyVGltZSA9IERhdGUubm93KCk7XG5cbiAgICAgIGNvbnN0IHN0b3JlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd5eWMzLXRoZW1lJyk7XG4gICAgICBjb25zdCBjb25maWcgPSBKU09OLnBhcnNlKHN0b3JlZCEpO1xuICAgICAgZXhwZWN0KGNvbmZpZy50aW1lc3RhbXApLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoYmVmb3JlVGltZSk7XG4gICAgICBleHBlY3QoY29uZmlnLnRpbWVzdGFtcCkudG9CZUxlc3NUaGFuT3JFcXVhbChhZnRlclRpbWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnY2xlYXJTdG9yZWRUaGVtZScsICgpID0+IHtcbiAgICBpdCgn5bqU6K+l5riF6Zmk5a2Y5YKo55qE5Li76aKYJywgKCkgPT4ge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXG4gICAgICAgICd5eWMzLXRoZW1lJyxcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIG1vZGU6ICdkYXJrJyxcbiAgICAgICAgICB2ZXJzaW9uOiAnMS4wLjAnLFxuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgICBjbGVhclN0b3JlZFRoZW1lKCk7XG4gICAgICBleHBlY3QobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3l5YzMtdGhlbWUnKSkudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XmuIXpmaTkuLvpopjniYjmnKwnLCAoKSA9PiB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgneXljMy10aGVtZS12ZXJzaW9uJywgJzEuMC4wJyk7XG4gICAgICBjbGVhclN0b3JlZFRoZW1lKCk7XG4gICAgICBleHBlY3QobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3l5YzMtdGhlbWUtdmVyc2lvbicpKS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeenu+mZpGRhdGEtdGhlbWXlsZ7mgKcnLCAoKSA9PiB7XG4gICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXRoZW1lJywgJ2RhcmsnKTtcbiAgICAgIGNsZWFyU3RvcmVkVGhlbWUoKTtcbiAgICAgIGV4cGVjdChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXRoZW1lJykpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdtaWdyYXRlVGhlbWUnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpei/geenu+S4u+mimOeJiOacrCcsICgpID0+IHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFxuICAgICAgICAneXljMy10aGVtZScsXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBtb2RlOiAnZGFyaycsXG4gICAgICAgICAgdmVyc2lvbjogJzAuOS4wJyxcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgICAgbWlncmF0ZVRoZW1lKCcwLjkuMCcpO1xuICAgICAgY29uc3Qgc3RvcmVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3l5YzMtdGhlbWUnKTtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IEpTT04ucGFyc2Uoc3RvcmVkISk7XG4gICAgICBleHBlY3QoY29uZmlnLnZlcnNpb24pLnRvQmUoJzEuMC4wJyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5L+d55WZ5Li76aKY5qih5byPJywgKCkgPT4ge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXG4gICAgICAgICd5eWMzLXRoZW1lJyxcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIG1vZGU6ICdkYXJrJyxcbiAgICAgICAgICB2ZXJzaW9uOiAnMC45LjAnLFxuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgICBtaWdyYXRlVGhlbWUoJzAuOS4wJyk7XG4gICAgICBjb25zdCBzdG9yZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgneXljMy10aGVtZScpO1xuICAgICAgY29uc3QgY29uZmlnID0gSlNPTi5wYXJzZShzdG9yZWQhKTtcbiAgICAgIGV4cGVjdChjb25maWcubW9kZSkudG9CZSgnZGFyaycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnc3luY1RoZW1lV2l0aFN5c3RlbScsICgpID0+IHtcbiAgICBpdCgn5b2T5qih5byP5Li6c3lzdGVt5pe25bqU6K+l5ZCM5q2l57O757uf5Li76aKYJywgKCkgPT4ge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXG4gICAgICAgICd5eWMzLXRoZW1lJyxcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIG1vZGU6ICdzeXN0ZW0nLFxuICAgICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICAgIHN5bmNUaGVtZVdpdGhTeXN0ZW0oKTtcbiAgICAgIGNvbnN0IHRoZW1lID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS10aGVtZScpO1xuICAgICAgZXhwZWN0KFsnbGlnaHQnLCAnZGFyayddKS50b0NvbnRhaW4odGhlbWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W9k+aooeW8j+S4jeS4unN5c3RlbeaXtuS4jeW6lOivpeWQjOatpScsICgpID0+IHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFxuICAgICAgICAneXljMy10aGVtZScsXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBtb2RlOiAnZGFyaycsXG4gICAgICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgICAgc3luY1RoZW1lV2l0aFN5c3RlbSgpO1xuICAgICAgZXhwZWN0KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGhlbWUnKSkudG9CZU51bGwoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFRoZW1lSW5mbycsICgpID0+IHtcbiAgICBpdCgn5b2T5rKh5pyJ5a2Y5YKo55qE5Li76aKY5pe25bqU6K+l6L+U5ZuebnVsbCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGluZm8gPSBnZXRUaGVtZUluZm8oKTtcbiAgICAgIGV4cGVjdChpbmZvKS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpei/lOWbnuS4u+mimOmFjee9ricsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHtcbiAgICAgICAgbW9kZTogJ2RhcmsnIGFzIGNvbnN0LFxuICAgICAgICB2ZXJzaW9uOiAnMS4wLjAnLFxuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICB9O1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3l5YzMtdGhlbWUnLCBKU09OLnN0cmluZ2lmeShjb25maWcpKTtcbiAgICAgIGNvbnN0IGluZm8gPSBnZXRUaGVtZUluZm8oKTtcbiAgICAgIGV4cGVjdChpbmZvKS50b0VxdWFsKGNvbmZpZyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdpc1RoZW1lUGVyc2lzdGVkJywgKCkgPT4ge1xuICAgIGl0KCflvZPmsqHmnInlrZjlgqjnmoTkuLvpopjml7blupTor6Xov5Tlm55mYWxzZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHBlcnNpc3RlZCA9IGlzVGhlbWVQZXJzaXN0ZWQoKTtcbiAgICAgIGV4cGVjdChwZXJzaXN0ZWQpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W9k+acieWtmOWCqOeahOS4u+mimOaXtuW6lOivpei/lOWbnnRydWUnLCAoKSA9PiB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcbiAgICAgICAgJ3l5YzMtdGhlbWUnLFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgbW9kZTogJ2RhcmsnLFxuICAgICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHBlcnNpc3RlZCA9IGlzVGhlbWVQZXJzaXN0ZWQoKTtcbiAgICAgIGV4cGVjdChwZXJzaXN0ZWQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=