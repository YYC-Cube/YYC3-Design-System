e9c955d47209949dd5dd87d6fbdc6106
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Select = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const useTheme_1 = require("../theme/useTheme");
const getTokenValue = (tokens, key) => {
    if (!tokens || typeof tokens !== 'object') {
        return '#000000';
    }
    const value = tokens[key];
    if (typeof value === 'string') {
        return value;
    }
    return '#000000';
};
const Select = ({ options, value, onChange, placeholder = 'Select...', disabled = false, className = '', 'data-testid': dataTestId, }) => {
    const { tokens } = (0, useTheme_1.useTheme)();
    const [isOpen, setIsOpen] = (0, react_1.useState)(false);
    const [internalValue, setInternalValue] = (0, react_1.useState)(value || '');
    const selectRef = (0, react_1.useRef)(null);
    const isControlled = value !== undefined;
    const currentValue = isControlled ? value : internalValue;
    const selectedOption = (0, react_1.useMemo)(() => options.find((opt) => opt.value === currentValue), [options, currentValue]);
    const handleToggle = (0, react_1.useCallback)(() => {
        if (!disabled) {
            setIsOpen((prev) => !prev);
        }
    }, [disabled]);
    const handleSelect = (0, react_1.useCallback)((optionValue) => {
        if (!isControlled) {
            setInternalValue(optionValue);
        }
        if (onChange) {
            onChange(optionValue);
        }
        setIsOpen(false);
    }, [isControlled, onChange]);
    const handleClickOutside = (0, react_1.useCallback)((e) => {
        if (selectRef.current && !selectRef.current.contains(e.target)) {
            setIsOpen(false);
        }
    }, []);
    (0, react_1.useEffect)(() => {
        document.addEventListener('mousedown', handleClickOutside);
        return () => {
            document.removeEventListener('mousedown', handleClickOutside);
        };
    }, [handleClickOutside]);
    const selectStyle = (0, react_1.useMemo)(() => ({
        position: 'relative',
        display: 'inline-block',
        minWidth: '200px',
    }), []);
    const triggerStyle = (0, react_1.useMemo)(() => ({
        width: '100%',
        padding: '0.5rem 0.75rem',
        borderRadius: getTokenValue(tokens.radius, 'md'),
        border: `1px solid ${getTokenValue(tokens.color, 'muted-foreground')}`,
        backgroundColor: tokens['color.background'] || '#fbfbfc',
        color: tokens['color.foreground'] || '#000',
        fontSize: tokens['font-size.body'] || '1rem',
        fontFamily: tokens['typography.font-sans'] || 'system-ui',
        cursor: disabled ? 'not-allowed' : 'pointer',
        opacity: disabled ? 0.5 : 1,
        display: 'flex',
        justifyContent: 'space-between',
        alignItems: 'center',
        transition: 'all 0.2s ease',
    }), [tokens, disabled]);
    const dropdownStyle = (0, react_1.useMemo)(() => ({
        position: 'absolute',
        top: '100%',
        left: 0,
        right: 0,
        marginTop: '0.25rem',
        backgroundColor: tokens['color.card'] || '#f8f9ef',
        borderRadius: getTokenValue(tokens.radius, 'md'),
        boxShadow: `0 4px 12px rgba(0, 0, 0, 0.15)`,
        zIndex: 1000,
        display: isOpen ? 'block' : 'none',
        maxHeight: '200px',
        overflowY: 'auto',
    }), [tokens, isOpen]);
    const optionStyle = (0, react_1.useMemo)(() => ({
        padding: '0.5rem 0.75rem',
        cursor: 'pointer',
        transition: 'background 0.2s ease',
        fontSize: tokens['font-size.body'] || '1rem',
        fontFamily: tokens['typography.font-sans'] || 'system-ui',
        color: tokens['color.foreground'] || '#000',
    }), [tokens]);
    const handleOptionMouseEnter = (0, react_1.useCallback)((e) => {
        e.currentTarget.style.backgroundColor = tokens['color.primary'] || '#d45a5f';
        e.currentTarget.style.color = tokens['color.foreground'] || '#fff';
    }, [tokens]);
    const handleOptionMouseLeave = (0, react_1.useCallback)((e) => {
        e.currentTarget.style.backgroundColor = 'transparent';
        e.currentTarget.style.color = tokens['color.foreground'] || '#000';
    }, [tokens]);
    return ((0, jsx_runtime_1.jsxs)("div", { ref: selectRef, style: selectStyle, className: className, "data-testid": dataTestId, children: [(0, jsx_runtime_1.jsxs)("div", { style: triggerStyle, onClick: handleToggle, role: "combobox", "aria-expanded": isOpen, "aria-haspopup": "listbox", tabIndex: disabled ? -1 : 0, children: [(0, jsx_runtime_1.jsx)("span", { children: selectedOption ? selectedOption.label : placeholder }), (0, jsx_runtime_1.jsx)("span", { style: { marginLeft: '0.5rem' }, children: isOpen ? '▲' : '▼' })] }), (0, jsx_runtime_1.jsx)("div", { style: dropdownStyle, role: "listbox", children: options.map((option) => ((0, jsx_runtime_1.jsx)("div", { style: optionStyle, onClick: () => handleSelect(option.value), onMouseEnter: handleOptionMouseEnter, onMouseLeave: handleOptionMouseLeave, role: "option", "aria-selected": currentValue === option.value, children: option.label }, option.value))) })] }));
};
exports.Select = Select;
exports.default = exports.Select;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL2NvbXBvbmVudHMvU2VsZWN0LnRzeCIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUNBQWlGO0FBQ2pGLGdEQUE2QztBQWlCN0MsTUFBTSxhQUFhLEdBQUcsQ0FBQyxNQUFlLEVBQUUsR0FBVyxFQUFVLEVBQUU7SUFDN0QsSUFBSSxDQUFDLE1BQU0sSUFBSSxPQUFPLE1BQU0sS0FBSyxRQUFRLEVBQUUsQ0FBQztRQUMxQyxPQUFPLFNBQVMsQ0FBQztJQUNuQixDQUFDO0lBQ0QsTUFBTSxLQUFLLEdBQUksTUFBa0MsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN2RCxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRSxDQUFDO1FBQzlCLE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUNELE9BQU8sU0FBUyxDQUFDO0FBQ25CLENBQUMsQ0FBQztBQUVLLE1BQU0sTUFBTSxHQUEwQixDQUFDLEVBQzVDLE9BQU8sRUFDUCxLQUFLLEVBQ0wsUUFBUSxFQUNSLFdBQVcsR0FBRyxXQUFXLEVBQ3pCLFFBQVEsR0FBRyxLQUFLLEVBQ2hCLFNBQVMsR0FBRyxFQUFFLEVBQ2QsYUFBYSxFQUFFLFVBQVUsR0FDMUIsRUFBRSxFQUFFO0lBQ0gsTUFBTSxFQUFFLE1BQU0sRUFBRSxHQUFHLElBQUEsbUJBQVEsR0FBRSxDQUFDO0lBQzlCLE1BQU0sQ0FBQyxNQUFNLEVBQUUsU0FBUyxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzVDLE1BQU0sQ0FBQyxhQUFhLEVBQUUsZ0JBQWdCLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsS0FBSyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ2hFLE1BQU0sU0FBUyxHQUFHLElBQUEsY0FBTSxFQUFpQixJQUFJLENBQUMsQ0FBQztJQUMvQyxNQUFNLFlBQVksR0FBRyxLQUFLLEtBQUssU0FBUyxDQUFDO0lBQ3pDLE1BQU0sWUFBWSxHQUFHLFlBQVksQ0FBQyxD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QUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBUSxJQUM5RCxFQUNOLGdDQUFLLEtBQUssRUFBRSxhQUFhLEVBQUUsSUFBSSxFQUFDLFNBQVMsWUFDdEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsQ0FDdkIsZ0NBRUUsS0FBSyxFQUFFLFdBQVcsRUFDbEIsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQ3pDLFlBQVksRUFBRSxzQkFBc0IsRUFDcEMsWUFBWSxFQUFFLHNCQUFzQixFQUNwQyxJQUFJLEVBQUMsUUFBUSxtQkFDRSxZQUFZLEtBQUssTUFBTSxDQUFDLEtBQUssWUFFM0MsTUFBTSxDQUFDLEtBQUssSUFSUixNQUFNLENBQUMsS0FBSyxDQVNiLENBQ1AsQ0FBQyxHQUNFLElBQ0YsQ0FDUCxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBOUpXLFFBQUEsTUFBTSxVQThKakI7QUFFRixrQkFBZSxjQUFNLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL2NvbXBvbmVudHMvU2VsZWN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZVJlZiwgdXNlRWZmZWN0LCB1c2VDYWxsYmFjaywgdXNlTWVtbyB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHVzZVRoZW1lIH0gZnJvbSAnLi4vdGhlbWUvdXNlVGhlbWUnO1xuXG5pbnRlcmZhY2UgU2VsZWN0T3B0aW9uIHtcbiAgdmFsdWU6IHN0cmluZztcbiAgbGFiZWw6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFNlbGVjdFByb3BzIHtcbiAgb3B0aW9uczogU2VsZWN0T3B0aW9uW107XG4gIHZhbHVlPzogc3RyaW5nO1xuICBvbkNoYW5nZT86ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xuICBwbGFjZWhvbGRlcj86IHN0cmluZztcbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICBjbGFzc05hbWU/OiBzdHJpbmc7XG4gICdkYXRhLXRlc3RpZCc/OiBzdHJpbmc7XG59XG5cbmNvbnN0IGdldFRva2VuVmFsdWUgPSAodG9rZW5zOiB1bmtub3duLCBrZXk6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIGlmICghdG9rZW5zIHx8IHR5cGVvZiB0b2tlbnMgIT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuICcjMDAwMDAwJztcbiAgfVxuICBjb25zdCB2YWx1ZSA9ICh0b2tlbnMgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pW2tleV07XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIHJldHVybiAnIzAwMDAwMCc7XG59O1xuXG5leHBvcnQgY29uc3QgU2VsZWN0OiBSZWFjdC5GQzxTZWxlY3RQcm9wcz4gPSAoe1xuICBvcHRpb25zLFxuICB2YWx1ZSxcbiAgb25DaGFuZ2UsXG4gIHBsYWNlaG9sZGVyID0gJ1NlbGVjdC4uLicsXG4gIGRpc2FibGVkID0gZmFsc2UsXG4gIGNsYXNzTmFtZSA9ICcnLFxuICAnZGF0YS10ZXN0aWQnOiBkYXRhVGVzdElkLFxufSkgPT4ge1xuICBjb25zdCB7IHRva2VucyB9ID0gdXNlVGhlbWUoKTtcbiAgY29uc3QgW2lzT3Blbiwgc2V0SXNPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2ludGVybmFsVmFsdWUsIHNldEludGVybmFsVmFsdWVdID0gdXNlU3RhdGUodmFsdWUgfHwgJycpO1xuICBjb25zdCBzZWxlY3RSZWYgPSB1c2VSZWY8SFRNTERpdkVsZW1lbnQ+KG51bGwpO1xuICBjb25zdCBpc0NvbnRyb2xsZWQgPSB2YWx1ZSAhPT0gdW5kZWZpbmVkO1xuICBjb25zdCBjdXJyZW50VmFsdWUgPSBpc0NvbnRyb2xsZWQgPyB2YWx1ZSA6IGludGVybmFsVmFsdWU7XG5cbiAgY29uc3Qgc2VsZWN0ZWRPcHRpb24gPSB1c2VNZW1vKFxuICAgICgpID0+IG9wdGlvbnMuZmluZCgob3B0KSA9PiBvcHQudmFsdWUgPT09IGN1cnJlbnRWYWx1ZSksXG4gICAgW29wdGlvbnMsIGN1cnJlbnRWYWx1ZV1cbiAgKTtcblxuICBjb25zdCBoYW5kbGVUb2dnbGUgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKCFkaXNhYmxlZCkge1xuICAgICAgc2V0SXNPcGVuKChwcmV2KSA9PiAhcHJldik7XG4gICAgfVxuICB9LCBbZGlzYWJsZWRdKTtcblxuICBjb25zdCBoYW5kbGVTZWxlY3QgPSB1c2VDYWxsYmFjayhcbiAgICAob3B0aW9uVmFsdWU6IHN0cmluZykgPT4ge1xuICAgICAgaWYgKCFpc0NvbnRyb2xsZWQpIHtcbiAgICAgICAgc2V0SW50ZXJuYWxWYWx1ZShvcHRpb25WYWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAob25DaGFuZ2UpIHtcbiAgICAgICAgb25DaGFuZ2Uob3B0aW9uVmFsdWUpO1xuICAgICAgfVxuICAgICAgc2V0SXNPcGVuKGZhbHNlKTtcbiAgICB9LFxuICAgIFtpc0NvbnRyb2xsZWQsIG9uQ2hhbmdlXVxuICApO1xuXG4gIGNvbnN0IGhhbmRsZUNsaWNrT3V0c2lkZSA9IHVzZUNhbGxiYWNrKChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgaWYgKHNlbGVjdFJlZi5jdXJyZW50ICYmICFzZWxlY3RSZWYuY3VycmVudC5jb250YWlucyhlLnRhcmdldCBhcyBOb2RlKSkge1xuICAgICAgc2V0SXNPcGVuKGZhbHNlKTtcbiAgICB9XG4gIH0sIFtdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGhhbmRsZUNsaWNrT3V0c2lkZSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGhhbmRsZUNsaWNrT3V0c2lkZSk7XG4gICAgfTtcbiAgfSwgW2hhbmRsZUNsaWNrT3V0c2lkZV0pO1xuXG4gIGNvbnN0IHNlbGVjdFN0eWxlID0gdXNlTWVtbzxSZWFjdC5DU1NQcm9wZXJ0aWVzPihcbiAgICAoKSA9PiAoe1xuICAgICAgcG9zaXRpb246ICdyZWxhdGl2ZScsXG4gICAgICBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJyxcbiAgICAgIG1pbldpZHRoOiAnMjAwcHgnLFxuICAgIH0pLFxuICAgIFtdXG4gICk7XG5cbiAgY29uc3QgdHJpZ2dlclN0eWxlID0gdXNlTWVtbzxSZWFjdC5DU1NQcm9wZXJ0aWVzPihcbiAgICAoKSA9PiAoe1xuICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgIHBhZGRpbmc6ICcwLjVyZW0gMC43NXJlbScsXG4gICAgICBib3JkZXJSYWRpdXM6IGdldFRva2VuVmFsdWUodG9rZW5zLnJhZGl1cywgJ21kJyksXG4gICAgICBib3JkZXI6IGAxcHggc29saWQgJHtnZXRUb2tlblZhbHVlKHRva2Vucy5jb2xvciwgJ211dGVkLWZvcmVncm91bmQnKX1gLFxuICAgICAgYmFja2dyb3VuZENvbG9yOiAodG9rZW5zWydjb2xvci5iYWNrZ3JvdW5kJ10gYXMgc3RyaW5nKSB8fCAnI2ZiZmJmYycsXG4gICAgICBjb2xvcjogKHRva2Vuc1snY29sb3IuZm9yZWdyb3VuZCddIGFzIHN0cmluZykgfHwgJyMwMDAnLFxuICAgICAgZm9udFNpemU6ICh0b2tlbnNbJ2ZvbnQtc2l6ZS5ib2R5J10gYXMgc3RyaW5nKSB8fCAnMXJlbScsXG4gICAgICBmb250RmFtaWx5OiAodG9rZW5zWyd0eXBvZ3JhcGh5LmZvbnQtc2FucyddIGFzIHN0cmluZykgfHwgJ3N5c3RlbS11aScsXG4gICAgICBjdXJzb3I6IGRpc2FibGVkID8gJ25vdC1hbGxvd2VkJyA6ICdwb2ludGVyJyxcbiAgICAgIG9wYWNpdHk6IGRpc2FibGVkID8gMC41IDogMSxcbiAgICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICAgIGp1c3RpZnlDb250ZW50OiAnc3BhY2UtYmV0d2VlbicsXG4gICAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgICAgIHRyYW5zaXRpb246ICdhbGwgMC4ycyBlYXNlJyxcbiAgICB9KSxcbiAgICBbdG9rZW5zLCBkaXNhYmxlZF1cbiAgKTtcblxuICBjb25zdCBkcm9wZG93blN0eWxlID0gdXNlTWVtbzxSZWFjdC5DU1NQcm9wZXJ0aWVzPihcbiAgICAoKSA9PiAoe1xuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICB0b3A6ICcxMDAlJyxcbiAgICAgIGxlZnQ6IDAsXG4gICAgICByaWdodDogMCxcbiAgICAgIG1hcmdpblRvcDogJzAuMjVyZW0nLFxuICAgICAgYmFja2dyb3VuZENvbG9yOiAodG9rZW5zWydjb2xvci5jYXJkJ10gYXMgc3RyaW5nKSB8fCAnI2Y4ZjllZicsXG4gICAgICBib3JkZXJSYWRpdXM6IGdldFRva2VuVmFsdWUodG9rZW5zLnJhZGl1cywgJ21kJyksXG4gICAgICBib3hTaGFkb3c6IGAwIDRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4xNSlgLFxuICAgICAgekluZGV4OiAxMDAwLFxuICAgICAgZGlzcGxheTogaXNPcGVuID8gJ2Jsb2NrJyA6ICdub25lJyxcbiAgICAgIG1heEhlaWdodDogJzIwMHB4JyxcbiAgICAgIG92ZXJmbG93WTogJ2F1dG8nLFxuICAgIH0pLFxuICAgIFt0b2tlbnMsIGlzT3Blbl1cbiAgKTtcblxuICBjb25zdCBvcHRpb25TdHlsZSA9IHVzZU1lbW88UmVhY3QuQ1NTUHJvcGVydGllcz4oXG4gICAgKCkgPT4gKHtcbiAgICAgIHBhZGRpbmc6ICcwLjVyZW0gMC43NXJlbScsXG4gICAgICBjdXJzb3I6ICdwb2ludGVyJyxcbiAgICAgIHRyYW5zaXRpb246ICdiYWNrZ3JvdW5kIDAuMnMgZWFzZScsXG4gICAgICBmb250U2l6ZTogKHRva2Vuc1snZm9udC1zaXplLmJvZHknXSBhcyBzdHJpbmcpIHx8ICcxcmVtJyxcbiAgICAgIGZvbnRGYW1pbHk6ICh0b2tlbnNbJ3R5cG9ncmFwaHkuZm9udC1zYW5zJ10gYXMgc3RyaW5nKSB8fCAnc3lzdGVtLXVpJyxcbiAgICAgIGNvbG9yOiAodG9rZW5zWydjb2xvci5mb3JlZ3JvdW5kJ10gYXMgc3RyaW5nKSB8fCAnIzAwMCcsXG4gICAgfSksXG4gICAgW3Rva2Vuc11cbiAgKTtcblxuICBjb25zdCBoYW5kbGVPcHRpb25Nb3VzZUVudGVyID0gdXNlQ2FsbGJhY2soXG4gICAgKGU6IFJlYWN0Lk1vdXNlRXZlbnQ8SFRNTERpdkVsZW1lbnQ+KSA9PiB7XG4gICAgICBlLmN1cnJlbnRUYXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gKHRva2Vuc1snY29sb3IucHJpbWFyeSddIGFzIHN0cmluZykgfHwgJyNkNDVhNWYnO1xuICAgICAgZS5jdXJyZW50VGFyZ2V0LnN0eWxlLmNvbG9yID0gKHRva2Vuc1snY29sb3IuZm9yZWdyb3VuZCddIGFzIHN0cmluZykgfHwgJyNmZmYnO1xuICAgIH0sXG4gICAgW3Rva2Vuc11cbiAgKTtcblxuICBjb25zdCBoYW5kbGVPcHRpb25Nb3VzZUxlYXZlID0gdXNlQ2FsbGJhY2soXG4gICAgKGU6IFJlYWN0Lk1vdXNlRXZlbnQ8SFRNTERpdkVsZW1lbnQ+KSA9PiB7XG4gICAgICBlLmN1cnJlbnRUYXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3RyYW5zcGFyZW50JztcbiAgICAgIGUuY3VycmVudFRhcmdldC5zdHlsZS5jb2xvciA9ICh0b2tlbnNbJ2NvbG9yLmZvcmVncm91bmQnXSBhcyBzdHJpbmcpIHx8ICcjMDAwJztcbiAgICB9LFxuICAgIFt0b2tlbnNdXG4gICk7XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IHJlZj17c2VsZWN0UmVmfSBzdHlsZT17c2VsZWN0U3R5bGV9IGNsYXNzTmFtZT17Y2xhc3NOYW1lfSBkYXRhLXRlc3RpZD17ZGF0YVRlc3RJZH0+XG4gICAgICA8ZGl2XG4gICAgICAgIHN0eWxlPXt0cmlnZ2VyU3R5bGV9XG4gICAgICAgIG9uQ2xpY2s9e2hhbmRsZVRvZ2dsZX1cbiAgICAgICAgcm9sZT1cImNvbWJvYm94XCJcbiAgICAgICAgYXJpYS1leHBhbmRlZD17aXNPcGVufVxuICAgICAgICBhcmlhLWhhc3BvcHVwPVwibGlzdGJveFwiXG4gICAgICAgIHRhYkluZGV4PXtkaXNhYmxlZCA/IC0xIDogMH1cbiAgICAgID5cbiAgICAgICAgPHNwYW4+e3NlbGVjdGVkT3B0aW9uID8gc2VsZWN0ZWRPcHRpb24ubGFiZWwgOiBwbGFjZWhvbGRlcn08L3NwYW4+XG4gICAgICAgIDxzcGFuIHN0eWxlPXt7IG1hcmdpbkxlZnQ6ICcwLjVyZW0nIH19Pntpc09wZW4gPyAn4payJyA6ICfilrwnfTwvc3Bhbj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBzdHlsZT17ZHJvcGRvd25TdHlsZX0gcm9sZT1cImxpc3Rib3hcIj5cbiAgICAgICAge29wdGlvbnMubWFwKChvcHRpb24pID0+IChcbiAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICBrZXk9e29wdGlvbi52YWx1ZX1cbiAgICAgICAgICAgIHN0eWxlPXtvcHRpb25TdHlsZX1cbiAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZVNlbGVjdChvcHRpb24udmFsdWUpfVxuICAgICAgICAgICAgb25Nb3VzZUVudGVyPXtoYW5kbGVPcHRpb25Nb3VzZUVudGVyfVxuICAgICAgICAgICAgb25Nb3VzZUxlYXZlPXtoYW5kbGVPcHRpb25Nb3VzZUxlYXZlfVxuICAgICAgICAgICAgcm9sZT1cIm9wdGlvblwiXG4gICAgICAgICAgICBhcmlhLXNlbGVjdGVkPXtjdXJyZW50VmFsdWUgPT09IG9wdGlvbi52YWx1ZX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7b3B0aW9uLmxhYmVsfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApKX1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgU2VsZWN0O1xuIl0sInZlcnNpb24iOjN9