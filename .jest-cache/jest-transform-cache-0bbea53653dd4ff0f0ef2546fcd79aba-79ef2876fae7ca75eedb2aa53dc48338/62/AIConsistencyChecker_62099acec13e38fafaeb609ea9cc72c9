d6dcf0ced22cd0c1ac95247c01da188a
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AIConsistencyChecker = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
/**
 * @file AI 一致性检查组件
 * @description 提供用户界面来检查设计令牌的一致性
 * @component AIConsistencyChecker
 * @author YYC³
 * @version 1.0.0
 * @created 2026-02-18
 */
const react_1 = require("react");
const Card_1 = require("./Card");
const Button_1 = require("./Button");
const Badge_1 = require("./Badge");
const useTheme_1 = require("../theme/useTheme");
const consistency_checker_1 = require("../ai/consistency-checker");
const getTokenValue = (tokens, key) => {
    const value = tokens[key];
    return typeof value === 'string' ? value : '#000000';
};
const AIConsistencyChecker = ({ tokens, onFixIssue, className = '', }) => {
    const { tokens: themeTokens } = (0, useTheme_1.useTheme)();
    const [report, setReport] = (0, react_1.useState)(null);
    const [isChecking, setIsChecking] = (0, react_1.useState)(false);
    const handleCheck = (0, react_1.useCallback)(() => {
        setIsChecking(true);
        const tokensToCheck = tokens || themeTokens;
        const newReport = consistency_checker_1.consistencyChecker.check(tokensToCheck);
        setReport(newReport);
        setIsChecking(false);
    }, [tokens, themeTokens]);
    const getSeverityColor = (severity) => {
        switch (severity) {
            case 'error':
                return '#ef4444';
            case 'warning':
                return '#f59e0b';
            case 'info':
                return '#3b82f6';
            default:
                return '#6b7280';
        }
    };
    const getScoreColor = (score) => {
        if (score >= 80)
            return '#10b981';
        if (score >= 60)
            return '#f59e0b';
        return '#ef4444';
    };
    const getSeverityLabel = (severity) => {
        switch (severity) {
            case 'error':
                return '错误';
            case 'warning':
                return '警告';
            case 'info':
                return '信息';
            default:
                return '未知';
        }
    };
    return ((0, jsx_runtime_1.jsxs)(Card_1.Card, { className: className, children: [(0, jsx_runtime_1.jsx)(Card_1.CardHeader, { children: (0, jsx_runtime_1.jsx)(Card_1.CardTitle, { children: "AI \u8BBE\u8BA1\u4E00\u81F4\u6027\u68C0\u67E5" }) }), (0, jsx_runtime_1.jsxs)(Card_1.CardContent, { className: "space-y-6", children: [(0, jsx_runtime_1.jsx)(Button_1.Button, { onClick: handleCheck, disabled: isChecking, className: "w-full", children: isChecking ? '检查中...' : '开始检查' }), report && ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-6", children: [(0, jsx_runtime_1.jsxs)("div", { className: "text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "text-5xl font-bold mb-2", style: { color: getScoreColor(report.overallScore) }, children: report.overallScore }), (0, jsx_runtime_1.jsx)("div", { className: "text-sm", style: { color: getTokenValue(themeTokens, 'color.muted-foreground') }, children: "\u4E00\u81F4\u6027\u8BC4\u5206" })] }), (0, jsx_runtime_1.jsx)("div", { className: "grid grid-cols-5 gap-2", children: Object.entries(report.categories).map(([key, value]) => ((0, jsx_runtime_1.jsxs)("div", { className: "text-center p-3 rounded-lg", style: {
                                        background: getTokenValue(themeTokens, 'color.card'),
                                        border: `1px solid ${getTokenValue(themeTokens, 'color.border')}`,
                                    }, children: [(0, jsx_runtime_1.jsx)("div", { className: "text-lg font-bold", style: { color: getScoreColor(value.score) }, children: value.score }), (0, jsx_runtime_1.jsx)("div", { className: "text-xs mt-1", style: { color: getTokenValue(themeTokens, 'color.muted-foreground') }, children: key }), (0, jsx_runtime_1.jsxs)("div", { className: "text-xs mt-1", style: { color: getSeverityColor('error') }, children: [value.issues, " \u95EE\u9898"] })] }, key))) }), report.issues.length > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-3", children: [(0, jsx_runtime_1.jsxs)("h3", { className: "text-sm font-medium", style: { color: getTokenValue(themeTokens, 'color.foreground') }, children: ["\u53D1\u73B0\u7684\u95EE\u9898 (", report.issues.length, ")"] }), (0, jsx_runtime_1.jsx)("div", { className: "space-y-2", children: report.issues.map((issue) => ((0, jsx_runtime_1.jsxs)("div", { className: "p-4 rounded-lg", style: {
                                                background: getTokenValue(themeTokens, 'color.card'),
                                                border: `1px solid ${getTokenValue(themeTokens, 'color.border')}`,
                                            }, children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-start justify-between mb-2", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)(Badge_1.Badge, { style: {
                                                                        background: getSeverityColor(issue.severity),
                                                                        color: '#ffffff',
                                                                    }, children: getSeverityLabel(issue.severity) }), (0, jsx_runtime_1.jsx)(Badge_1.Badge, { variant: "outline", style: {
                                                                        borderColor: getTokenValue(themeTokens, 'color.border'),
                                                                        color: getTokenValue(themeTokens, 'color.muted-foreground'),
                                                                    }, children: issue.category })] }), issue.location && ((0, jsx_runtime_1.jsx)("span", { className: "text-xs", style: { color: getTokenValue(themeTokens, 'color.muted-foreground') }, children: issue.location }))] }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm mb-2", style: { color: getTokenValue(themeTokens, 'color.foreground') }, children: issue.message }), issue.suggestion && ((0, jsx_runtime_1.jsxs)("p", { className: "text-xs", style: { color: getTokenValue(themeTokens, 'color.muted-foreground') }, children: ["\u5EFA\u8BAE: ", issue.suggestion] })), onFixIssue && ((0, jsx_runtime_1.jsx)(Button_1.Button, { size: "sm", variant: "outline", className: "mt-2", onClick: () => onFixIssue(issue.id), children: "\u4FEE\u590D" }))] }, issue.id))) })] })), report.recommendations.length > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("h3", { className: "text-sm font-medium", style: { color: getTokenValue(themeTokens, 'color.foreground') }, children: "\u6539\u8FDB\u5EFA\u8BAE" }), (0, jsx_runtime_1.jsx)("ul", { className: "space-y-2", children: report.recommendations.map((rec, index) => ((0, jsx_runtime_1.jsxs)("li", { className: "text-sm p-3 rounded", style: {
                                                background: getTokenValue(themeTokens, 'color.card'),
                                                border: `1px solid ${getTokenValue(themeTokens, 'color.border')}`,
                                                color: getTokenValue(themeTokens, 'color.foreground'),
                                            }, children: ["\u2022 ", rec] }, index))) })] }))] }))] })] }));
};
exports.AIConsistencyChecker = AIConsistencyChecker;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL2NvbXBvbmVudHMvQUlDb25zaXN0ZW5jeUNoZWNrZXIudHN4IiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7Ozs7OztHQU9HO0FBRUgsaUNBQXFEO0FBQ3JELGlDQUFrRTtBQUNsRSxxQ0FBa0M7QUFDbEMsbUNBQWdDO0FBQ2hDLGdEQUE2QztBQUM3QyxtRUFBa0Y7QUFTbEYsTUFBTSxhQUFhLEdBQUcsQ0FBQyxNQUErQixFQUFFLEdBQVcsRUFBVSxFQUFFO0lBQzdFLE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUMxQixPQUFPLE9BQU8sS0FBSyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7QUFDdkQsQ0FBQyxDQUFDO0FBRUssTUFBTSxvQkFBb0IsR0FBd0MsQ0FBQyxFQUN4RSxNQUFNLEVBQ04sVUFBVSxFQUNWLFNBQVMsR0FBRyxFQUFFLEdBQ2YsRUFBRSxFQUFFO0lBQ0gsTUFBTSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsR0FBRyxJQUFBLG1CQUFRLEdBQUUsQ0FBQztJQUMzQyxNQUFNLENBQUMsTUFBTSxFQUFFLFNBQVMsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBMkIsSUFBSSxDQUFDLENBQUM7SUFDckUsTUFBTSxDQUFDLFVBQVUsRUFBRSxhQUFhLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFFcEQsTUFBTSxXQUFXLEdBQUcsSUFBQSxtQkFBVyxFQUFDLEdBQUcsRUFBRTtRQUNuQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEIsTUFBTSxhQUFhLEdBQUcsTUFBTSxJQUFJLFdBQVcsQ0FBQztRQUM1QyxNQUFNLFNBQVMsR0FBRyx3Q0FBa0IsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDMUQsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ3JCLGFBQWEs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U0FBUyxFQUFDLFdBQVcsWUFDdEIsTUFBTSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUMxQyxnQ0FFRSxTQUFTLEVBQUMscUJBQXFCLEVBQy9CLEtBQUssRUFBRTtnREFDTCxVQUFVLEVBQUUsYUFBYSxDQUFDLFdBQVcsRUFBRSxZQUFZLENBQUM7Z0RBQ3BELE1BQU0sRUFBRSxhQUFhLGFBQWEsQ0FBQyxXQUFXLEVBQUUsY0FBYyxDQUFDLEVBQUU7Z0RBQ2pFLEtBQUssRUFBRSxhQUFhLENBQUMsV0FBVyxFQUFFLGtCQUFrQixDQUFDOzZDQUN0RCx3QkFFRSxHQUFHLEtBUkQsS0FBSyxDQVNQLENBQ04sQ0FBQyxHQUNDLElBQ0QsQ0FDUCxJQUNHLENBQ1AsSUFDVyxJQUNULENBQ1IsQ0FBQztBQUNKLENBQUMsQ0FBQztBQWpOVyxRQUFBLG9CQUFvQix3QkFpTi9CIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy95YW55dS9Eb3dubG9hZHMveXljMy1EZXNpZ24tU3lzdGVtL3NyYy9jb21wb25lbnRzL0FJQ29uc2lzdGVuY3lDaGVja2VyLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIEFJIOS4gOiHtOaAp+ajgOafpee7hOS7tlxuICogQGRlc2NyaXB0aW9uIOaPkOS+m+eUqOaIt+eVjOmdouadpeajgOafpeiuvuiuoeS7pOeJjOeahOS4gOiHtOaAp1xuICogQGNvbXBvbmVudCBBSUNvbnNpc3RlbmN5Q2hlY2tlclxuICogQGF1dGhvciBZWUPCs1xuICogQHZlcnNpb24gMS4wLjBcbiAqIEBjcmVhdGVkIDIwMjYtMDItMThcbiAqL1xuXG5pbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQ2FyZCwgQ2FyZENvbnRlbnQsIENhcmRIZWFkZXIsIENhcmRUaXRsZSB9IGZyb20gJy4vQ2FyZCc7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICcuL0J1dHRvbic7XG5pbXBvcnQgeyBCYWRnZSB9IGZyb20gJy4vQmFkZ2UnO1xuaW1wb3J0IHsgdXNlVGhlbWUgfSBmcm9tICcuLi90aGVtZS91c2VUaGVtZSc7XG5pbXBvcnQgeyBjb25zaXN0ZW5jeUNoZWNrZXIsIENvbnNpc3RlbmN5UmVwb3J0IH0gZnJvbSAnLi4vYWkvY29uc2lzdGVuY3ktY2hlY2tlcic7XG5pbXBvcnQgeyBEZXNpZ25Ub2tlbnMgfSBmcm9tICcuLi8uLi90eXBlcy90b2tlbnMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEFJQ29uc2lzdGVuY3lDaGVja2VyUHJvcHMge1xuICB0b2tlbnM/OiBEZXNpZ25Ub2tlbnM7XG4gIG9uRml4SXNzdWU/OiAoaXNzdWVJZDogc3RyaW5nKSA9PiB2b2lkO1xuICBjbGFzc05hbWU/OiBzdHJpbmc7XG59XG5cbmNvbnN0IGdldFRva2VuVmFsdWUgPSAodG9rZW5zOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwga2V5OiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICBjb25zdCB2YWx1ZSA9IHRva2Vuc1trZXldO1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogJyMwMDAwMDAnO1xufTtcblxuZXhwb3J0IGNvbnN0IEFJQ29uc2lzdGVuY3lDaGVja2VyOiBSZWFjdC5GQzxBSUNvbnNpc3RlbmN5Q2hlY2tlclByb3BzPiA9ICh7XG4gIHRva2VucyxcbiAgb25GaXhJc3N1ZSxcbiAgY2xhc3NOYW1lID0gJycsXG59KSA9PiB7XG4gIGNvbnN0IHsgdG9rZW5zOiB0aGVtZVRva2VucyB9ID0gdXNlVGhlbWUoKTtcbiAgY29uc3QgW3JlcG9ydCwgc2V0UmVwb3J0XSA9IHVzZVN0YXRlPENvbnNpc3RlbmN5UmVwb3J0IHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtpc0NoZWNraW5nLCBzZXRJc0NoZWNraW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICBjb25zdCBoYW5kbGVDaGVjayA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBzZXRJc0NoZWNraW5nKHRydWUpO1xuICAgIGNvbnN0IHRva2Vuc1RvQ2hlY2sgPSB0b2tlbnMgfHwgdGhlbWVUb2tlbnM7XG4gICAgY29uc3QgbmV3UmVwb3J0ID0gY29uc2lzdGVuY3lDaGVja2VyLmNoZWNrKHRva2Vuc1RvQ2hlY2spO1xuICAgIHNldFJlcG9ydChuZXdSZXBvcnQpO1xuICAgIHNldElzQ2hlY2tpbmcoZmFsc2UpO1xuICB9LCBbdG9rZW5zLCB0aGVtZVRva2Vuc10pO1xuXG4gIGNvbnN0IGdldFNldmVyaXR5Q29sb3IgPSAoc2V2ZXJpdHk6IHN0cmluZykgPT4ge1xuICAgIHN3aXRjaCAoc2V2ZXJpdHkpIHtcbiAgICAgIGNhc2UgJ2Vycm9yJzpcbiAgICAgICAgcmV0dXJuICcjZWY0NDQ0JztcbiAgICAgIGNhc2UgJ3dhcm5pbmcnOlxuICAgICAgICByZXR1cm4gJyNmNTllMGInO1xuICAgICAgY2FzZSAnaW5mbyc6XG4gICAgICAgIHJldHVybiAnIzNiODJmNic7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gJyM2YjcyODAnO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBnZXRTY29yZUNvbG9yID0gKHNjb3JlOiBudW1iZXIpID0+IHtcbiAgICBpZiAoc2NvcmUgPj0gODApIHJldHVybiAnIzEwYjk4MSc7XG4gICAgaWYgKHNjb3JlID49IDYwKSByZXR1cm4gJyNmNTllMGInO1xuICAgIHJldHVybiAnI2VmNDQ0NCc7XG4gIH07XG5cbiAgY29uc3QgZ2V0U2V2ZXJpdHlMYWJlbCA9IChzZXZlcml0eTogc3RyaW5nKSA9PiB7XG4gICAgc3dpdGNoIChzZXZlcml0eSkge1xuICAgICAgY2FzZSAnZXJyb3InOlxuICAgICAgICByZXR1cm4gJ+mUmeivryc7XG4gICAgICBjYXNlICd3YXJuaW5nJzpcbiAgICAgICAgcmV0dXJuICforablkYonO1xuICAgICAgY2FzZSAnaW5mbyc6XG4gICAgICAgIHJldHVybiAn5L+h5oGvJztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAn5pyq55+lJztcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8Q2FyZCBjbGFzc05hbWU9e2NsYXNzTmFtZX0+XG4gICAgICA8Q2FyZEhlYWRlcj5cbiAgICAgICAgPENhcmRUaXRsZT5BSSDorr7orqHkuIDoh7TmgKfmo4Dmn6U8L0NhcmRUaXRsZT5cbiAgICAgIDwvQ2FyZEhlYWRlcj5cbiAgICAgIDxDYXJkQ29udGVudCBjbGFzc05hbWU9XCJzcGFjZS15LTZcIj5cbiAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXtoYW5kbGVDaGVja30gZGlzYWJsZWQ9e2lzQ2hlY2tpbmd9IGNsYXNzTmFtZT1cInctZnVsbFwiPlxuICAgICAgICAgIHtpc0NoZWNraW5nID8gJ+ajgOafpeS4rS4uLicgOiAn5byA5aeL5qOA5p+lJ31cbiAgICAgICAgPC9CdXR0b24+XG5cbiAgICAgICAge3JlcG9ydCAmJiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTZcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInRleHQtNXhsIGZvbnQtYm9sZCBtYi0yXCJcbiAgICAgICAgICAgICAgICBzdHlsZT17eyBjb2xvcjogZ2V0U2NvcmVDb2xvcihyZXBvcnQub3ZlcmFsbFNjb3JlKSB9fVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge3JlcG9ydC5vdmVyYWxsU2NvcmV9XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC1zbVwiXG4gICAgICAgICAgICAgICAgc3R5bGU9e3sgY29sb3I6IGdldFRva2VuVmFsdWUodGhlbWVUb2tlbnMsICdjb2xvci5tdXRlZC1mb3JlZ3JvdW5kJykgfX1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIOS4gOiHtOaAp+ivhOWIhlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQgZ3JpZC1jb2xzLTUgZ2FwLTJcIj5cbiAgICAgICAgICAgICAge09iamVjdC5lbnRyaWVzKHJlcG9ydC5jYXRlZ29yaWVzKS5tYXAoKFtrZXksIHZhbHVlXSkgPT4gKFxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgIGtleT17a2V5fVxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXIgcC0zIHJvdW5kZWQtbGdcIlxuICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogZ2V0VG9rZW5WYWx1ZSh0aGVtZVRva2VucywgJ2NvbG9yLmNhcmQnKSxcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkICR7Z2V0VG9rZW5WYWx1ZSh0aGVtZVRva2VucywgJ2NvbG9yLmJvcmRlcicpfWAsXG4gICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1sZyBmb250LWJvbGRcIiBzdHlsZT17eyBjb2xvcjogZ2V0U2NvcmVDb2xvcih2YWx1ZS5zY29yZSkgfX0+XG4gICAgICAgICAgICAgICAgICAgIHt2YWx1ZS5zY29yZX1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0ZXh0LXhzIG10LTFcIlxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBjb2xvcjogZ2V0VG9rZW5WYWx1ZSh0aGVtZVRva2VucywgJ2NvbG9yLm11dGVkLWZvcmVncm91bmQnKSB9fVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7a2V5fVxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQteHMgbXQtMVwiIHN0eWxlPXt7IGNvbG9yOiBnZXRTZXZlcml0eUNvbG9yKCdlcnJvcicpIH19PlxuICAgICAgICAgICAgICAgICAgICB7dmFsdWUuaXNzdWVzfSDpl67pophcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICB7cmVwb3J0Lmlzc3Vlcy5sZW5ndGggPiAwICYmIChcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTNcIj5cbiAgICAgICAgICAgICAgICA8aDNcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIlxuICAgICAgICAgICAgICAgICAgc3R5bGU9e3sgY29sb3I6IGdldFRva2VuVmFsdWUodGhlbWVUb2tlbnMsICdjb2xvci5mb3JlZ3JvdW5kJykgfX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICDlj5HnjrDnmoTpl67popggKHtyZXBvcnQuaXNzdWVzLmxlbmd0aH0pXG4gICAgICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktMlwiPlxuICAgICAgICAgICAgICAgICAge3JlcG9ydC5pc3N1ZXMubWFwKChpc3N1ZSkgPT4gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAga2V5PXtpc3N1ZS5pZH1cbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJwLTQgcm91bmRlZC1sZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IGdldFRva2VuVmFsdWUodGhlbWVUb2tlbnMsICdjb2xvci5jYXJkJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXI6IGAxcHggc29saWQgJHtnZXRUb2tlblZhbHVlKHRoZW1lVG9rZW5zLCAnY29sb3IuYm9yZGVyJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLXN0YXJ0IGp1c3RpZnktYmV0d2VlbiBtYi0yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiBnZXRTZXZlcml0eUNvbG9yKGlzc3VlLnNldmVyaXR5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnI2ZmZmZmZicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtnZXRTZXZlcml0eUxhYmVsKGlzc3VlLnNldmVyaXR5KX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CYWRnZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPEJhZGdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJDb2xvcjogZ2V0VG9rZW5WYWx1ZSh0aGVtZVRva2VucywgJ2NvbG9yLmJvcmRlcicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IGdldFRva2VuVmFsdWUodGhlbWVUb2tlbnMsICdjb2xvci5tdXRlZC1mb3JlZ3JvdW5kJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpc3N1ZS5jYXRlZ29yeX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CYWRnZT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAge2lzc3VlLmxvY2F0aW9uICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0ZXh0LXhzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBjb2xvcjogZ2V0VG9rZW5WYWx1ZSh0aGVtZVRva2VucywgJ2NvbG9yLm11dGVkLWZvcmVncm91bmQnKSB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2lzc3VlLmxvY2F0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDxwXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0ZXh0LXNtIG1iLTJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3sgY29sb3I6IGdldFRva2VuVmFsdWUodGhlbWVUb2tlbnMsICdjb2xvci5mb3JlZ3JvdW5kJykgfX1cbiAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7aXNzdWUubWVzc2FnZX1cbiAgICAgICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgICAgICAge2lzc3VlLnN1Z2dlc3Rpb24gJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC14c1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IGNvbG9yOiBnZXRUb2tlblZhbHVlKHRoZW1lVG9rZW5zLCAnY29sb3IubXV0ZWQtZm9yZWdyb3VuZCcpIH19XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIOW7uuiurjoge2lzc3VlLnN1Z2dlc3Rpb259XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICB7b25GaXhJc3N1ZSAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXQtMlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IG9uRml4SXNzdWUoaXNzdWUuaWQpfVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICDkv67lpI1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAge3JlcG9ydC5yZWNvbW1lbmRhdGlvbnMubGVuZ3RoID4gMCAmJiAoXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0yXCI+XG4gICAgICAgICAgICAgICAgPGgzXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtXCJcbiAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IGNvbG9yOiBnZXRUb2tlblZhbHVlKHRoZW1lVG9rZW5zLCAnY29sb3IuZm9yZWdyb3VuZCcpIH19XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAg5pS56L+b5bu66K6uXG4gICAgICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgICAgICA8dWwgY2xhc3NOYW1lPVwic3BhY2UteS0yXCI+XG4gICAgICAgICAgICAgICAgICB7cmVwb3J0LnJlY29tbWVuZGF0aW9ucy5tYXAoKHJlYywgaW5kZXgpID0+IChcbiAgICAgICAgICAgICAgICAgICAgPGxpXG4gICAgICAgICAgICAgICAgICAgICAga2V5PXtpbmRleH1cbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0ZXh0LXNtIHAtMyByb3VuZGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogZ2V0VG9rZW5WYWx1ZSh0aGVtZVRva2VucywgJ2NvbG9yLmNhcmQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlcjogYDFweCBzb2xpZCAke2dldFRva2VuVmFsdWUodGhlbWVUb2tlbnMsICdjb2xvci5ib3JkZXInKX1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IGdldFRva2VuVmFsdWUodGhlbWVUb2tlbnMsICdjb2xvci5mb3JlZ3JvdW5kJyksXG4gICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIOKAoiB7cmVjfVxuICAgICAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgICAgPC91bD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApfVxuICAgICAgPC9DYXJkQ29udGVudD5cbiAgICA8L0NhcmQ+XG4gICk7XG59O1xuIl0sInZlcnNpb24iOjN9