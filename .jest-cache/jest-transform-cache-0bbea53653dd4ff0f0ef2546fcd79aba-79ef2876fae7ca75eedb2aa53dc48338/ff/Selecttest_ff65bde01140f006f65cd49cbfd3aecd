cacddd9e0ad5b2ec459c1643777a8a53
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("@testing-library/react");
const dom_1 = require("@testing-library/dom");
const Select_1 = require("./Select");
const ThemeProvider_1 = require("../theme/ThemeProvider");
describe('Select 组件', () => {
    const renderWithTheme = (component) => {
        return (0, react_1.render)((0, jsx_runtime_1.jsx)(ThemeProvider_1.ThemeProvider, { children: component }));
    };
    const mockOptions = [
        { value: 'option1', label: 'Option 1' },
        { value: 'option2', label: 'Option 2' },
        { value: 'option3', label: 'Option 3' },
    ];
    it('应该正确渲染默认 Select', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions }));
        expect(dom_1.screen.getByText('Select...')).toBeInTheDocument();
    });
    it('应该显示自定义 placeholder', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions, placeholder: "Choose an option" }));
        expect(dom_1.screen.getByText('Choose an option')).toBeInTheDocument();
    });
    it('应该在点击时打开下拉菜单', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions }));
        const trigger = dom_1.screen.getByText('Select...');
        react_1.fireEvent.click(trigger);
        expect(dom_1.screen.getByText('Option 1')).toBeInTheDocument();
        expect(dom_1.screen.getByText('Option 2')).toBeInTheDocument();
        expect(dom_1.screen.getByText('Option 3')).toBeInTheDocument();
    });
    it('应该在选择选项后关闭下拉菜单', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions }));
        const trigger = dom_1.screen.getByText('Select...');
        react_1.fireEvent.click(trigger);
        const option1 = dom_1.screen.getByText('Option 1');
        react_1.fireEvent.click(option1);
        expect(trigger.textContent).toBe('Option 1');
    });
    it('应该调用 onChange 回调', () => {
        const handleChange = jest.fn();
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions, onChange: handleChange }));
        const trigger = dom_1.screen.getByText('Select...');
        react_1.fireEvent.click(trigger);
        const option1 = dom_1.screen.getByText('Option 1');
        react_1.fireEvent.click(option1);
        expect(handleChange).toHaveBeenCalledWith('option1');
    });
    it('应该在禁用状态下不响应点击', () => {
        const handleChange = jest.fn();
        const { container } = renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions, disabled: true, onChange: handleChange }));
        const trigger = dom_1.screen.getByRole('combobox');
        react_1.fireEvent.click(trigger);
        const dropdown = container.querySelector('[role="listbox"]');
        expect(dropdown).toHaveStyle({ display: 'none' });
        expect(handleChange).not.toHaveBeenCalled();
    });
    it('应该支持受控模式', () => {
        const handleChange = jest.fn();
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions, value: "option1", onChange: handleChange }));
        const trigger = dom_1.screen.getByRole('combobox');
        expect(trigger.textContent).toContain('Option 1');
    });
    it('应该在受控模式下正确更新值', () => {
        const handleChange = jest.fn();
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions, value: "option1", onChange: handleChange }));
        const trigger = dom_1.screen.getByRole('combobox');
        expect(trigger.textContent).toContain('Option 1');
    });
    it('应该在点击外部时关闭下拉菜单', () => {
        const { container } = renderWithTheme((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions }), (0, jsx_runtime_1.jsx)("div", { "data-testid": "outside", children: "Outside" })] }));
        const trigger = dom_1.screen.getByRole('combobox');
        react_1.fireEvent.click(trigger);
        expect(dom_1.screen.getByText('Option 1')).toBeInTheDocument();
        const outside = dom_1.screen.getByTestId('outside');
        react_1.fireEvent.mouseDown(outside);
        const dropdown = container.querySelector('[role="listbox"]');
        expect(dropdown).toHaveStyle({ display: 'none' });
    });
    it('应该应用自定义 className', () => {
        const { container } = renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions, className: "custom-class" }));
        const select = container.querySelector('.custom-class');
        expect(select).toBeInTheDocument();
    });
    it('应该在悬停选项时改变样式', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions }));
        const trigger = dom_1.screen.getByRole('combobox');
        react_1.fireEvent.click(trigger);
        const options = dom_1.screen.getAllByRole('option');
        const option1 = options.find((opt) => opt.textContent === 'Option 1');
        if (option1) {
            react_1.fireEvent.mouseEnter(option1);
        }
        expect(option1).toHaveStyle({
            backgroundColor: 'rgb(224, 106, 112)',
            color: 'rgb(240, 240, 240)',
        });
    });
    it('应该在离开选项时恢复样式', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions }));
        const trigger = dom_1.screen.getByRole('combobox');
        react_1.fireEvent.click(trigger);
        const options = dom_1.screen.getAllByRole('option');
        const option1 = options.find((opt) => opt.textContent === 'Option 1');
        if (option1) {
            react_1.fireEvent.mouseEnter(option1);
        }
        expect(option1).toHaveStyle({
            backgroundColor: 'rgb(224, 106, 112)',
            color: 'rgb(240, 240, 240)',
        });
        if (option1) {
            react_1.fireEvent.mouseLeave(option1);
        }
        expect(option1).toHaveStyle({
            color: 'rgb(240, 240, 240)',
        });
    });
    it('应该正确显示箭头图标', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions }));
        const trigger = dom_1.screen.getByRole('combobox');
        expect(trigger.textContent).toContain('▼');
        react_1.fireEvent.click(trigger);
        expect(trigger.textContent).toContain('▲');
    });
    it('应该在非受控模式下维护内部状态', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions }));
        const trigger = dom_1.screen.getByText('Select...');
        react_1.fireEvent.click(trigger);
        const option1 = dom_1.screen.getByText('Option 1');
        react_1.fireEvent.click(option1);
        expect(trigger.textContent).toBe('Option 1');
        react_1.fireEvent.click(trigger);
        const option2 = dom_1.screen.getByText('Option 2');
        react_1.fireEvent.click(option2);
        expect(trigger.textContent).toBe('Option 2');
    });
    it('应该正确设置 aria 属性', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions }));
        const trigger = dom_1.screen.getByRole('combobox');
        expect(trigger).toHaveAttribute('role', 'combobox');
        expect(trigger).toHaveAttribute('aria-expanded', 'false');
        expect(trigger).toHaveAttribute('aria-haspopup', 'listbox');
    });
    it('应该在打开时更新 aria-expanded', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions }));
        const trigger = dom_1.screen.getByRole('combobox');
        expect(trigger).toHaveAttribute('aria-expanded', 'false');
        react_1.fireEvent.click(trigger);
        expect(trigger).toHaveAttribute('aria-expanded', 'true');
    });
    it('应该在禁用时设置正确的 tabIndex', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions, disabled: true }));
        const trigger = dom_1.screen.getByRole('combobox');
        expect(trigger).toHaveAttribute('tabIndex', '-1');
    });
    it('应该在未禁用时设置正确的 tabIndex', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions }));
        const trigger = dom_1.screen.getByRole('combobox');
        expect(trigger).toHaveAttribute('tabIndex', '0');
    });
    it('应该为选项设置正确的 aria-selected', () => {
        renderWithTheme((0, jsx_runtime_1.jsx)(Select_1.Select, { options: mockOptions, value: "option1" }));
        const trigger = dom_1.screen.getByRole('combobox');
        react_1.fireEvent.click(trigger);
        const options = dom_1.screen.getAllByRole('option');
        const option1 = options.find((opt) => opt.textContent === 'Option 1');
        const option2 = options.find((opt) => opt.textContent === 'Option 2');
        expect(option1).toHaveAttribute('aria-selected', 'true');
        expect(option2).toHaveAttribute('aria-selected', 'false');
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL2NvbXBvbmVudHMvU2VsZWN0LnRlc3QudHN4IiwibWFwcGluZ3MiOiI7OztBQVVBLGtEQUEyRDtBQUMzRCw4Q0FBOEM7QUFFOUMscUNBQWtDO0FBQ2xDLDBEQUF1RDtBQUV2RCxRQUFRLENBQUMsV0FBVyxFQUFFLEdBQUcsRUFBRTtJQUN6QixNQUFNLGVBQWUsR0FBRyxDQUFDLFNBQTZCLEVBQUUsRUFBRTtRQUN4RCxPQUFPLElBQUEsY0FBTSxFQUFDLHVCQUFDLDZCQUFhLGNBQUUsU0FBUyxHQUFpQixDQUFDLENBQUM7SUFDNUQsQ0FBQyxDQUFDO0lBRUYsTUFBTSxXQUFXLEdBQUc7UUFDbEIsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUU7UUFDdkMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUU7UUFDdkMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUU7S0FDeEMsQ0FBQztJQUVGLEVBQUUsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7UUFDekIsZUFBZSxDQUFDLHVCQUFDLGVBQU0sSUFBQyxPQUFPLEVBQUUsV0FBVyxHQUFJLENBQUMsQ0FBQztRQUVsRCxNQUFNLENBQUMsWUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUM7SUFDNUQsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMscUJBQXFCLEVBQUUsR0FBRyxFQUFFO1FBQzdCLGVBQWUsQ0FBQyx1QkFBQyxlQUFNLElBQUMsT0FBTyxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUMsa0JBQWtCLEdBQUcsQ0FBQyxDQUFDO1FBRWpGLE1BQU0sQ0FBQyxZQUFNLENBQUMsU0FBUyxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO0lBQ25FLENBQUMsQ0FBQyxDQUFD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QUFDLGVBQWUsRUFBRSxNQUFNLENBQUMsQ0FBQztRQUN6RCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsZUFBZSxDQUFDLGVBQWUsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUM1RCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy95YW55dS9Eb3dubG9hZHMveXljMy1EZXNpZ24tU3lzdGVtL3NyYy9jb21wb25lbnRzL1NlbGVjdC50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIFNlbGVjdCDnu4Tku7bmtYvor5VcbiAqIEBkZXNjcmlwdGlvbiDmtYvor5UgU2VsZWN0IOe7hOS7tueahOWQhOmhueWKn+iDvVxuICogQG1vZHVsZSBfX3Rlc3RzX18vY29tcG9uZW50cy9TZWxlY3QudGVzdFxuICogQGF1dGhvciBZWUPCs1xuICogQHZlcnNpb24gMS4wLjBcbiAqIEBjcmVhdGVkIDIwMjYtMDItMThcbiAqL1xuXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyByZW5kZXIsIGZpcmVFdmVudCB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0IHsgc2NyZWVuIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9kb20nO1xuXG5pbXBvcnQgeyBTZWxlY3QgfSBmcm9tICcuL1NlbGVjdCc7XG5pbXBvcnQgeyBUaGVtZVByb3ZpZGVyIH0gZnJvbSAnLi4vdGhlbWUvVGhlbWVQcm92aWRlcic7XG5cbmRlc2NyaWJlKCdTZWxlY3Qg57uE5Lu2JywgKCkgPT4ge1xuICBjb25zdCByZW5kZXJXaXRoVGhlbWUgPSAoY29tcG9uZW50OiBSZWFjdC5SZWFjdEVsZW1lbnQpID0+IHtcbiAgICByZXR1cm4gcmVuZGVyKDxUaGVtZVByb3ZpZGVyPntjb21wb25lbnR9PC9UaGVtZVByb3ZpZGVyPik7XG4gIH07XG5cbiAgY29uc3QgbW9ja09wdGlvbnMgPSBbXG4gICAgeyB2YWx1ZTogJ29wdGlvbjEnLCBsYWJlbDogJ09wdGlvbiAxJyB9LFxuICAgIHsgdmFsdWU6ICdvcHRpb24yJywgbGFiZWw6ICdPcHRpb24gMicgfSxcbiAgICB7IHZhbHVlOiAnb3B0aW9uMycsIGxhYmVsOiAnT3B0aW9uIDMnIH0sXG4gIF07XG5cbiAgaXQoJ+W6lOivpeato+ehrua4suafk+m7mOiupCBTZWxlY3QnLCAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxTZWxlY3Qgb3B0aW9ucz17bW9ja09wdGlvbnN9IC8+KTtcblxuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdTZWxlY3QuLi4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeaYvuekuuiHquWumuS5iSBwbGFjZWhvbGRlcicsICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPFNlbGVjdCBvcHRpb25zPXttb2NrT3B0aW9uc30gcGxhY2Vob2xkZXI9XCJDaG9vc2UgYW4gb3B0aW9uXCIgLz4pO1xuXG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0Nob29zZSBhbiBvcHRpb24nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeWcqOeCueWHu+aXtuaJk+W8gOS4i+aLieiPnOWNlScsICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPFNlbGVjdCBvcHRpb25zPXttb2NrT3B0aW9uc30gLz4pO1xuXG4gICAgY29uc3QgdHJpZ2dlciA9IHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdC4uLicpO1xuICAgIGZpcmVFdmVudC5jbGljayh0cmlnZ2VyKTtcblxuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdPcHRpb24gMScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdPcHRpb24gMicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdPcHRpb24gMycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5Zyo6YCJ5oup6YCJ6aG55ZCO5YWz6Zet5LiL5ouJ6I+c5Y2VJywgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8U2VsZWN0IG9wdGlvbnM9e21vY2tPcHRpb25zfSAvPik7XG5cbiAgICBjb25zdCB0cmlnZ2VyID0gc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0Li4uJyk7XG4gICAgZmlyZUV2ZW50LmNsaWNrKHRyaWdnZXIpO1xuXG4gICAgY29uc3Qgb3B0aW9uMSA9IHNjcmVlbi5nZXRCeVRleHQoJ09wdGlvbiAxJyk7XG4gICAgZmlyZUV2ZW50LmNsaWNrKG9wdGlvbjEpO1xuXG4gICAgZXhwZWN0KHRyaWdnZXIudGV4dENvbnRlbnQpLnRvQmUoJ09wdGlvbiAxJyk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XosIPnlKggb25DaGFuZ2Ug5Zue6LCDJywgKCkgPT4ge1xuICAgIGNvbnN0IGhhbmRsZUNoYW5nZSA9IGplc3QuZm4oKTtcbiAgICByZW5kZXJXaXRoVGhlbWUoPFNlbGVjdCBvcHRpb25zPXttb2NrT3B0aW9uc30gb25DaGFuZ2U9e2hhbmRsZUNoYW5nZX0gLz4pO1xuXG4gICAgY29uc3QgdHJpZ2dlciA9IHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdC4uLicpO1xuICAgIGZpcmVFdmVudC5jbGljayh0cmlnZ2VyKTtcblxuICAgIGNvbnN0IG9wdGlvbjEgPSBzY3JlZW4uZ2V0QnlUZXh0KCdPcHRpb24gMScpO1xuICAgIGZpcmVFdmVudC5jbGljayhvcHRpb24xKTtcblxuICAgIGV4cGVjdChoYW5kbGVDaGFuZ2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdvcHRpb24xJyk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XlnKjnpoHnlKjnirbmgIHkuIvkuI3lk43lupTngrnlh7snLCAoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlQ2hhbmdlID0gamVzdC5mbigpO1xuICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSByZW5kZXJXaXRoVGhlbWUoXG4gICAgICA8U2VsZWN0IG9wdGlvbnM9e21vY2tPcHRpb25zfSBkaXNhYmxlZCBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfSAvPlxuICAgICk7XG5cbiAgICBjb25zdCB0cmlnZ2VyID0gc2NyZWVuLmdldEJ5Um9sZSgnY29tYm9ib3gnKTtcbiAgICBmaXJlRXZlbnQuY2xpY2sodHJpZ2dlcik7XG5cbiAgICBjb25zdCBkcm9wZG93biA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cImxpc3Rib3hcIl0nKTtcbiAgICBleHBlY3QoZHJvcGRvd24pLnRvSGF2ZVN0eWxlKHsgZGlzcGxheTogJ25vbmUnIH0pO1xuICAgIGV4cGVjdChoYW5kbGVDaGFuZ2UpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XmlK/mjIHlj5fmjqfmqKHlvI8nLCAoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlQ2hhbmdlID0gamVzdC5mbigpO1xuICAgIHJlbmRlcldpdGhUaGVtZSg8U2VsZWN0IG9wdGlvbnM9e21vY2tPcHRpb25zfSB2YWx1ZT1cIm9wdGlvbjFcIiBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfSAvPik7XG5cbiAgICBjb25zdCB0cmlnZ2VyID0gc2NyZWVuLmdldEJ5Um9sZSgnY29tYm9ib3gnKTtcbiAgICBleHBlY3QodHJpZ2dlci50ZXh0Q29udGVudCkudG9Db250YWluKCdPcHRpb24gMScpO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5Zyo5Y+X5o6n5qih5byP5LiL5q2j56Gu5pu05paw5YC8JywgKCkgPT4ge1xuICAgIGNvbnN0IGhhbmRsZUNoYW5nZSA9IGplc3QuZm4oKTtcbiAgICByZW5kZXJXaXRoVGhlbWUoPFNlbGVjdCBvcHRpb25zPXttb2NrT3B0aW9uc30gdmFsdWU9XCJvcHRpb24xXCIgb25DaGFuZ2U9e2hhbmRsZUNoYW5nZX0gLz4pO1xuXG4gICAgY29uc3QgdHJpZ2dlciA9IHNjcmVlbi5nZXRCeVJvbGUoJ2NvbWJvYm94Jyk7XG4gICAgZXhwZWN0KHRyaWdnZXIudGV4dENvbnRlbnQpLnRvQ29udGFpbignT3B0aW9uIDEnKTtcbiAgfSk7XG5cbiAgaXQoJ+W6lOivpeWcqOeCueWHu+WklumDqOaXtuWFs+mXreS4i+aLieiPnOWNlScsICgpID0+IHtcbiAgICBjb25zdCB7IGNvbnRhaW5lciB9ID0gcmVuZGVyV2l0aFRoZW1lKFxuICAgICAgPGRpdj5cbiAgICAgICAgPFNlbGVjdCBvcHRpb25zPXttb2NrT3B0aW9uc30gLz5cbiAgICAgICAgPGRpdiBkYXRhLXRlc3RpZD1cIm91dHNpZGVcIj5PdXRzaWRlPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuXG4gICAgY29uc3QgdHJpZ2dlciA9IHNjcmVlbi5nZXRCeVJvbGUoJ2NvbWJvYm94Jyk7XG4gICAgZmlyZUV2ZW50LmNsaWNrKHRyaWdnZXIpO1xuXG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ09wdGlvbiAxJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG5cbiAgICBjb25zdCBvdXRzaWRlID0gc2NyZWVuLmdldEJ5VGVzdElkKCdvdXRzaWRlJyk7XG4gICAgZmlyZUV2ZW50Lm1vdXNlRG93bihvdXRzaWRlKTtcblxuICAgIGNvbnN0IGRyb3Bkb3duID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwibGlzdGJveFwiXScpO1xuICAgIGV4cGVjdChkcm9wZG93bikudG9IYXZlU3R5bGUoeyBkaXNwbGF5OiAnbm9uZScgfSk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XlupTnlKjoh6rlrprkuYkgY2xhc3NOYW1lJywgKCkgPT4ge1xuICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSByZW5kZXJXaXRoVGhlbWUoXG4gICAgICA8U2VsZWN0IG9wdGlvbnM9e21vY2tPcHRpb25zfSBjbGFzc05hbWU9XCJjdXN0b20tY2xhc3NcIiAvPlxuICAgICk7XG5cbiAgICBjb25zdCBzZWxlY3QgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmN1c3RvbS1jbGFzcycpO1xuICAgIGV4cGVjdChzZWxlY3QpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XlnKjmgqzlgZzpgInpobnml7bmlLnlj5jmoLflvI8nLCAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxTZWxlY3Qgb3B0aW9ucz17bW9ja09wdGlvbnN9IC8+KTtcblxuICAgIGNvbnN0IHRyaWdnZXIgPSBzY3JlZW4uZ2V0QnlSb2xlKCdjb21ib2JveCcpO1xuICAgIGZpcmVFdmVudC5jbGljayh0cmlnZ2VyKTtcblxuICAgIGNvbnN0IG9wdGlvbnMgPSBzY3JlZW4uZ2V0QWxsQnlSb2xlKCdvcHRpb24nKTtcbiAgICBjb25zdCBvcHRpb24xID0gb3B0aW9ucy5maW5kKChvcHQpID0+IG9wdC50ZXh0Q29udGVudCA9PT0gJ09wdGlvbiAxJyk7XG4gICAgaWYgKG9wdGlvbjEpIHtcbiAgICAgIGZpcmVFdmVudC5tb3VzZUVudGVyKG9wdGlvbjEpO1xuICAgIH1cblxuICAgIGV4cGVjdChvcHRpb24xKS50b0hhdmVTdHlsZSh7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2IoMjI0LCAxMDYsIDExMiknLFxuICAgICAgY29sb3I6ICdyZ2IoMjQwLCAyNDAsIDI0MCknLFxuICAgIH0pO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5Zyo56a75byA6YCJ6aG55pe25oGi5aSN5qC35byPJywgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8U2VsZWN0IG9wdGlvbnM9e21vY2tPcHRpb25zfSAvPik7XG5cbiAgICBjb25zdCB0cmlnZ2VyID0gc2NyZWVuLmdldEJ5Um9sZSgnY29tYm9ib3gnKTtcbiAgICBmaXJlRXZlbnQuY2xpY2sodHJpZ2dlcik7XG5cbiAgICBjb25zdCBvcHRpb25zID0gc2NyZWVuLmdldEFsbEJ5Um9sZSgnb3B0aW9uJyk7XG4gICAgY29uc3Qgb3B0aW9uMSA9IG9wdGlvbnMuZmluZCgob3B0KSA9PiBvcHQudGV4dENvbnRlbnQgPT09ICdPcHRpb24gMScpO1xuICAgIGlmIChvcHRpb24xKSB7XG4gICAgICBmaXJlRXZlbnQubW91c2VFbnRlcihvcHRpb24xKTtcbiAgICB9XG4gICAgZXhwZWN0KG9wdGlvbjEpLnRvSGF2ZVN0eWxlKHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYigyMjQsIDEwNiwgMTEyKScsXG4gICAgICBjb2xvcjogJ3JnYigyNDAsIDI0MCwgMjQwKScsXG4gICAgfSk7XG5cbiAgICBpZiAob3B0aW9uMSkge1xuICAgICAgZmlyZUV2ZW50Lm1vdXNlTGVhdmUob3B0aW9uMSk7XG4gICAgfVxuICAgIGV4cGVjdChvcHRpb24xKS50b0hhdmVTdHlsZSh7XG4gICAgICBjb2xvcjogJ3JnYigyNDAsIDI0MCwgMjQwKScsXG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XmraPnoa7mmL7npLrnrq3lpLTlm77moIcnLCAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxTZWxlY3Qgb3B0aW9ucz17bW9ja09wdGlvbnN9IC8+KTtcblxuICAgIGNvbnN0IHRyaWdnZXIgPSBzY3JlZW4uZ2V0QnlSb2xlKCdjb21ib2JveCcpO1xuICAgIGV4cGVjdCh0cmlnZ2VyLnRleHRDb250ZW50KS50b0NvbnRhaW4oJ+KWvCcpO1xuXG4gICAgZmlyZUV2ZW50LmNsaWNrKHRyaWdnZXIpO1xuICAgIGV4cGVjdCh0cmlnZ2VyLnRleHRDb250ZW50KS50b0NvbnRhaW4oJ+KWsicpO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5Zyo6Z2e5Y+X5o6n5qih5byP5LiL57u05oqk5YaF6YOo54q25oCBJywgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8U2VsZWN0IG9wdGlvbnM9e21vY2tPcHRpb25zfSAvPik7XG5cbiAgICBjb25zdCB0cmlnZ2VyID0gc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0Li4uJyk7XG4gICAgZmlyZUV2ZW50LmNsaWNrKHRyaWdnZXIpO1xuXG4gICAgY29uc3Qgb3B0aW9uMSA9IHNjcmVlbi5nZXRCeVRleHQoJ09wdGlvbiAxJyk7XG4gICAgZmlyZUV2ZW50LmNsaWNrKG9wdGlvbjEpO1xuXG4gICAgZXhwZWN0KHRyaWdnZXIudGV4dENvbnRlbnQpLnRvQmUoJ09wdGlvbiAxJyk7XG5cbiAgICBmaXJlRXZlbnQuY2xpY2sodHJpZ2dlcik7XG4gICAgY29uc3Qgb3B0aW9uMiA9IHNjcmVlbi5nZXRCeVRleHQoJ09wdGlvbiAyJyk7XG4gICAgZmlyZUV2ZW50LmNsaWNrKG9wdGlvbjIpO1xuXG4gICAgZXhwZWN0KHRyaWdnZXIudGV4dENvbnRlbnQpLnRvQmUoJ09wdGlvbiAyJyk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XmraPnoa7orr7nva4gYXJpYSDlsZ7mgKcnLCAoKSA9PiB7XG4gICAgcmVuZGVyV2l0aFRoZW1lKDxTZWxlY3Qgb3B0aW9ucz17bW9ja09wdGlvbnN9IC8+KTtcblxuICAgIGNvbnN0IHRyaWdnZXIgPSBzY3JlZW4uZ2V0QnlSb2xlKCdjb21ib2JveCcpO1xuICAgIGV4cGVjdCh0cmlnZ2VyKS50b0hhdmVBdHRyaWJ1dGUoJ3JvbGUnLCAnY29tYm9ib3gnKTtcbiAgICBleHBlY3QodHJpZ2dlcikudG9IYXZlQXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG4gICAgZXhwZWN0KHRyaWdnZXIpLnRvSGF2ZUF0dHJpYnV0ZSgnYXJpYS1oYXNwb3B1cCcsICdsaXN0Ym94Jyk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XlnKjmiZPlvIDml7bmm7TmlrAgYXJpYS1leHBhbmRlZCcsICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPFNlbGVjdCBvcHRpb25zPXttb2NrT3B0aW9uc30gLz4pO1xuXG4gICAgY29uc3QgdHJpZ2dlciA9IHNjcmVlbi5nZXRCeVJvbGUoJ2NvbWJvYm94Jyk7XG4gICAgZXhwZWN0KHRyaWdnZXIpLnRvSGF2ZUF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuXG4gICAgZmlyZUV2ZW50LmNsaWNrKHRyaWdnZXIpO1xuICAgIGV4cGVjdCh0cmlnZ2VyKS50b0hhdmVBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5Zyo56aB55So5pe26K6+572u5q2j56Gu55qEIHRhYkluZGV4JywgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8U2VsZWN0IG9wdGlvbnM9e21vY2tPcHRpb25zfSBkaXNhYmxlZCAvPik7XG5cbiAgICBjb25zdCB0cmlnZ2VyID0gc2NyZWVuLmdldEJ5Um9sZSgnY29tYm9ib3gnKTtcbiAgICBleHBlY3QodHJpZ2dlcikudG9IYXZlQXR0cmlidXRlKCd0YWJJbmRleCcsICctMScpO1xuICB9KTtcblxuICBpdCgn5bqU6K+l5Zyo5pyq56aB55So5pe26K6+572u5q2j56Gu55qEIHRhYkluZGV4JywgKCkgPT4ge1xuICAgIHJlbmRlcldpdGhUaGVtZSg8U2VsZWN0IG9wdGlvbnM9e21vY2tPcHRpb25zfSAvPik7XG5cbiAgICBjb25zdCB0cmlnZ2VyID0gc2NyZWVuLmdldEJ5Um9sZSgnY29tYm9ib3gnKTtcbiAgICBleHBlY3QodHJpZ2dlcikudG9IYXZlQXR0cmlidXRlKCd0YWJJbmRleCcsICcwJyk7XG4gIH0pO1xuXG4gIGl0KCflupTor6XkuLrpgInpobnorr7nva7mraPnoa7nmoQgYXJpYS1zZWxlY3RlZCcsICgpID0+IHtcbiAgICByZW5kZXJXaXRoVGhlbWUoPFNlbGVjdCBvcHRpb25zPXttb2NrT3B0aW9uc30gdmFsdWU9XCJvcHRpb24xXCIgLz4pO1xuXG4gICAgY29uc3QgdHJpZ2dlciA9IHNjcmVlbi5nZXRCeVJvbGUoJ2NvbWJvYm94Jyk7XG4gICAgZmlyZUV2ZW50LmNsaWNrKHRyaWdnZXIpO1xuXG4gICAgY29uc3Qgb3B0aW9ucyA9IHNjcmVlbi5nZXRBbGxCeVJvbGUoJ29wdGlvbicpO1xuICAgIGNvbnN0IG9wdGlvbjEgPSBvcHRpb25zLmZpbmQoKG9wdCkgPT4gb3B0LnRleHRDb250ZW50ID09PSAnT3B0aW9uIDEnKTtcbiAgICBjb25zdCBvcHRpb24yID0gb3B0aW9ucy5maW5kKChvcHQpID0+IG9wdC50ZXh0Q29udGVudCA9PT0gJ09wdGlvbiAyJyk7XG5cbiAgICBleHBlY3Qob3B0aW9uMSkudG9IYXZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTtcbiAgICBleHBlY3Qob3B0aW9uMikudG9IYXZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ2ZhbHNlJyk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=