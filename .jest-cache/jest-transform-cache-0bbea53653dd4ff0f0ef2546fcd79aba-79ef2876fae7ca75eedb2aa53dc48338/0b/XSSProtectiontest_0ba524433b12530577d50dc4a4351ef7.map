{"file":"/Users/yanyu/Downloads/yyc3-Design-System/src/security/XSSProtection.test.tsx","mappings":"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","names":[],"sources":["/Users/yanyu/Downloads/yyc3-Design-System/src/security/XSSProtection.test.tsx"],"sourcesContent":["/**\n * @file XSS 防护模块测试\n * @description 测试 XSSProtection 组件的各项功能\n * @module __tests__/security/XSSProtection.test\n * @author YYC³\n * @version 1.0.0\n * @created 2026-02-21\n */\n\nimport * as React from 'react';\nimport { render, fireEvent, waitFor } from '@testing-library/react';\nimport { screen } from '@testing-library/dom';\n\nimport '@testing-library/jest-dom';\nimport {\n  XSSProvider,\n  useXSS,\n  SafeHTML,\n  SafeInput,\n  createSafeURL,\n  validateURL,\n  sanitizeURL,\n  escapeHTML,\n  unescapeHTML,\n  sanitizeAttributeValue,\n  createStrictConfig,\n  createModerateConfig,\n  createPermissiveConfig,\n  withXSSProtection,\n} from './XSSProtection';\n\nconst TestComponent = () => {\n  const { sanitize, isSafe } = useXSS();\n  const [sanitized, setSanitized] = React.useState('');\n  const [safe, setSafe] = React.useState(false);\n\n  const handleSanitize = async () => {\n    const result = await sanitize('<script>alert(\"xss\")</script><p>safe</p>');\n    setSanitized(result);\n  };\n\n  const handleCheckSafe = async () => {\n    const result = await isSafe('<p>safe</p>');\n    setSafe(result);\n  };\n\n  return (\n    <div>\n      <button onClick={handleSanitize}>Sanitize</button>\n      <button onClick={handleCheckSafe}>Check Safe</button>\n      <div data-testid=\"sanitized\">{sanitized}</div>\n      <div data-testid=\"safe\">{safe ? 'true' : 'false'}</div>\n    </div>\n  );\n};\n\ndescribe('XSSProtection', () => {\n  describe('XSSProvider', () => {\n    it('应该提供 XSS 上下文', () => {\n      render(\n        <XSSProvider>\n          <TestComponent />\n        </XSSProvider>\n      );\n      expect(screen.getByText('Sanitize')).toBeInTheDocument();\n      expect(screen.getByText('Check Safe')).toBeInTheDocument();\n    });\n\n    it('应该支持自定义配置', () => {\n      const customConfig = {\n        allowedTags: ['p', 'span'],\n        allowedAttributes: { p: ['class'] },\n      };\n      render(\n        <XSSProvider config={customConfig}>\n          <TestComponent />\n        </XSSProvider>\n      );\n      expect(screen.getByText('Sanitize')).toBeInTheDocument();\n    });\n  });\n\n  describe('useXSS', () => {\n    it('应该抛出错误当在 XSSProvider 外使用', () => {\n      const consoleError = jest.spyOn(console, 'error').mockImplementation();\n      expect(() => {\n        const TestComponentOutside = () => {\n          useXSS();\n          return <div>Test</div>;\n        };\n        render(<TestComponentOutside />);\n      }).toThrow('useXSS must be used within an XSSProvider');\n      consoleError.mockRestore();\n    });\n  });\n\n  describe('SafeHTML', () => {\n    it('应该安全渲染 HTML', async () => {\n      render(\n        <XSSProvider>\n          <SafeHTML html=\"<p>safe content</p>\" />\n        </XSSProvider>\n      );\n      await waitFor(() => {\n        expect(screen.getByText('safe content')).toBeInTheDocument();\n      });\n    });\n\n    it('应该移除危险脚本', async () => {\n      render(\n        <XSSProvider>\n          <SafeHTML html=\"<script>alert('xss')</script><p>safe</p>\" />\n        </XSSProvider>\n      );\n      await waitFor(() => {\n        expect(screen.getByText('safe')).toBeInTheDocument();\n        expect(document.querySelector('script')).not.toBeInTheDocument();\n      });\n    });\n\n    it('应该支持自定义类名', async () => {\n      const { container } = render(\n        <XSSProvider>\n          <SafeHTML html=\"<p>test</p>\" className=\"custom-class\" />\n        </XSSProvider>\n      );\n      await waitFor(() => {\n        expect(container.querySelector('.custom-class')).toBeInTheDocument();\n      });\n    });\n\n    it('应该支持自定义标签', async () => {\n      render(\n        <XSSProvider>\n          <SafeHTML html=\"<p>test</p>\" as=\"span\" />\n        </XSSProvider>\n      );\n      await waitFor(() => {\n        const element = document.querySelector('span');\n        expect(element).toBeInTheDocument();\n      });\n    });\n\n    it('应该支持自定义配置', async () => {\n      render(\n        <XSSProvider>\n          <SafeHTML html=\"<p>test</p>\" config={{ allowedTags: ['p'] }} />\n        </XSSProvider>\n      );\n      await waitFor(() => {\n        expect(screen.getByText('test')).toBeInTheDocument();\n      });\n    });\n  });\n\n  describe('SafeInput', () => {\n    it('应该渲染输入框', () => {\n      render(\n        <XSSProvider>\n          <SafeInput value=\"test\" onChange={jest.fn()} />\n        </XSSProvider>\n      );\n      const input = screen.getByRole('textbox');\n      expect(input).toBeInTheDocument();\n      expect(input).toHaveValue('test');\n    });\n\n    it('应该支持 onChange 回调', async () => {\n      const handleChange = jest.fn();\n      render(\n        <XSSProvider>\n          <SafeInput value=\"\" onChange={handleChange} />\n        </XSSProvider>\n      );\n      const input = screen.getByRole('textbox');\n      input.click();\n      await waitFor(() => {\n        (input as HTMLInputElement).value = 'new value';\n        input.dispatchEvent(new Event('input', { bubbles: true }));\n      });\n    });\n\n    it('应该支持 maxLength', () => {\n      render(\n        <XSSProvider>\n          <SafeInput value=\"test\" onChange={jest.fn()} maxLength={10} />\n        </XSSProvider>\n      );\n      const input = screen.getByRole('textbox');\n      expect(input).toHaveAttribute('maxLength', '10');\n    });\n\n    it('应该支持 allowedPattern', () => {\n      const pattern = /^[a-z]+$/;\n      render(\n        <XSSProvider>\n          <SafeInput value=\"test\" onChange={jest.fn()} allowedPattern={pattern} />\n        </XSSProvider>\n      );\n      expect(screen.getByRole('textbox')).toBeInTheDocument();\n    });\n  });\n\n  describe('createSafeURL', () => {\n    it('应该返回安全的 URL', () => {\n      expect(createSafeURL('https://example.com')).toBe('https://example.com');\n      expect(createSafeURL('http://example.com')).toBe('http://example.com');\n    });\n\n    it('应该拒绝不安全的协议', () => {\n      expect(createSafeURL('javascript:alert(1)')).toBeNull();\n      expect(createSafeURL('data:text/html,<script>alert(1)</script>')).toBeNull();\n    });\n\n    it('应该支持自定义允许的协议', () => {\n      expect(createSafeURL('mailto:test@example.com', ['mailto'])).toBe('mailto:test@example.com');\n      expect(createSafeURL('tel:+1234567890', ['tel'])).toBe('tel:+1234567890');\n    });\n\n    it('应该处理无效 URL', () => {\n      expect(createSafeURL('not a url')).toBeNull();\n      expect(createSafeURL('')).toBeNull();\n    });\n  });\n\n  describe('validateURL', () => {\n    it('应该验证有效的 URL', () => {\n      expect(validateURL('https://example.com')).toBe(true);\n      expect(validateURL('http://example.com')).toBe(true);\n      expect(validateURL('https://example.com/path?query=value')).toBe(true);\n    });\n\n    it('应该拒绝无效的 URL', () => {\n      expect(validateURL('not a url')).toBe(false);\n      expect(validateURL('')).toBe(false);\n      expect(validateURL('javascript:alert(1)')).toBe(true);\n    });\n  });\n\n  describe('sanitizeURL', () => {\n    it('应该返回安全的 URL', () => {\n      expect(sanitizeURL('https://example.com')).toBe('https://example.com');\n    });\n\n    it('应该返回 about:blank 对于不安全的 URL', () => {\n      expect(sanitizeURL('javascript:alert(1)')).toBe('about:blank');\n      expect(sanitizeURL('data:text/html,<script>alert(1)</script>')).toBe('about:blank');\n    });\n  });\n\n  describe('escapeHTML', () => {\n    it('应该转义 HTML 特殊字符', () => {\n      expect(escapeHTML('<div>test</div>')).toBe('&lt;div&gt;test&lt;/div&gt;');\n      expect(escapeHTML('&')).toBe('&amp;');\n      expect(escapeHTML('\"')).toBe('\"');\n      expect(escapeHTML(\"'\")).toBe(\"'\");\n    });\n\n    it('应该处理空字符串', () => {\n      expect(escapeHTML('')).toBe('');\n    });\n\n    it('应该处理普通文本', () => {\n      expect(escapeHTML('plain text')).toBe('plain text');\n    });\n  });\n\n  describe('unescapeHTML', () => {\n    it('应该反转义 HTML 特殊字符', () => {\n      expect(unescapeHTML('&lt;div&gt;test&lt;/div&gt;')).toBe('<div>test</div>');\n      expect(unescapeHTML('&amp;')).toBe('&');\n      expect(unescapeHTML('&quot;')).toBe('\"');\n      expect(unescapeHTML('&#39;')).toBe(\"'\");\n    });\n\n    it('应该处理空字符串', () => {\n      expect(unescapeHTML('')).toBe('');\n    });\n\n    it('应该处理普通文本', () => {\n      expect(unescapeHTML('plain text')).toBe('plain text');\n    });\n  });\n\n  describe('sanitizeAttributeValue', () => {\n    it('应该移除危险的 JavaScript 协议', () => {\n      expect(sanitizeAttributeValue('href', 'javascript:alert(1)')).toBe('');\n      expect(sanitizeAttributeValue('src', 'javascript:void(0)')).toBe('');\n    });\n\n    it('应该移除危险的 data 协议', () => {\n      expect(sanitizeAttributeValue('src', 'data:text/html,<script>alert(1)</script>')).toBe('');\n    });\n\n    it('应该移除 vbscript 协议', () => {\n      expect(sanitizeAttributeValue('href', 'vbscript:msgbox(1)')).toBe('');\n    });\n\n    it('应该移除事件处理器', () => {\n      expect(sanitizeAttributeValue('onclick', 'onclick=alert(1)')).toBe('');\n      expect(sanitizeAttributeValue('onload', 'onload=alert(1)')).toBe('');\n      expect(sanitizeAttributeValue('onerror', 'onerror=alert(1)')).toBe('');\n    });\n\n    it('应该保留安全的属性值', () => {\n      expect(sanitizeAttributeValue('href', 'https://example.com')).toBe('https://example.com');\n      expect(sanitizeAttributeValue('class', 'test-class')).toBe('test-class');\n      expect(sanitizeAttributeValue('id', 'test-id')).toBe('test-id');\n    });\n  });\n\n  describe('createStrictConfig', () => {\n    it('应该创建严格的配置', () => {\n      const config = createStrictConfig();\n      expect(config.allowedTags).toContain('p');\n      expect(config.allowedTags).toContain('br');\n      expect(config.allowedTags).not.toContain('script');\n      expect(config.allowedTags).not.toContain('iframe');\n    });\n\n    it('应该限制允许的协议', () => {\n      const config = createStrictConfig();\n      expect(config.allowedSchemes).toContain('https');\n      expect(config.allowedSchemes).toContain('mailto');\n      expect(config.allowedSchemes).not.toContain('javascript');\n    });\n  });\n\n  describe('createModerateConfig', () => {\n    it('应该创建中等配置', () => {\n      const config = createModerateConfig();\n      expect(config.allowedTags).toContain('p');\n      expect(config.allowedTags).toContain('div');\n      expect(config.allowedTags).toContain('a');\n    });\n  });\n\n  describe('createPermissiveConfig', () => {\n    it('应该创建宽松配置', () => {\n      const config = createPermissiveConfig();\n      expect(config.allowCustomElements).toBe(true);\n      expect(config.allowComments).toBe(true);\n      expect(config.allowUnknownMarkup).toBe(true);\n    });\n  });\n\n  describe('withXSSProtection', () => {\n    it('应该包装组件并添加 XSS 保护', () => {\n      const TestComponent = () => <div>Test</div>;\n      const ProtectedComponent = withXSSProtection(TestComponent);\n      render(<ProtectedComponent />);\n      expect(screen.getByText('Test')).toBeInTheDocument();\n    });\n\n    it('应该支持自定义配置', () => {\n      const TestComponent = () => <div>Test</div>;\n      const customConfig = { allowedTags: ['p'] };\n      const ProtectedComponent = withXSSProtection(TestComponent, customConfig);\n      render(<ProtectedComponent />);\n      expect(screen.getByText('Test')).toBeInTheDocument();\n    });\n\n    it('应该设置正确的显示名称', () => {\n      const TestComponent = () => <div>Test</div>;\n      TestComponent.displayName = 'TestComponent';\n      const ProtectedComponent = withXSSProtection(TestComponent);\n      expect(ProtectedComponent.displayName).toBe('withXSSProtection(TestComponent)');\n    });\n  });\n\n  describe('XSS 攻击防护', () => {\n    it('应该阻止脚本注入', async () => {\n      render(\n        <XSSProvider>\n          <SafeHTML html=\"<script>alert('xss')</script><p>safe</p>\" />\n        </XSSProvider>\n      );\n      await waitFor(() => {\n        expect(document.querySelector('script')).not.toBeInTheDocument();\n      });\n    });\n\n    it('应该阻止事件处理器', async () => {\n      const xssHtml = `<div onclick=\"alert('xss')\">click me</div>`;\n      render(\n        <XSSProvider>\n          <SafeHTML html={xssHtml} />\n        </XSSProvider>\n      );\n      await waitFor(() => {\n        const div = document.querySelector('div');\n        expect(div).not.toHaveAttribute('onclick');\n      });\n    });\n\n    it('应该阻止 javascript: 协议', async () => {\n      const xssHtml = `<a href=\"javascript:alert('xss')\">link</a>`;\n      render(\n        <XSSProvider>\n          <SafeHTML html={xssHtml} />\n        </XSSProvider>\n      );\n      await waitFor(() => {\n        const link = document.querySelector('a');\n        expect(link).not.toHaveAttribute('href', expect.stringContaining('javascript:'));\n      });\n    });\n\n    it('应该阻止 data: 协议的 HTML', async () => {\n      const xssHtml = `<iframe src=\"data:text/html,&lt;script&gt;alert('xss')&lt;/script&gt;\"></iframe>`;\n      render(\n        <XSSProvider>\n          <SafeHTML html={xssHtml} />\n        </XSSProvider>\n      );\n      await waitFor(() => {\n        const iframe = document.querySelector('iframe');\n        expect(iframe).toBeNull();\n      });\n    });\n  });\n});\n"],"version":3}