{"file":"/Users/yanyu/Downloads/yyc3-Design-System/src/performance/monitor.ts","mappings":"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","names":[],"sources":["/Users/yanyu/Downloads/yyc3-Design-System/src/performance/monitor.ts"],"sourcesContent":["import { PerformanceMetrics, PerformanceReport } from './types';\n\ninterface PerformanceEntry {\n  startTime: number;\n  processingStart?: number;\n  value?: number;\n  hadRecentInput?: boolean;\n  responseStart?: number;\n  requestStart?: number;\n}\n\nclass PerformanceMonitor {\n  private metrics: PerformanceMetrics = {};\n  private observers: PerformanceObserver[] = [];\n  private reportUrl?: string;\n\n  constructor(reportUrl?: string) {\n    this.reportUrl = reportUrl;\n  }\n\n  init() {\n    if (typeof window === 'undefined') return;\n\n    this.measureFCP();\n    this.measureLCP();\n    this.measureFID();\n    this.measureCLS();\n    this.measureTTFB();\n  }\n\n  private measureFCP() {\n    const observer = new PerformanceObserver((list) => {\n      const entries = list.getEntries();\n      const fcpEntry = entries.find((entry) => entry.name === 'first-contentful-paint');\n      if (fcpEntry) {\n        this.metrics.FCP = fcpEntry.startTime;\n        this.report();\n      }\n    });\n    observer.observe({ type: 'paint', buffered: true });\n    this.observers.push(observer);\n  }\n\n  private measureLCP() {\n    if (!('PerformanceObserver' in window)) return;\n\n    const observer = new PerformanceObserver((list) => {\n      const entries = list.getEntries();\n      const lastEntry = entries[entries.length - 1] as PerformanceEntry;\n      if (lastEntry) {\n        this.metrics.LCP = lastEntry.startTime;\n        this.report();\n      }\n    });\n    observer.observe({ type: 'largest-contentful-paint', buffered: true });\n    this.observers.push(observer);\n  }\n\n  private measureFID() {\n    if (!('PerformanceObserver' in window)) return;\n\n    const observer = new PerformanceObserver((list) => {\n      const entries = list.getEntries();\n      const fidEntry = entries[0] as PerformanceEntry;\n      if (fidEntry && fidEntry.processingStart) {\n        this.metrics.FID = fidEntry.processingStart - fidEntry.startTime;\n        this.report();\n      }\n    });\n    observer.observe({ type: 'first-input', buffered: true });\n    this.observers.push(observer);\n  }\n\n  private measureCLS() {\n    if (!('PerformanceObserver' in window)) return;\n\n    let clsValue = 0;\n    const observer = new PerformanceObserver((list) => {\n      const entries = list.getEntries();\n      for (const entry of entries as PerformanceEntry[]) {\n        if (entry.hadRecentInput === false) {\n          clsValue += entry.value || 0;\n        }\n      }\n      if (clsValue > 0) {\n        this.metrics.CLS = clsValue;\n        this.report();\n      }\n    });\n    observer.observe({ type: 'layout-shift', buffered: true });\n    this.observers.push(observer);\n  }\n\n  private measureTTFB() {\n    if (typeof window === 'undefined' || !window.performance) return;\n\n    const navigation = performance.getEntriesByType('navigation')[0] as PerformanceEntry;\n    if (navigation && navigation.responseStart && navigation.requestStart) {\n      this.metrics.TTFB = navigation.responseStart - navigation.requestStart;\n      this.report();\n    }\n  }\n\n  private report() {\n    const report: PerformanceReport = {\n      metrics: { ...this.metrics },\n      timestamp: Date.now(),\n      url: window.location.href,\n    };\n\n    console.warn('Performance Metrics:', report);\n\n    if (this.reportUrl) {\n      this.sendReport(report);\n    }\n  }\n\n  private async sendReport(report: PerformanceReport) {\n    if (!this.reportUrl) return;\n\n    try {\n      await fetch(this.reportUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(report),\n      } as RequestInit);\n    } catch (error) {\n      console.error('Failed to send performance report:', error);\n    }\n  }\n\n  getMetrics(): PerformanceMetrics {\n    return { ...this.metrics };\n  }\n\n  destroy() {\n    this.observers.forEach((observer) => observer.disconnect());\n    this.observers = [];\n  }\n}\n\nexport default PerformanceMonitor;\n"],"version":3}