{"file":"/Users/yanyu/Downloads/yyc3-Design-System/src/components/Polymorphic.tsx","mappings":"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","names":[],"sources":["/Users/yanyu/Downloads/yyc3-Design-System/src/components/Polymorphic.tsx"],"sourcesContent":["/**\n * @file 多态组件基础设施\n * @description 提供多态组件支持，允许组件使用 asChild 模式和动态元素类型\n * @module components/Polymorphic\n * @author YYC³\n * @version 1.0.0\n * @created 2026-02-19\n */\n\nimport React, { ElementType, forwardRef } from 'react';\nimport type { ComponentWithRef, MergeProps, OverrideProps } from '../types/advanced-types';\n\nexport type AsChildProps<T extends ElementType> = {\n  asChild?: boolean;\n  as?: T;\n};\n\nexport type SlotProps<T extends ElementType = 'div'> = {\n  children?: React.ReactNode;\n} & AsChildProps<T>;\n\nexport type PolymorphicComponent<\n  T extends ElementType = 'div',\n  P extends object = object,\n> = ComponentWithRef<T, P>;\n\nexport const createPolymorphicComponent = (displayName: string) => {\n  const Component = forwardRef<ElementType, SlotProps<ElementType> & Record<string, unknown>>(\n    (props, ref) => {\n      const { as, children, ...rest } = props;\n      const ElementType = (as || 'div') as ElementType;\n\n      return React.createElement(ElementType, { ...rest, ref }, children as React.ReactNode);\n    }\n  );\n\n  Component.displayName = displayName;\n\n  return Component as PolymorphicComponent<\n    ElementType,\n    SlotProps<ElementType> & Record<string, unknown>\n  >;\n};\n\nexport const Slot = <T extends ElementType = 'div'>({\n  asChild = false,\n  as,\n  children,\n  ...rest\n}: SlotProps<T> & Record<string, unknown>) => {\n  const ElementType = asChild ? (children as React.ReactElement)?.type : as || 'div';\n  const Child = asChild\n    ? children\n    : React.createElement(ElementType, rest, children as React.ReactNode);\n\n  if (!React.isValidElement(Child)) {\n    return Child as React.ReactElement;\n  }\n\n  const childRef = (Child as React.ReactElement & { ref?: React.Ref<unknown> }).ref;\n\n  return React.cloneElement(Child as React.ReactElement<Record<string, unknown>>, {\n    ...rest,\n    ref: (refValue: React.Ref<unknown>) => {\n      if (childRef) {\n        if (typeof childRef === 'function') {\n          childRef(refValue);\n        } else {\n          (childRef as React.MutableRefObject<unknown>).current = refValue;\n        }\n      }\n    },\n  });\n};\n\nSlot.displayName = 'Slot';\n\nexport const createSlot = <T extends ElementType = 'div'>(displayName: string) => {\n  const SlotComponent = Slot as React.ComponentType<SlotProps<T> & Record<string, unknown>>;\n  (SlotComponent as React.ComponentType<SlotProps<T> & Record<string, unknown>>).displayName =\n    displayName;\n  return SlotComponent;\n};\n\nexport const mergeProps = <T, U>(source: T, target: U): MergeProps<T, U> => {\n  return { ...source, ...target } as MergeProps<T, U>;\n};\n\nexport const overrideProps = <T, O>(base: T, overrides: Partial<O>): OverrideProps<T, O> => {\n  return { ...base, ...overrides } as OverrideProps<T, O>;\n};\n\nexport const createAsChildComponent = <P extends object = object>(\n  displayName: string,\n  render: (props: P) => React.ReactElement\n) => {\n  const Component = forwardRef<ElementType, P>((props, ref) => {\n    return render({ ...props, ref } as P);\n  });\n\n  Component.displayName = displayName;\n\n  return Component as PolymorphicComponent<ElementType, P>;\n};\n\nexport const polymorphic = <T extends ElementType = 'div', P extends object = object>(\n  displayName: string\n): PolymorphicComponent<T, P> => {\n  return createPolymorphicComponent(displayName) as PolymorphicComponent<T, P>;\n};\n\nexport const withAsChild = <T extends ElementType = 'div', P extends object = object>(\n  _WrappedComponent: React.ComponentType<P>,\n  displayName: string\n) => {\n  const Wrapped = React.forwardRef<ElementType, P>((props, ref) => {\n    const propsRecord = props as Record<string, unknown>;\n    const { asChild, as, ...rest } = propsRecord;\n    const restProps = rest as Omit<P, 'asChild' | 'as'>;\n\n    if (asChild && React.isValidElement(propsRecord.children)) {\n      const child = propsRecord.children as React.ReactElement;\n      const childRef = (child as React.ReactElement & { ref?: React.Ref<unknown> }).ref;\n\n      return React.cloneElement(child, {\n        ...restProps,\n        ref: (childRefValue: React.Ref<unknown>) => {\n          if (childRefValue) {\n            if (typeof childRef === 'function') {\n              childRef(childRefValue);\n            } else if (childRef) {\n              (childRef as React.MutableRefObject<unknown>).current = childRefValue;\n            }\n          }\n        },\n      });\n    }\n\n    const ElementType = (as || 'div') as ElementType;\n    return React.createElement(\n      ElementType,\n      { ...restProps, ref },\n      propsRecord.children as React.ReactNode\n    );\n  });\n\n  Wrapped.displayName = displayName;\n\n  return Wrapped as PolymorphicComponent<T, P>;\n};\n\nexport default {\n  createPolymorphicComponent,\n  Slot,\n  createSlot,\n  mergeProps,\n  overrideProps,\n  createAsChildComponent,\n  polymorphic,\n  withAsChild,\n};\n"],"version":3}