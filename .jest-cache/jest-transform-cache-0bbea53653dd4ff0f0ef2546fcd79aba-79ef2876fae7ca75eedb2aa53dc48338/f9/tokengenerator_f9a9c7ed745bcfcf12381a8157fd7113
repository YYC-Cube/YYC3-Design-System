fd49ee7b847e03f2797b1e24f71b2ada
"use strict";
/**
 * @file AI Token 生成器
 * @description 使用 AI 算法自动生成设计令牌
 * @module ai/token-generator
 * @author YYC³
 * @version 1.0.0
 * @created 2026-02-18
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.tokenGenerator = exports.AITokenGenerator = void 0;
const culori_1 = __importDefault(require("culori"));
class AITokenGenerator {
    constructor() {
        this.harmonies = [
            {
                name: 'complementary',
                generate: (baseColor) => this.generateComplementary(baseColor),
            },
            {
                name: 'analogous',
                generate: (baseColor) => this.generateAnalogous(baseColor),
            },
            {
                name: 'triadic',
                generate: (baseColor) => this.generateTriadic(baseColor),
            },
            {
                name: 'tetradic',
                generate: (baseColor) => this.generateTetradic(baseColor),
            },
            {
                name: 'monochromatic',
                generate: (baseColor) => this.generateMonochromatic(baseColor),
            },
        ];
        this.spacingScales = [4, 8, 12, 16, 20, 24, 32, 40, 48, 64, 80, 96, 128, 160, 192, 256];
        this.typeScales = [12, 14, 16, 18, 20, 24, 30, 36, 48, 60, 72];
    }
    generateTokens(options = {}) {
        const { baseColor = '#d45a5f', harmony = 'monochromatic', scale = 10, includeShades = true, includeTints = true, } = options;
        return {
            colors: this.generateColorTokens(baseColor, harmony, includeShades, includeTints),
            spacing: this.generateSpacingTokens(scale),
            typography: this.generateTypographyTokens(),
        };
    }
    generateColorTokens(baseColor, harmony, includeShades, includeTints) {
        const harmonyFn = this.harmonies.find((h) => h.name === harmony);
        if (!harmonyFn) {
            throw new Error(`Unknown harmony: ${harmony}`);
        }
        const colors = harmonyFn.generate(baseColor);
        const colorTokens = {};
        colors.forEach((color, index) => {
            const colorName = index === 0 ? 'primary' : `color-${index + 1}`;
            colorTokens[colorName] = {
                name: colorName,
                value: {
                    oklch: this.hexToOklch(color),
                    hex: color,
                    foreground: this.getContrastColor(color),
                },
            };
            if (includeShades) {
                const shades = this.generateShades(color);
                shades.forEach((shade, shadeIndex) => {
                    colorTokens[`${colorName}-${shadeIndex * 100}`] = {
                        name: `${colorName}-${shadeIndex * 100}`,
                        value: {
                            oklch: this.hexToOklch(shade),
                            hex: shade,
                            foreground: this.getContrastColor(shade),
                        },
                    };
                });
            }
            if (includeTints) {
                const tints = this.generateTints(color);
                tints.forEach((tint, tintIndex) => {
                    colorTokens[`${colorName}-${tintIndex * 100 + 50}`] = {
                        name: `${colorName}-${tintIndex * 100 + 50}`,
                        value: {
                            oklch: this.hexToOklch(tint),
                            hex: tint,
                            foreground: this.getContrastColor(tint),
                        },
                    };
                });
            }
        });
        return colorTokens;
    }
    generateComplementary(baseColor) {
        const hsl = culori_1.default.converter('hsl')(baseColor);
        if (!hsl)
            return [baseColor];
        const complementary = { h: (hsl.h || 0) + 180, s: hsl.s, l: hsl.l, mode: 'hsl' };
        return [baseColor, culori_1.default.formatter.hex(complementary)];
    }
    generateAnalogous(baseColor) {
        const hsl = culori_1.default.converter('hsl')(baseColor);
        if (!hsl)
            return [baseColor];
        const colors = [baseColor];
        for (let i = 1; i <= 4; i++) {
            const color = { h: (hsl.h || 0) + i * 30, s: hsl.s, l: hsl.l, mode: 'hsl' };
            colors.push(culori_1.default.formatter.hex(color));
        }
        return colors;
    }
    generateTriadic(baseColor) {
        const hsl = culori_1.default.converter('hsl')(baseColor);
        if (!hsl)
            return [baseColor];
        const colors = [baseColor];
        for (let i = 1; i <= 2; i++) {
            const color = { h: (hsl.h || 0) + i * 120, s: hsl.s, l: hsl.l, mode: 'hsl' };
            colors.push(culori_1.default.formatter.hex(color));
        }
        return colors;
    }
    generateTetradic(baseColor) {
        const hsl = culori_1.default.converter('hsl')(baseColor);
        if (!hsl)
            return [baseColor];
        const colors = [baseColor];
        for (let i = 1; i <= 3; i++) {
            const color = { h: (hsl.h || 0) + i * 90, s: hsl.s, l: hsl.l, mode: 'hsl' };
            colors.push(culori_1.default.formatter.hex(color));
        }
        return colors;
    }
    generateMonochromatic(baseColor) {
        const hsl = culori_1.default.converter('hsl')(baseColor);
        if (!hsl)
            return [baseColor];
        const colors = [baseColor];
        for (let i = 1; i <= 10; i++) {
            const lightness = 0.1 + i * 0.08;
            const color = { h: hsl.h || 0, s: hsl.s, l: lightness, mode: 'hsl' };
            colors.push(culori_1.default.formatter.hex(color));
        }
        return colors;
    }
    generateShades(color) {
        const hsl = culori_1.default.converter('hsl')(color);
        if (!hsl)
            return [];
        const shades = [];
        for (let i = 1; i <= 5; i++) {
            const shade = {
                h: hsl.h || 0,
                s: hsl.s,
                l: Math.max(0, (hsl.l || 0.5) - i * 0.1),
                mode: 'hsl',
            };
            shades.push(culori_1.default.formatter.hex(shade));
        }
        return shades;
    }
    generateTints(color) {
        const hsl = culori_1.default.converter('hsl')(color);
        if (!hsl)
            return [];
        const tints = [];
        for (let i = 1; i <= 5; i++) {
            const tint = {
                h: hsl.h || 0,
                s: hsl.s,
                l: Math.min(1, (hsl.l || 0.5) + i * 0.1),
                mode: 'hsl',
            };
            tints.push(culori_1.default.formatter.hex(tint));
        }
        return tints;
    }
    generateSpacingTokens(scale) {
        const spacingTokens = {};
        const scaledValues = this.spacingScales.map((v) => v * (scale / 10));
        scaledValues.forEach((value, index) => {
            const name = this.getSpacingName(index);
            spacingTokens[name] = `${value}px`;
        });
        return spacingTokens;
    }
    getSpacingName(index) {
        const names = [
            'xs',
            'sm',
            'md',
            'lg',
            'xl',
            '2xl',
            '3xl',
            '4xl',
            '5xl',
            '6xl',
            '7xl',
            '8xl',
            '9xl',
            '10xl',
            '11xl',
            '12xl',
        ];
        return names[index] || `spacing-${index}`;
    }
    generateTypographyTokens() {
        const typographyTokens = {};
        this.typeScales.forEach((size, index) => {
            const name = this.getTypeName(index);
            typographyTokens[name] = `${size}px`;
        });
        return typographyTokens;
    }
    getTypeName(index) {
        const names = ['xs', 'sm', 'base', 'md', 'lg', 'xl', '2xl', '3xl', '4xl', '5xl', '6xl'];
        return names[index] || `text-${index}`;
    }
    hexToOklch(hex) {
        const oklch = culori_1.default.converter('oklch')(hex);
        if (!oklch)
            return hex;
        return `oklch(${oklch.l.toFixed(4)} ${oklch.c.toFixed(4)} ${(oklch.h || 0).toFixed(4)})`;
    }
    getContrastColor(hex) {
        const rgb = culori_1.default.converter('rgb')(hex);
        if (!rgb)
            return '#000000';
        const luminance = 0.299 * (rgb.r || 0) + 0.587 * (rgb.g || 0) + 0.114 * (rgb.b || 0);
        return luminance > 0.5 ? '#000000' : '#ffffff';
    }
    analyzeColorHarmony(colors) {
        if (colors.length < 2)
            return 'monochromatic';
        const hsls = colors.map((c) => culori_1.default.converter('hsl')(c));
        const hueDifferences = hsls.slice(1).map((hsl, i) => {
            const prevHsl = hsls[i];
            if (!hsl || !prevHsl)
                return 0;
            const diff = Math.abs((hsl.h || 0) - (prevHsl.h || 0));
            return Math.min(diff, 360 - diff);
        });
        const avgDiff = hueDifferences.length > 0
            ? hueDifferences.reduce((a, b) => a + b, 0) / hueDifferences.length
            : 0;
        if (avgDiff > 170 && avgDiff < 190)
            return 'complementary';
        if (avgDiff > 110 && avgDiff < 130)
            return 'triadic';
        if (avgDiff > 80 && avgDiff < 100)
            return 'tetradic';
        if (avgDiff > 20 && avgDiff < 40)
            return 'analogous';
        return 'monochromatic';
    }
    generateRecommendations(tokens) {
        const recommendations = [];
        const colors = Object.values(tokens.colors || {});
        if (colors.length > 0) {
            const colorHexes = colors.map((c) => {
                if (typeof c === 'string')
                    return c;
                if (typeof c === 'object' && c !== null && 'hex' in c)
                    return c.hex;
                if (typeof c === 'object' && c !== null && 'value' in c) {
                    const value = c.value;
                    if (typeof value === 'string')
                        return value;
                    if (typeof value === 'object' && value !== null && 'hex' in value)
                        return value.hex;
                }
                return c;
            });
            const harmony = this.analyzeColorHarmony(colorHexes);
            recommendations.push(`当前配色方案使用 ${harmony} 色彩和谐`);
            if (harmony === 'monochromatic') {
                recommendations.push('建议尝试 complementary 或 analogous 色彩和谐以增加视觉对比');
            }
        }
        const spacing = Object.values(tokens.spacing || {});
        if (spacing.length > 0) {
            const values = spacing.map((s) => {
                if (typeof s === 'string')
                    return parseInt(s);
                if (typeof s === 'number')
                    return s;
                return 0;
            });
            const ratio = values.length > 1 ? values[1] / values[0] : 0;
            if (ratio > 2.5 || ratio < 1.5) {
                recommendations.push('建议使用 1.5 或 1.618 的间距比例以获得更好的视觉节奏');
            }
        }
        return recommendations;
    }
}
exports.AITokenGenerator = AITokenGenerator;
exports.tokenGenerator = new AITokenGenerator();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL2FpL3Rva2VuLWdlbmVyYXRvci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7R0FPRzs7Ozs7O0FBR0gsb0RBQTRCO0FBZTVCLE1BQWEsZ0JBQWdCO0lBQTdCO1FBQ1UsY0FBUyxHQUFtQjtZQUNsQztnQkFDRSxJQUFJLEVBQUUsZUFBZTtnQkFDckIsUUFBUSxFQUFFLENBQUMsU0FBaUIsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLFNBQVMsQ0FBQzthQUN2RTtZQUNEO2dCQUNFLElBQUksRUFBRSxXQUFXO2dCQUNqQixRQUFRLEVBQUUsQ0FBQyxTQUFpQixFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDO2FBQ25FO1lBQ0Q7Z0JBQ0UsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsUUFBUSxFQUFFLENBQUMsU0FBaUIsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxTQUFTLENBQUM7YUFDakU7WUFDRDtnQkFDRSxJQUFJLEVBQUUsVUFBVTtnQkFDaEIsUUFBUSxFQUFFLENBQUMsU0FBaUIsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsQ0FBQzthQUNsRTtZQUNEO2dCQUNFLElBQUksRUFBRSxlQUFlO2dCQUNyQixRQUFRLEVBQUUsQ0FBQyxTQUFpQixFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsU0FBUyxDQUFDO2FBQ3ZFO1NBQ0YsQ0FBQztRQUVNLGtCQUFhLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNuRixl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QztRQUNILENBQUM7UUFFRCxNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDLENBQUM7UUFDcEQsSUFBSSxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQ3ZCLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtnQkFDL0IsSUFBSSxPQUFPLENBQUMsS0FBSyxRQUFRO29CQUFFLE9BQU8sUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUM5QyxJQUFJLE9BQU8sQ0FBQyxLQUFLLFFBQVE7b0JBQUUsT0FBTyxDQUFDLENBQUM7Z0JBQ3BDLE9BQU8sQ0FBQyxDQUFDO1lBQ1gsQ0FBQyxDQUFDLENBQUM7WUFDSCxNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzVELElBQUksS0FBSyxHQUFHLEdBQUcsSUFBSSxLQUFLLEdBQUcsR0FBRyxFQUFFLENBQUM7Z0JBQy9CLGVBQWUsQ0FBQyxJQUFJLENBQUMsa0NBQWtDLENBQUMsQ0FBQztZQUMzRCxDQUFDO1FBQ0gsQ0FBQztRQUVELE9BQU8sZUFBZSxDQUFDO0lBQ3pCLENBQUM7Q0FDRjtBQXJXRCw0Q0FxV0M7QUFFWSxRQUFBLGNBQWMsR0FBRyxJQUFJLGdCQUFnQixFQUFFLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL2FpL3Rva2VuLWdlbmVyYXRvci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIEFJIFRva2VuIOeUn+aIkOWZqFxuICogQGRlc2NyaXB0aW9uIOS9v+eUqCBBSSDnrpfms5Xoh6rliqjnlJ/miJDorr7orqHku6TniYxcbiAqIEBtb2R1bGUgYWkvdG9rZW4tZ2VuZXJhdG9yXG4gKiBAYXV0aG9yIFlZQ8KzXG4gKiBAdmVyc2lvbiAxLjAuMFxuICogQGNyZWF0ZWQgMjAyNi0wMi0xOFxuICovXG5cbmltcG9ydCB7IERlc2lnblRva2VucywgR2VuZXJhdGVkQ29sb3JUb2tlbiwgR2VuZXJhdGVkVG9rZW5zIH0gZnJvbSAnLi4vLi4vdHlwZXMvdG9rZW5zJztcbmltcG9ydCBjdWxvcmkgZnJvbSAnY3Vsb3JpJztcblxuZXhwb3J0IGludGVyZmFjZSBDb2xvckhhcm1vbnkge1xuICBuYW1lOiBzdHJpbmc7XG4gIGdlbmVyYXRlOiAoYmFzZUNvbG9yOiBzdHJpbmcpID0+IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRva2VuR2VuZXJhdGlvbk9wdGlvbnMge1xuICBiYXNlQ29sb3I/OiBzdHJpbmc7XG4gIGhhcm1vbnk/OiAnY29tcGxlbWVudGFyeScgfCAnYW5hbG9nb3VzJyB8ICd0cmlhZGljJyB8ICd0ZXRyYWRpYycgfCAnbW9ub2Nocm9tYXRpYyc7XG4gIHNjYWxlPzogbnVtYmVyO1xuICBpbmNsdWRlU2hhZGVzPzogYm9vbGVhbjtcbiAgaW5jbHVkZVRpbnRzPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIEFJVG9rZW5HZW5lcmF0b3Ige1xuICBwcml2YXRlIGhhcm1vbmllczogQ29sb3JIYXJtb255W10gPSBbXG4gICAge1xuICAgICAgbmFtZTogJ2NvbXBsZW1lbnRhcnknLFxuICAgICAgZ2VuZXJhdGU6IChiYXNlQ29sb3I6IHN0cmluZykgPT4gdGhpcy5nZW5lcmF0ZUNvbXBsZW1lbnRhcnkoYmFzZUNvbG9yKSxcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICdhbmFsb2dvdXMnLFxuICAgICAgZ2VuZXJhdGU6IChiYXNlQ29sb3I6IHN0cmluZykgPT4gdGhpcy5nZW5lcmF0ZUFuYWxvZ291cyhiYXNlQ29sb3IpLFxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogJ3RyaWFkaWMnLFxuICAgICAgZ2VuZXJhdGU6IChiYXNlQ29sb3I6IHN0cmluZykgPT4gdGhpcy5nZW5lcmF0ZVRyaWFkaWMoYmFzZUNvbG9yKSxcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICd0ZXRyYWRpYycsXG4gICAgICBnZW5lcmF0ZTogKGJhc2VDb2xvcjogc3RyaW5nKSA9PiB0aGlzLmdlbmVyYXRlVGV0cmFkaWMoYmFzZUNvbG9yKSxcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICdtb25vY2hyb21hdGljJyxcbiAgICAgIGdlbmVyYXRlOiAoYmFzZUNvbG9yOiBzdHJpbmcpID0+IHRoaXMuZ2VuZXJhdGVNb25vY2hyb21hdGljKGJhc2VDb2xvciksXG4gICAgfSxcbiAgXTtcblxuICBwcml2YXRlIHNwYWNpbmdTY2FsZXMgPSBbNCwgOCwgMTIsIDE2LCAyMCwgMjQsIDMyLCA0MCwgNDgsIDY0LCA4MCwgOTYsIDEyOCwgMTYwLCAxOTIsIDI1Nl07XG4gIHByaXZhdGUgdHlwZVNjYWxlcyA9IFsxMiwgMTQsIDE2LCAxOCwgMjAsIDI0LCAzMCwgMzYsIDQ4LCA2MCwgNzJdO1xuXG4gIGdlbmVyYXRlVG9rZW5zKG9wdGlvbnM6IFRva2VuR2VuZXJhdGlvbk9wdGlvbnMgPSB7fSk6IEdlbmVyYXRlZFRva2VucyB7XG4gICAgY29uc3Qge1xuICAgICAgYmFzZUNvbG9yID0gJyNkNDVhNWYnLFxuICAgICAgaGFybW9ueSA9ICdtb25vY2hyb21hdGljJyxcbiAgICAgIHNjYWxlID0gMTAsXG4gICAgICBpbmNsdWRlU2hhZGVzID0gdHJ1ZSxcbiAgICAgIGluY2x1ZGVUaW50cyA9IHRydWUsXG4gICAgfSA9IG9wdGlvbnM7XG5cbiAgICByZXR1cm4ge1xuICAgICAgY29sb3JzOiB0aGlzLmdlbmVyYXRlQ29sb3JUb2tlbnMoYmFzZUNvbG9yLCBoYXJtb255LCBpbmNsdWRlU2hhZGVzLCBpbmNsdWRlVGludHMpLFxuICAgICAgc3BhY2luZzogdGhpcy5nZW5lcmF0ZVNwYWNpbmdUb2tlbnMoc2NhbGUpLFxuICAgICAgdHlwb2dyYXBoeTogdGhpcy5nZW5lcmF0ZVR5cG9ncmFwaHlUb2tlbnMoKSxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNvbG9yVG9rZW5zKFxuICAgIGJhc2VDb2xvcjogc3RyaW5nLFxuICAgIGhhcm1vbnk6IHN0cmluZyxcbiAgICBpbmNsdWRlU2hhZGVzOiBib29sZWFuLFxuICAgIGluY2x1ZGVUaW50czogYm9vbGVhblxuICApOiBSZWNvcmQ8c3RyaW5nLCBHZW5lcmF0ZWRDb2xvclRva2VuPiB7XG4gICAgY29uc3QgaGFybW9ueUZuID0gdGhpcy5oYXJtb25pZXMuZmluZCgoaCkgPT4gaC5uYW1lID09PSBoYXJtb255KTtcbiAgICBpZiAoIWhhcm1vbnlGbikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGhhcm1vbnk6ICR7aGFybW9ueX1gKTtcbiAgICB9XG5cbiAgICBjb25zdCBjb2xvcnMgPSBoYXJtb255Rm4uZ2VuZXJhdGUoYmFzZUNvbG9yKTtcbiAgICBjb25zdCBjb2xvclRva2VuczogUmVjb3JkPHN0cmluZywgR2VuZXJhdGVkQ29sb3JUb2tlbj4gPSB7fTtcblxuICAgIGNvbG9ycy5mb3JFYWNoKChjb2xvciwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IGNvbG9yTmFtZSA9IGluZGV4ID09PSAwID8gJ3ByaW1hcnknIDogYGNvbG9yLSR7aW5kZXggKyAxfWA7XG4gICAgICBjb2xvclRva2Vuc1tjb2xvck5hbWVdID0ge1xuICAgICAgICBuYW1lOiBjb2xvck5hbWUsXG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgb2tsY2g6IHRoaXMuaGV4VG9Pa2xjaChjb2xvciksXG4gICAgICAgICAgaGV4OiBjb2xvcixcbiAgICAgICAgICBmb3JlZ3JvdW5kOiB0aGlzLmdldENvbnRyYXN0Q29sb3IoY29sb3IpLFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgaWYgKGluY2x1ZGVTaGFkZXMpIHtcbiAgICAgICAgY29uc3Qgc2hhZGVzID0gdGhpcy5nZW5lcmF0ZVNoYWRlcyhjb2xvcik7XG4gICAgICAgIHNoYWRlcy5mb3JFYWNoKChzaGFkZSwgc2hhZGVJbmRleCkgPT4ge1xuICAgICAgICAgIGNvbG9yVG9rZW5zW2Ake2NvbG9yTmFtZX0tJHtzaGFkZUluZGV4ICogMTAwfWBdID0ge1xuICAgICAgICAgICAgbmFtZTogYCR7Y29sb3JOYW1lfS0ke3NoYWRlSW5kZXggKiAxMDB9YCxcbiAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgIG9rbGNoOiB0aGlzLmhleFRvT2tsY2goc2hhZGUpLFxuICAgICAgICAgICAgICBoZXg6IHNoYWRlLFxuICAgICAgICAgICAgICBmb3JlZ3JvdW5kOiB0aGlzLmdldENvbnRyYXN0Q29sb3Ioc2hhZGUpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKGluY2x1ZGVUaW50cykge1xuICAgICAgICBjb25zdCB0aW50cyA9IHRoaXMuZ2VuZXJhdGVUaW50cyhjb2xvcik7XG4gICAgICAgIHRpbnRzLmZvckVhY2goKHRpbnQsIHRpbnRJbmRleCkgPT4ge1xuICAgICAgICAgIGNvbG9yVG9rZW5zW2Ake2NvbG9yTmFtZX0tJHt0aW50SW5kZXggKiAxMDAgKyA1MH1gXSA9IHtcbiAgICAgICAgICAgIG5hbWU6IGAke2NvbG9yTmFtZX0tJHt0aW50SW5kZXggKiAxMDAgKyA1MH1gLFxuICAgICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgICAgb2tsY2g6IHRoaXMuaGV4VG9Pa2xjaCh0aW50KSxcbiAgICAgICAgICAgICAgaGV4OiB0aW50LFxuICAgICAgICAgICAgICBmb3JlZ3JvdW5kOiB0aGlzLmdldENvbnRyYXN0Q29sb3IodGludCksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNvbG9yVG9rZW5zO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNvbXBsZW1lbnRhcnkoYmFzZUNvbG9yOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgaHNsID0gY3Vsb3JpLmNvbnZlcnRlcignaHNsJykoYmFzZUNvbG9yKSBhcyB7XG4gICAgICBoOiBudW1iZXI7XG4gICAgICBzOiBudW1iZXI7XG4gICAgICBsOiBudW1iZXI7XG4gICAgICBtb2RlPzogJ2hzbCc7XG4gICAgfSB8IG51bGw7XG4gICAgaWYgKCFoc2wpIHJldHVybiBbYmFzZUNvbG9yXTtcbiAgICBjb25zdCBjb21wbGVtZW50YXJ5OiBjdWxvcmkuSHNsID0geyBoOiAoaHNsLmggfHwgMCkgKyAxODAsIHM6IGhzbC5zLCBsOiBoc2wubCwgbW9kZTogJ2hzbCcgfTtcbiAgICByZXR1cm4gW2Jhc2VDb2xvciwgY3Vsb3JpLmZvcm1hdHRlci5oZXgoY29tcGxlbWVudGFyeSldO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUFuYWxvZ291cyhiYXNlQ29sb3I6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBoc2wgPSBjdWxvcmkuY29udmVydGVyKCdoc2wnKShiYXNlQ29sb3IpIGFzIHtcbiAgICAgIGg6IG51bWJlcjtcbiAgICAgIHM6IG51bWJlcjtcbiAgICAgIGw6IG51bWJlcjtcbiAgICAgIG1vZGU/OiAnaHNsJztcbiAgICB9IHwgbnVsbDtcbiAgICBpZiAoIWhzbCkgcmV0dXJuIFtiYXNlQ29sb3JdO1xuICAgIGNvbnN0IGNvbG9ycyA9IFtiYXNlQ29sb3JdO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IDQ7IGkrKykge1xuICAgICAgY29uc3QgY29sb3I6IGN1bG9yaS5Ic2wgPSB7IGg6IChoc2wuaCB8fCAwKSArIGkgKiAzMCwgczogaHNsLnMsIGw6IGhzbC5sLCBtb2RlOiAnaHNsJyB9O1xuICAgICAgY29sb3JzLnB1c2goY3Vsb3JpLmZvcm1hdHRlci5oZXgoY29sb3IpKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbG9ycztcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVUcmlhZGljKGJhc2VDb2xvcjogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGhzbCA9IGN1bG9yaS5jb252ZXJ0ZXIoJ2hzbCcpKGJhc2VDb2xvcikgYXMge1xuICAgICAgaDogbnVtYmVyO1xuICAgICAgczogbnVtYmVyO1xuICAgICAgbDogbnVtYmVyO1xuICAgICAgbW9kZT86ICdoc2wnO1xuICAgIH0gfCBudWxsO1xuICAgIGlmICghaHNsKSByZXR1cm4gW2Jhc2VDb2xvcl07XG4gICAgY29uc3QgY29sb3JzID0gW2Jhc2VDb2xvcl07XG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gMjsgaSsrKSB7XG4gICAgICBjb25zdCBjb2xvcjogY3Vsb3JpLkhzbCA9IHsgaDogKGhzbC5oIHx8IDApICsgaSAqIDEyMCwgczogaHNsLnMsIGw6IGhzbC5sLCBtb2RlOiAnaHNsJyB9O1xuICAgICAgY29sb3JzLnB1c2goY3Vsb3JpLmZvcm1hdHRlci5oZXgoY29sb3IpKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbG9ycztcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVUZXRyYWRpYyhiYXNlQ29sb3I6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBoc2wgPSBjdWxvcmkuY29udmVydGVyKCdoc2wnKShiYXNlQ29sb3IpIGFzIHtcbiAgICAgIGg6IG51bWJlcjtcbiAgICAgIHM6IG51bWJlcjtcbiAgICAgIGw6IG51bWJlcjtcbiAgICAgIG1vZGU/OiAnaHNsJztcbiAgICB9IHwgbnVsbDtcbiAgICBpZiAoIWhzbCkgcmV0dXJuIFtiYXNlQ29sb3JdO1xuICAgIGNvbnN0IGNvbG9ycyA9IFtiYXNlQ29sb3JdO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IDM7IGkrKykge1xuICAgICAgY29uc3QgY29sb3I6IGN1bG9yaS5Ic2wgPSB7IGg6IChoc2wuaCB8fCAwKSArIGkgKiA5MCwgczogaHNsLnMsIGw6IGhzbC5sLCBtb2RlOiAnaHNsJyB9O1xuICAgICAgY29sb3JzLnB1c2goY3Vsb3JpLmZvcm1hdHRlci5oZXgoY29sb3IpKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbG9ycztcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVNb25vY2hyb21hdGljKGJhc2VDb2xvcjogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGhzbCA9IGN1bG9yaS5jb252ZXJ0ZXIoJ2hzbCcpKGJhc2VDb2xvcikgYXMge1xuICAgICAgaDogbnVtYmVyO1xuICAgICAgczogbnVtYmVyO1xuICAgICAgbDogbnVtYmVyO1xuICAgICAgbW9kZT86ICdoc2wnO1xuICAgIH0gfCBudWxsO1xuICAgIGlmICghaHNsKSByZXR1cm4gW2Jhc2VDb2xvcl07XG4gICAgY29uc3QgY29sb3JzOiBzdHJpbmdbXSA9IFtiYXNlQ29sb3JdO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IDEwOyBpKyspIHtcbiAgICAgIGNvbnN0IGxpZ2h0bmVzcyA9IDAuMSArIGkgKiAwLjA4O1xuICAgICAgY29uc3QgY29sb3I6IGN1bG9yaS5Ic2wgPSB7IGg6IGhzbC5oIHx8IDAsIHM6IGhzbC5zLCBsOiBsaWdodG5lc3MsIG1vZGU6ICdoc2wnIH07XG4gICAgICBjb2xvcnMucHVzaChjdWxvcmkuZm9ybWF0dGVyLmhleChjb2xvcikpO1xuICAgIH1cbiAgICByZXR1cm4gY29sb3JzO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZVNoYWRlcyhjb2xvcjogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGhzbCA9IGN1bG9yaS5jb252ZXJ0ZXIoJ2hzbCcpKGNvbG9yKSBhcyB7XG4gICAgICBoOiBudW1iZXI7XG4gICAgICBzOiBudW1iZXI7XG4gICAgICBsOiBudW1iZXI7XG4gICAgICBtb2RlPzogJ2hzbCc7XG4gICAgfSB8IG51bGw7XG4gICAgaWYgKCFoc2wpIHJldHVybiBbXTtcbiAgICBjb25zdCBzaGFkZXM6IHN0cmluZ1tdID0gW107XG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gNTsgaSsrKSB7XG4gICAgICBjb25zdCBzaGFkZTogY3Vsb3JpLkhzbCA9IHtcbiAgICAgICAgaDogaHNsLmggfHwgMCxcbiAgICAgICAgczogaHNsLnMsXG4gICAgICAgIGw6IE1hdGgubWF4KDAsIChoc2wubCB8fCAwLjUpIC0gaSAqIDAuMSksXG4gICAgICAgIG1vZGU6ICdoc2wnLFxuICAgICAgfTtcbiAgICAgIHNoYWRlcy5wdXNoKGN1bG9yaS5mb3JtYXR0ZXIuaGV4KHNoYWRlKSk7XG4gICAgfVxuICAgIHJldHVybiBzaGFkZXM7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlVGludHMoY29sb3I6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBoc2wgPSBjdWxvcmkuY29udmVydGVyKCdoc2wnKShjb2xvcikgYXMge1xuICAgICAgaDogbnVtYmVyO1xuICAgICAgczogbnVtYmVyO1xuICAgICAgbDogbnVtYmVyO1xuICAgICAgbW9kZT86ICdoc2wnO1xuICAgIH0gfCBudWxsO1xuICAgIGlmICghaHNsKSByZXR1cm4gW107XG4gICAgY29uc3QgdGludHM6IHN0cmluZ1tdID0gW107XG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gNTsgaSsrKSB7XG4gICAgICBjb25zdCB0aW50OiBjdWxvcmkuSHNsID0ge1xuICAgICAgICBoOiBoc2wuaCB8fCAwLFxuICAgICAgICBzOiBoc2wucyxcbiAgICAgICAgbDogTWF0aC5taW4oMSwgKGhzbC5sIHx8IDAuNSkgKyBpICogMC4xKSxcbiAgICAgICAgbW9kZTogJ2hzbCcsXG4gICAgICB9O1xuICAgICAgdGludHMucHVzaChjdWxvcmkuZm9ybWF0dGVyLmhleCh0aW50KSk7XG4gICAgfVxuICAgIHJldHVybiB0aW50cztcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVTcGFjaW5nVG9rZW5zKHNjYWxlOiBudW1iZXIpOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBudW1iZXI+IHtcbiAgICBjb25zdCBzcGFjaW5nVG9rZW5zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBudW1iZXI+ID0ge307XG4gICAgY29uc3Qgc2NhbGVkVmFsdWVzID0gdGhpcy5zcGFjaW5nU2NhbGVzLm1hcCgodikgPT4gdiAqIChzY2FsZSAvIDEwKSk7XG5cbiAgICBzY2FsZWRWYWx1ZXMuZm9yRWFjaCgodmFsdWUsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBuYW1lID0gdGhpcy5nZXRTcGFjaW5nTmFtZShpbmRleCk7XG4gICAgICBzcGFjaW5nVG9rZW5zW25hbWVdID0gYCR7dmFsdWV9cHhgO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNwYWNpbmdUb2tlbnM7XG4gIH1cblxuICBwcml2YXRlIGdldFNwYWNpbmdOYW1lKGluZGV4OiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGNvbnN0IG5hbWVzID0gW1xuICAgICAgJ3hzJyxcbiAgICAgICdzbScsXG4gICAgICAnbWQnLFxuICAgICAgJ2xnJyxcbiAgICAgICd4bCcsXG4gICAgICAnMnhsJyxcbiAgICAgICczeGwnLFxuICAgICAgJzR4bCcsXG4gICAgICAnNXhsJyxcbiAgICAgICc2eGwnLFxuICAgICAgJzd4bCcsXG4gICAgICAnOHhsJyxcbiAgICAgICc5eGwnLFxuICAgICAgJzEweGwnLFxuICAgICAgJzExeGwnLFxuICAgICAgJzEyeGwnLFxuICAgIF07XG4gICAgcmV0dXJuIG5hbWVzW2luZGV4XSB8fCBgc3BhY2luZy0ke2luZGV4fWA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlVHlwb2dyYXBoeVRva2VucygpOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHtcbiAgICBjb25zdCB0eXBvZ3JhcGh5VG9rZW5zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG5cbiAgICB0aGlzLnR5cGVTY2FsZXMuZm9yRWFjaCgoc2l6ZSwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmdldFR5cGVOYW1lKGluZGV4KTtcbiAgICAgIHR5cG9ncmFwaHlUb2tlbnNbbmFtZV0gPSBgJHtzaXplfXB4YDtcbiAgICB9KTtcblxuICAgIHJldHVybiB0eXBvZ3JhcGh5VG9rZW5zO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRUeXBlTmFtZShpbmRleDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCBuYW1lcyA9IFsneHMnLCAnc20nLCAnYmFzZScsICdtZCcsICdsZycsICd4bCcsICcyeGwnLCAnM3hsJywgJzR4bCcsICc1eGwnLCAnNnhsJ107XG4gICAgcmV0dXJuIG5hbWVzW2luZGV4XSB8fCBgdGV4dC0ke2luZGV4fWA7XG4gIH1cblxuICBwcml2YXRlIGhleFRvT2tsY2goaGV4OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IG9rbGNoID0gY3Vsb3JpLmNvbnZlcnRlcignb2tsY2gnKShoZXgpIGFzIHtcbiAgICAgIGw6IG51bWJlcjtcbiAgICAgIGM6IG51bWJlcjtcbiAgICAgIGg6IG51bWJlcjtcbiAgICAgIG1vZGU/OiAnb2tsY2gnO1xuICAgIH0gfCBudWxsO1xuICAgIGlmICghb2tsY2gpIHJldHVybiBoZXg7XG4gICAgcmV0dXJuIGBva2xjaCgke29rbGNoLmwudG9GaXhlZCg0KX0gJHtva2xjaC5jLnRvRml4ZWQoNCl9ICR7KG9rbGNoLmggfHwgMCkudG9GaXhlZCg0KX0pYDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q29udHJhc3RDb2xvcihoZXg6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgcmdiID0gY3Vsb3JpLmNvbnZlcnRlcigncmdiJykoaGV4KSBhcyB7XG4gICAgICByOiBudW1iZXI7XG4gICAgICBnOiBudW1iZXI7XG4gICAgICBiOiBudW1iZXI7XG4gICAgICBtb2RlPzogJ3JnYic7XG4gICAgfSB8IG51bGw7XG4gICAgaWYgKCFyZ2IpIHJldHVybiAnIzAwMDAwMCc7XG4gICAgY29uc3QgbHVtaW5hbmNlID0gMC4yOTkgKiAocmdiLnIgfHwgMCkgKyAwLjU4NyAqIChyZ2IuZyB8fCAwKSArIDAuMTE0ICogKHJnYi5iIHx8IDApO1xuICAgIHJldHVybiBsdW1pbmFuY2UgPiAwLjUgPyAnIzAwMDAwMCcgOiAnI2ZmZmZmZic7XG4gIH1cblxuICBhbmFseXplQ29sb3JIYXJtb255KGNvbG9yczogc3RyaW5nW10pOiBzdHJpbmcge1xuICAgIGlmIChjb2xvcnMubGVuZ3RoIDwgMikgcmV0dXJuICdtb25vY2hyb21hdGljJztcblxuICAgIGNvbnN0IGhzbHMgPSBjb2xvcnMubWFwKFxuICAgICAgKGMpID0+IGN1bG9yaS5jb252ZXJ0ZXIoJ2hzbCcpKGMpIGFzIHsgaDogbnVtYmVyOyBzOiBudW1iZXI7IGw6IG51bWJlcjsgbW9kZT86ICdoc2wnIH0gfCBudWxsXG4gICAgKTtcbiAgICBjb25zdCBodWVEaWZmZXJlbmNlcyA9IGhzbHMuc2xpY2UoMSkubWFwKChoc2wsIGkpID0+IHtcbiAgICAgIGNvbnN0IHByZXZIc2wgPSBoc2xzW2ldO1xuICAgICAgaWYgKCFoc2wgfHwgIXByZXZIc2wpIHJldHVybiAwO1xuICAgICAgY29uc3QgZGlmZiA9IE1hdGguYWJzKChoc2wuaCB8fCAwKSAtIChwcmV2SHNsLmggfHwgMCkpO1xuICAgICAgcmV0dXJuIE1hdGgubWluKGRpZmYsIDM2MCAtIGRpZmYpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgYXZnRGlmZiA9XG4gICAgICBodWVEaWZmZXJlbmNlcy5sZW5ndGggPiAwXG4gICAgICAgID8gaHVlRGlmZmVyZW5jZXMucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCkgLyBodWVEaWZmZXJlbmNlcy5sZW5ndGhcbiAgICAgICAgOiAwO1xuXG4gICAgaWYgKGF2Z0RpZmYgPiAxNzAgJiYgYXZnRGlmZiA8IDE5MCkgcmV0dXJuICdjb21wbGVtZW50YXJ5JztcbiAgICBpZiAoYXZnRGlmZiA+IDExMCAmJiBhdmdEaWZmIDwgMTMwKSByZXR1cm4gJ3RyaWFkaWMnO1xuICAgIGlmIChhdmdEaWZmID4gODAgJiYgYXZnRGlmZiA8IDEwMCkgcmV0dXJuICd0ZXRyYWRpYyc7XG4gICAgaWYgKGF2Z0RpZmYgPiAyMCAmJiBhdmdEaWZmIDwgNDApIHJldHVybiAnYW5hbG9nb3VzJztcblxuICAgIHJldHVybiAnbW9ub2Nocm9tYXRpYyc7XG4gIH1cblxuICBnZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyh0b2tlbnM6IEdlbmVyYXRlZFRva2VucyB8IERlc2lnblRva2Vucyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICBjb25zdCBjb2xvcnMgPSBPYmplY3QudmFsdWVzKHRva2Vucy5jb2xvcnMgfHwge30pO1xuICAgIGlmIChjb2xvcnMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgY29sb3JIZXhlcyA9IGNvbG9ycy5tYXAoKGMpID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjID09PSAnc3RyaW5nJykgcmV0dXJuIGM7XG4gICAgICAgIGlmICh0eXBlb2YgYyA9PT0gJ29iamVjdCcgJiYgYyAhPT0gbnVsbCAmJiAnaGV4JyBpbiBjKSByZXR1cm4gKGMgYXMgeyBoZXg6IHN0cmluZyB9KS5oZXg7XG4gICAgICAgIGlmICh0eXBlb2YgYyA9PT0gJ29iamVjdCcgJiYgYyAhPT0gbnVsbCAmJiAndmFsdWUnIGluIGMpIHtcbiAgICAgICAgICBjb25zdCB2YWx1ZSA9IChjIGFzIHsgdmFsdWU6IHVua25vd24gfSkudmFsdWU7XG4gICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCAmJiAnaGV4JyBpbiB2YWx1ZSlcbiAgICAgICAgICAgIHJldHVybiAodmFsdWUgYXMgeyBoZXg6IHN0cmluZyB9KS5oZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGMgYXMgc3RyaW5nO1xuICAgICAgfSk7XG4gICAgICBjb25zdCBoYXJtb255ID0gdGhpcy5hbmFseXplQ29sb3JIYXJtb255KGNvbG9ySGV4ZXMpO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goYOW9k+WJjemFjeiJsuaWueahiOS9v+eUqCAke2hhcm1vbnl9IOiJsuW9qeWSjOiwkGApO1xuXG4gICAgICBpZiAoaGFybW9ueSA9PT0gJ21vbm9jaHJvbWF0aWMnKSB7XG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCflu7rorq7lsJ3or5UgY29tcGxlbWVudGFyeSDmiJYgYW5hbG9nb3VzIOiJsuW9qeWSjOiwkOS7peWinuWKoOinhuinieWvueavlCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHNwYWNpbmcgPSBPYmplY3QudmFsdWVzKHRva2Vucy5zcGFjaW5nIHx8IHt9KTtcbiAgICBpZiAoc3BhY2luZy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCB2YWx1ZXMgPSBzcGFjaW5nLm1hcCgocykgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIHMgPT09ICdzdHJpbmcnKSByZXR1cm4gcGFyc2VJbnQocyk7XG4gICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ251bWJlcicpIHJldHVybiBzO1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH0pO1xuICAgICAgY29uc3QgcmF0aW8gPSB2YWx1ZXMubGVuZ3RoID4gMSA/IHZhbHVlc1sxXSAvIHZhbHVlc1swXSA6IDA7XG4gICAgICBpZiAocmF0aW8gPiAyLjUgfHwgcmF0aW8gPCAxLjUpIHtcbiAgICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ+W7uuiuruS9v+eUqCAxLjUg5oiWIDEuNjE4IOeahOmXtOi3neavlOS+i+S7peiOt+W+l+abtOWlveeahOinhuinieiKguWljycpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnM7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHRva2VuR2VuZXJhdG9yID0gbmV3IEFJVG9rZW5HZW5lcmF0b3IoKTtcbiJdLCJ2ZXJzaW9uIjozfQ==