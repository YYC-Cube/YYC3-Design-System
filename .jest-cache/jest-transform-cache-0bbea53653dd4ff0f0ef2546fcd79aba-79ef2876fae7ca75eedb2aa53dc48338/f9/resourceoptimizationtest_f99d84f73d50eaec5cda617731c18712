80d9308ec272b003a83af016db860b3a
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
/**
 * @file 资源优化测试
 * @description 测试性能优化功能
 * @module __tests__/performance/resource-optimization.test
 * @author YYC³
 * @version 1.0.0
 * @created 2026-02-19
 */
const react_1 = require("@testing-library/react");
require("@testing-library/jest-dom");
const resource_optimization_1 = require("../resource-optimization");
const React = __importStar(require("react"));
global.fetch = jest.fn();
describe('Resource Optimization Module', () => {
    beforeEach(() => {
        jest.clearAllMocks();
        resource_optimization_1.resourceCache.clear();
        resource_optimization_1.imageCache.clear();
        global.fetch.mockReset();
    });
    afterEach(() => {
        jest.restoreAllMocks();
    });
    describe('资源缓存', () => {
        it('应该存储和检索缓存项', () => {
            const key = 'test-key';
            const value = { data: 'test-data' };
            resource_optimization_1.resourceCache.set(key, value);
            const retrieved = resource_optimization_1.resourceCache.get(key);
            expect(retrieved).toEqual(value);
            expect(resource_optimization_1.resourceCache.has(key)).toBe(true);
        });
        it('应该支持删除缓存项', () => {
            const key = 'test-key';
            const value = { data: 'test-data' };
            resource_optimization_1.resourceCache.set(key, value);
            expect(resource_optimization_1.resourceCache.has(key)).toBe(true);
            resource_optimization_1.resourceCache.delete(key);
            expect(resource_optimization_1.resourceCache.has(key)).toBe(false);
        });
        it('应该支持清空缓存', () => {
            resource_optimization_1.resourceCache.set('key1', { data: 'test1' });
            resource_optimization_1.resourceCache.set('key2', { data: 'test2' });
            resource_optimization_1.resourceCache.set('key3', { data: 'test3' });
            expect(resource_optimization_1.resourceCache.size()).toBe(3);
            resource_optimization_1.resourceCache.clear();
            expect(resource_optimization_1.resourceCache.size()).toBe(0);
        });
        it('应该支持缓存大小限制', () => {
            resource_optimization_1.resourceCache.set('key1', { data: 'test1' });
            resource_optimization_1.resourceCache.set('key2', { data: 'test2' });
            resource_optimization_1.resourceCache.set('key3', { data: 'test3' });
            resource_optimization_1.resourceCache.set('key4', { data: 'test4' });
            resource_optimization_1.resourceCache.set('key5', { data: 'test5' });
            expect(resource_optimization_1.resourceCache.size()).toBeGreaterThan(0);
        });
        it('应该支持TTL过期', () => {
            const key = 'test-key';
            const value = { data: 'test-data' };
            resource_optimization_1.resourceCache.set(key, value, 100);
            expect(resource_optimization_1.resourceCache.has(key)).toBe(true);
            return new Promise((resolve) => {
                setTimeout(() => {
                    const expired = resource_optimization_1.resourceCache.get(key);
                    expect(expired).toBeNull();
                    resolve(true);
                }, 150);
            });
        });
        it('应该处理缓存过期', () => {
            const key = 'expired-key';
            const value = { data: 'expired-data' };
            resource_optimization_1.resourceCache.set(key, value, 50);
            return new Promise((resolve) => {
                setTimeout(() => {
                    const retrieved = resource_optimization_1.resourceCache.get(key);
                    expect(retrieved).toBeNull();
                    resolve(true);
                }, 100);
            });
        });
    });
    describe('图像优化', () => {
        it('应该处理图像加载失败', async () => {
            const mockImage = {
                onload: null,
                onerror: null,
            };
            global.Image = jest.fn(() => {
                setTimeout(() => {
                    if (mockImage.onerror) {
                        mockImage.onerror();
                    }
                }, 10);
                return mockImage;
            });
            await expect((0, resource_optimization_1.compressImage)(new File(['mock'], 'test.png'))).rejects.toThrow('Failed to load image');
        });
        it('应该生成响应式图像URL', () => {
            const baseUrl = 'https://example.com/image.jpg';
            const sizes = [300, 600, 1200];
            const urls = (0, resource_optimization_1.generateResponsiveImageUrls)(baseUrl, sizes);
            expect(urls).toHaveLength(3);
            expect(urls[0].width).toBe(300);
            expect(urls[0].src).toContain('w=300');
            expect(urls[1].width).toBe(600);
            expect(urls[1].src).toContain('w=600');
            expect(urls[2].width).toBe(1200);
            expect(urls[2].src).toContain('w=1200');
        });
        it('应该生成响应式图像URL使用默认断点', () => {
            const baseUrl = 'https://example.com/image.jpg';
            const urls = (0, resource_optimization_1.generateResponsiveImageUrls)(baseUrl);
            expect(urls.length).toBeGreaterThan(0);
            expect(urls[0].src).toContain(baseUrl);
        });
        it('应该处理模糊哈希创建失败', async () => {
            global.HTMLCanvasElement.prototype.getContext = jest.fn(() => null);
            const blurHash = await (0, resource_optimization_1.createBlurHash)(new File(['mock'], 'test.png'));
            expect(blurHash).toBe('');
        });
        it('应该支持自定义图像格式', () => {
            const config = (0, resource_optimization_1.createImageOptimizationConfig)({
                format: 'webp',
            });
            expect(config.format).toBe('webp');
        });
        it('应该支持自定义质量设置', () => {
            const config = (0, resource_optimization_1.createImageOptimizationConfig)({
                quality: 0.9,
            });
            expect(config.quality).toBe(0.9);
        });
        it('应该支持自定义图像尺寸', () => {
            const config = (0, resource_optimization_1.createImageOptimizationConfig)({
                maxWidth: 1920,
                maxHeight: 1080,
            });
            expect(config.maxWidth).toBe(1920);
            expect(config.maxHeight).toBe(1080);
        });
        it('应该支持自定义断点', () => {
            const breakpoints = [320, 640, 960, 1280];
            const config = (0, resource_optimization_1.createImageOptimizationConfig)({
                breakpoints,
            });
            expect(config.breakpoints).toEqual(breakpoints);
        });
        it('应该支持启用占位符', () => {
            const config = (0, resource_optimization_1.createImageOptimizationConfig)({
                enablePlaceholder: true,
            });
            expect(config.enablePlaceholder).toBe(true);
        });
        it('应该支持启用响应式图像', () => {
            const config = (0, resource_optimization_1.createImageOptimizationConfig)({
                enableResponsiveImages: true,
            });
            expect(config.enableResponsiveImages).toBe(true);
        });
    });
    describe('资源预加载', () => {
        it('应该预加载图像', async () => {
            const mockImage = {
                onload: null,
                onerror: null,
            };
            global.Image = jest.fn(() => {
                setTimeout(() => {
                    if (mockImage.onload) {
                        mockImage.onload();
                    }
                }, 10);
                return mockImage;
            });
            const result = await (0, resource_optimization_1.preloadImage)('https://example.com/image.jpg');
            expect(result.success).toBe(true);
            expect(result.resource).toBe('https://example.com/image.jpg');
            expect(result.duration).toBeGreaterThanOrEqual(0);
        });
        it('应该从缓存加载图像', async () => {
            const mockImage = {
                onload: null,
                onerror: null,
            };
            global.Image = jest.fn(() => {
                setTimeout(() => {
                    if (mockImage.onload) {
                        mockImage.onload();
                    }
                }, 10);
                return mockImage;
            });
            const src = 'https://example.com/image.jpg';
            resource_optimization_1.imageCache.set(src, mockImage);
            const result = await (0, resource_optimization_1.preloadImage)(src);
            expect(result.success).toBe(true);
            expect(result.cached).toBe(true);
            expect(result.duration).toBe(0);
        });
        it('应该预加载fetch资源', async () => {
            global.fetch.mockResolvedValueOnce({
                ok: true,
            });
            const result = await (0, resource_optimization_1.preloadResource)('https://example.com/data.json', 'fetch');
            expect(result.success).toBe(true);
            expect(result.resource).toBe('https://example.com/data.json');
        });
        it('应该处理预加载失败', async () => {
            const mockImage = {
                onload: null,
                onerror: null,
            };
            global.Image = jest.fn(() => {
                setTimeout(() => {
                    if (mockImage.onerror) {
                        mockImage.onerror();
                    }
                }, 10);
                return mockImage;
            });
            const result = await (0, resource_optimization_1.preloadImage)('https://example.com/nonexistent.jpg');
            expect(result.success).toBe(false);
            expect(result.resource).toBe('https://example.com/nonexistent.jpg');
        });
        it('应该重试失败的预加载', async () => {
            let attemptCount = 0;
            const mockImage = {
                onload: null,
                onerror: null,
            };
            global.Image = jest.fn(() => {
                attemptCount++;
                setTimeout(() => {
                    if (attemptCount < 3) {
                        if (mockImage.onerror) {
                            mockImage.onerror();
                        }
                    }
                    else {
                        if (mockImage.onload) {
                            mockImage.onload();
                        }
                    }
                }, 10);
                return mockImage;
            });
            const result = await (0, resource_optimization_1.preloadImage)('https://example.com/retry.jpg', {
                retryCount: 3,
                retryDelay: 50,
            });
            expect(result.success).toBe(true);
            expect(attemptCount).toBe(3);
        });
        it('应该处理无效的资源类型', async () => {
            const result = await (0, resource_optimization_1.preloadResource)('https://example.com/data', 'invalid');
            expect(result.success).toBe(false);
            expect(result.duration).toBeGreaterThanOrEqual(0);
        });
    });
    describe('React Hooks', () => {
        it('应该使用图像优化hook', () => {
            const TestComponent = () => {
                const imageOpt = (0, resource_optimization_1.useImageOptimization)({
                    maxWidth: 800,
                    quality: 0.8,
                });
                return ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("div", { "data-testid": "compress-type", children: typeof imageOpt.compress }), (0, jsx_runtime_1.jsx)("div", { "data-testid": "preload-type", children: typeof imageOpt.preload }), (0, jsx_runtime_1.jsx)("div", { "data-testid": "generate-type", children: typeof imageOpt.generateResponsive }), (0, jsx_runtime_1.jsx)("div", { "data-testid": "blurhash-type", children: typeof imageOpt.createBlurHash })] }));
            };
            const { container } = (0, react_1.render)((0, jsx_runtime_1.jsx)(TestComponent, {}));
            expect(container.querySelector('[data-testid="compress-type"]')).toHaveTextContent('function');
            expect(container.querySelector('[data-testid="preload-type"]')).toHaveTextContent('function');
            expect(container.querySelector('[data-testid="generate-type"]')).toHaveTextContent('function');
            expect(container.querySelector('[data-testid="blurhash-type"]')).toHaveTextContent('function');
        });
        it('应该使用资源预加载hook', () => {
            const TestComponent = () => {
                const resourcePreload = (0, resource_optimization_1.useResourcePreload)({
                    preloadPriority: 'high',
                });
                return ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("div", { "data-testid": "preload-func-type", children: typeof resourcePreload.preload }), (0, jsx_runtime_1.jsx)("div", { "data-testid": "progress", children: resourcePreload.progress }), (0, jsx_runtime_1.jsx)("div", { "data-testid": "results", children: resourcePreload.results.length }), (0, jsx_runtime_1.jsx)("div", { "data-testid": "clear-cache-type", children: typeof resourcePreload.clearCache })] }));
            };
            const { container } = (0, react_1.render)((0, jsx_runtime_1.jsx)(TestComponent, {}));
            expect(container.querySelector('[data-testid="preload-func-type"]')).toHaveTextContent('function');
            expect(container.querySelector('[data-testid="progress"]')).toHaveTextContent('0');
            expect(container.querySelector('[data-testid="results"]')).toHaveTextContent('0');
            expect(container.querySelector('[data-testid="clear-cache-type"]')).toHaveTextContent('function');
        });
        it('应该调用资源预加载hook的preload函数', async () => {
            const mockImage = {
                onload: null,
                onerror: null,
            };
            global.Image = jest.fn(() => {
                setTimeout(() => {
                    if (mockImage.onload) {
                        mockImage.onload();
                    }
                }, 10);
                return mockImage;
            });
            const TestComponent = () => {
                const resourcePreload = (0, resource_optimization_1.useResourcePreload)({});
                const [loaded, setLoaded] = React.useState(false);
                const handleLoad = async () => {
                    await resourcePreload.preload([{ url: 'https://example.com/image.jpg', type: 'image' }]);
                    setLoaded(true);
                };
                return ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("div", { "data-testid": "loaded", children: loaded ? 'yes' : 'no' }), (0, jsx_runtime_1.jsx)("button", { "data-testid": "load-btn", onClick: handleLoad, children: "Load" })] }));
            };
            const { container } = (0, react_1.render)((0, jsx_runtime_1.jsx)(TestComponent, {}));
            const loadButton = container.querySelector('[data-testid="load-btn"]');
            loadButton.click();
            await (0, react_1.waitFor)(() => {
                expect(container.querySelector('[data-testid="loaded"]')).toHaveTextContent('yes');
            });
        });
        it('应该调用clearCache函数', async () => {
            const TestComponent = () => {
                const resourcePreload = (0, resource_optimization_1.useResourcePreload)({});
                const [cleared, setCleared] = React.useState(false);
                const handleClear = () => {
                    resourcePreload.clearCache();
                    setCleared(true);
                };
                return ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("div", { "data-testid": "cleared", children: cleared ? 'yes' : 'no' }), (0, jsx_runtime_1.jsx)("button", { "data-testid": "clear-btn", onClick: handleClear, children: "Clear" })] }));
            };
            const { container } = (0, react_1.render)((0, jsx_runtime_1.jsx)(TestComponent, {}));
            const clearButton = container.querySelector('[data-testid="clear-btn"]');
            clearButton.click();
            await (0, react_1.waitFor)(() => {
                expect(container.querySelector('[data-testid="cleared"]')).toHaveTextContent('yes');
            });
            expect(resource_optimization_1.imageCache.size()).toBe(0);
            expect(resource_optimization_1.resourceCache.size()).toBe(0);
        });
    });
    describe('配置管理', () => {
        it('应该创建图像优化配置', () => {
            const config = (0, resource_optimization_1.createImageOptimizationConfig)({
                maxWidth: 1920,
                quality: 0.9,
            });
            expect(config.maxWidth).toBe(1920);
            expect(config.quality).toBe(0.9);
            expect(config.cacheEnabled).toBe(true);
        });
        it('应该创建资源预加载配置', () => {
            const config = (0, resource_optimization_1.createResourcePreloadConfig)({
                preloadPriority: 'high',
                preloadTimeout: 5000,
            });
            expect(config.preloadPriority).toBe('high');
            expect(config.preloadTimeout).toBe(5000);
            expect(config.cacheEnabled).toBe(true);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL3BlcmZvcm1hbmNlL19fdGVzdHNfXy9yZXNvdXJjZS1vcHRpbWl6YXRpb24udGVzdC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7Ozs7Ozs7R0FPRztBQUVILGtEQUFvRTtBQUVwRSxxQ0FBbUM7QUFDbkMsb0VBWWtDO0FBQ2xDLDZDQUErQjtBQUUvQixNQUFNLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQVMsQ0FBQztBQUVoQyxRQUFRLENBQUMsOEJBQThCLEVBQUUsR0FBRyxFQUFFO0lBQzVDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDckIscUNBQWEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN0QixrQ0FBVSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2xCLE1BQU0sQ0FBQyxLQUFhLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDcEMsQ0FBQyxDQUFDLENBQUM7SUFFSCxTQUFTLENBQUMsR0FBRyxFQUFFO1FBQ2IsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBQ3pCLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUU7UUFDcEIsRUFBRSxDQUFDLFlBQVksRUFBRSxHQUFHLEVBQUU7WUFDcEIsTUFBTSxHQUFHLEdBQUcsVUFBVSxDQUFDO1lBQ3ZCLE1BQU0sS0FBSyxHQUFHLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxDQUFDO1lBRXBDLHFDQUFhLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUM5QixNQUFNLFNBQVMsR0FBRyxxQ0FBYSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUV6QyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2pDLE1BQU0s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QyxNQUFNLENBQUMsQ0FBQztZQUM1QyxNQUFNLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN6QyxNQUFNLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN6QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL3lhbnl1L0Rvd25sb2Fkcy95eWMzLURlc2lnbi1TeXN0ZW0vc3JjL3BlcmZvcm1hbmNlL19fdGVzdHNfXy9yZXNvdXJjZS1vcHRpbWl6YXRpb24udGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAZmlsZSDotYTmupDkvJjljJbmtYvor5VcbiAqIEBkZXNjcmlwdGlvbiDmtYvor5XmgKfog73kvJjljJblip/og71cbiAqIEBtb2R1bGUgX190ZXN0c19fL3BlcmZvcm1hbmNlL3Jlc291cmNlLW9wdGltaXphdGlvbi50ZXN0XG4gKiBAYXV0aG9yIFlZQ8KzXG4gKiBAdmVyc2lvbiAxLjAuMFxuICogQGNyZWF0ZWQgMjAyNi0wMi0xOVxuICovXG5cbmltcG9ydCB7IHJlbmRlciwgZmlyZUV2ZW50LCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5cbmltcG9ydCAnQHRlc3RpbmctbGlicmFyeS9qZXN0LWRvbSc7XG5pbXBvcnQge1xuICBpbWFnZUNhY2hlLFxuICByZXNvdXJjZUNhY2hlLFxuICBjb21wcmVzc0ltYWdlLFxuICBnZW5lcmF0ZVJlc3BvbnNpdmVJbWFnZVVybHMsXG4gIGNyZWF0ZUJsdXJIYXNoLFxuICBwcmVsb2FkSW1hZ2UsXG4gIHByZWxvYWRSZXNvdXJjZSxcbiAgdXNlSW1hZ2VPcHRpbWl6YXRpb24sXG4gIHVzZVJlc291cmNlUHJlbG9hZCxcbiAgY3JlYXRlSW1hZ2VPcHRpbWl6YXRpb25Db25maWcsXG4gIGNyZWF0ZVJlc291cmNlUHJlbG9hZENvbmZpZyxcbn0gZnJvbSAnLi4vcmVzb3VyY2Utb3B0aW1pemF0aW9uJztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuZ2xvYmFsLmZldGNoID0gamVzdC5mbigpIGFzIGFueTtcblxuZGVzY3JpYmUoJ1Jlc291cmNlIE9wdGltaXphdGlvbiBNb2R1bGUnLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIHJlc291cmNlQ2FjaGUuY2xlYXIoKTtcbiAgICBpbWFnZUNhY2hlLmNsZWFyKCk7XG4gICAgKGdsb2JhbC5mZXRjaCBhcyBhbnkpLm1vY2tSZXNldCgpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QucmVzdG9yZUFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCfotYTmupDnvJPlrZgnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpeWtmOWCqOWSjOajgOe0oue8k+WtmOmhuScsICgpID0+IHtcbiAgICAgIGNvbnN0IGtleSA9ICd0ZXN0LWtleSc7XG4gICAgICBjb25zdCB2YWx1ZSA9IHsgZGF0YTogJ3Rlc3QtZGF0YScgfTtcblxuICAgICAgcmVzb3VyY2VDYWNoZS5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICBjb25zdCByZXRyaWV2ZWQgPSByZXNvdXJjZUNhY2hlLmdldChrZXkpO1xuXG4gICAgICBleHBlY3QocmV0cmlldmVkKS50b0VxdWFsKHZhbHVlKTtcbiAgICAgIGV4cGVjdChyZXNvdXJjZUNhY2hlLmhhcyhrZXkpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeaUr+aMgeWIoOmZpOe8k+WtmOmhuScsICgpID0+IHtcbiAgICAgIGNvbnN0IGtleSA9ICd0ZXN0LWtleSc7XG4gICAgICBjb25zdCB2YWx1ZSA9IHsgZGF0YTogJ3Rlc3QtZGF0YScgfTtcblxuICAgICAgcmVzb3VyY2VDYWNoZS5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICBleHBlY3QocmVzb3VyY2VDYWNoZS5oYXMoa2V5KSkudG9CZSh0cnVlKTtcblxuICAgICAgcmVzb3VyY2VDYWNoZS5kZWxldGUoa2V5KTtcbiAgICAgIGV4cGVjdChyZXNvdXJjZUNhY2hlLmhhcyhrZXkpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XmlK/mjIHmuIXnqbrnvJPlrZgnLCAoKSA9PiB7XG4gICAgICByZXNvdXJjZUNhY2hlLnNldCgna2V5MScsIHsgZGF0YTogJ3Rlc3QxJyB9KTtcbiAgICAgIHJlc291cmNlQ2FjaGUuc2V0KCdrZXkyJywgeyBkYXRhOiAndGVzdDInIH0pO1xuICAgICAgcmVzb3VyY2VDYWNoZS5zZXQoJ2tleTMnLCB7IGRhdGE6ICd0ZXN0MycgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNvdXJjZUNhY2hlLnNpemUoKSkudG9CZSgzKTtcblxuICAgICAgcmVzb3VyY2VDYWNoZS5jbGVhcigpO1xuICAgICAgZXhwZWN0KHJlc291cmNlQ2FjaGUuc2l6ZSgpKS50b0JlKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeaUr+aMgee8k+WtmOWkp+Wwj+mZkOWIticsICgpID0+IHtcbiAgICAgIHJlc291cmNlQ2FjaGUuc2V0KCdrZXkxJywgeyBkYXRhOiAndGVzdDEnIH0pO1xuICAgICAgcmVzb3VyY2VDYWNoZS5zZXQoJ2tleTInLCB7IGRhdGE6ICd0ZXN0MicgfSk7XG4gICAgICByZXNvdXJjZUNhY2hlLnNldCgna2V5MycsIHsgZGF0YTogJ3Rlc3QzJyB9KTtcbiAgICAgIHJlc291cmNlQ2FjaGUuc2V0KCdrZXk0JywgeyBkYXRhOiAndGVzdDQnIH0pO1xuICAgICAgcmVzb3VyY2VDYWNoZS5zZXQoJ2tleTUnLCB7IGRhdGE6ICd0ZXN0NScgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNvdXJjZUNhY2hlLnNpemUoKSkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeaUr+aMgVRUTOi/h+acnycsICgpID0+IHtcbiAgICAgIGNvbnN0IGtleSA9ICd0ZXN0LWtleSc7XG4gICAgICBjb25zdCB2YWx1ZSA9IHsgZGF0YTogJ3Rlc3QtZGF0YScgfTtcblxuICAgICAgcmVzb3VyY2VDYWNoZS5zZXQoa2V5LCB2YWx1ZSwgMTAwKTtcblxuICAgICAgZXhwZWN0KHJlc291cmNlQ2FjaGUuaGFzKGtleSkpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBjb25zdCBleHBpcmVkID0gcmVzb3VyY2VDYWNoZS5nZXQoa2V5KTtcbiAgICAgICAgICBleHBlY3QoZXhwaXJlZCkudG9CZU51bGwoKTtcbiAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICB9LCAxNTApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5aSE55CG57yT5a2Y6L+H5pyfJywgKCkgPT4ge1xuICAgICAgY29uc3Qga2V5ID0gJ2V4cGlyZWQta2V5JztcbiAgICAgIGNvbnN0IHZhbHVlID0geyBkYXRhOiAnZXhwaXJlZC1kYXRhJyB9O1xuXG4gICAgICByZXNvdXJjZUNhY2hlLnNldChrZXksIHZhbHVlLCA1MCk7XG5cbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBjb25zdCByZXRyaWV2ZWQgPSByZXNvdXJjZUNhY2hlLmdldChrZXkpO1xuICAgICAgICAgIGV4cGVjdChyZXRyaWV2ZWQpLnRvQmVOdWxsKCk7XG4gICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSwgMTAwKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgn5Zu+5YOP5LyY5YyWJywgKCkgPT4ge1xuICAgIGl0KCflupTor6XlpITnkIblm77lg4/liqDovb3lpLHotKUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrSW1hZ2UgPSB7XG4gICAgICAgIG9ubG9hZDogbnVsbCBhcyAoKCkgPT4gdm9pZCkgfCBudWxsLFxuICAgICAgICBvbmVycm9yOiBudWxsIGFzICgoKSA9PiB2b2lkKSB8IG51bGwsXG4gICAgICB9O1xuXG4gICAgICBnbG9iYWwuSW1hZ2UgPSBqZXN0LmZuKCgpID0+IHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgaWYgKG1vY2tJbWFnZS5vbmVycm9yKSB7XG4gICAgICAgICAgICBtb2NrSW1hZ2Uub25lcnJvcigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgMTApO1xuICAgICAgICByZXR1cm4gbW9ja0ltYWdlO1xuICAgICAgfSkgYXMgYW55O1xuXG4gICAgICBhd2FpdCBleHBlY3QoY29tcHJlc3NJbWFnZShuZXcgRmlsZShbJ21vY2snXSwgJ3Rlc3QucG5nJykgYXMgYW55KSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICAnRmFpbGVkIHRvIGxvYWQgaW1hZ2UnXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeeUn+aIkOWTjeW6lOW8j+WbvuWDj1VSTCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGJhc2VVcmwgPSAnaHR0cHM6Ly9leGFtcGxlLmNvbS9pbWFnZS5qcGcnO1xuICAgICAgY29uc3Qgc2l6ZXMgPSBbMzAwLCA2MDAsIDEyMDBdO1xuICAgICAgY29uc3QgdXJscyA9IGdlbmVyYXRlUmVzcG9uc2l2ZUltYWdlVXJscyhiYXNlVXJsLCBzaXplcyk7XG5cbiAgICAgIGV4cGVjdCh1cmxzKS50b0hhdmVMZW5ndGgoMyk7XG4gICAgICBleHBlY3QodXJsc1swXS53aWR0aCkudG9CZSgzMDApO1xuICAgICAgZXhwZWN0KHVybHNbMF0uc3JjKS50b0NvbnRhaW4oJ3c9MzAwJyk7XG4gICAgICBleHBlY3QodXJsc1sxXS53aWR0aCkudG9CZSg2MDApO1xuICAgICAgZXhwZWN0KHVybHNbMV0uc3JjKS50b0NvbnRhaW4oJ3c9NjAwJyk7XG4gICAgICBleHBlY3QodXJsc1syXS53aWR0aCkudG9CZSgxMjAwKTtcbiAgICAgIGV4cGVjdCh1cmxzWzJdLnNyYykudG9Db250YWluKCd3PTEyMDAnKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XnlJ/miJDlk43lupTlvI/lm77lg49VUkzkvb/nlKjpu5jorqTmlq3ngrknLCAoKSA9PiB7XG4gICAgICBjb25zdCBiYXNlVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vaW1hZ2UuanBnJztcbiAgICAgIGNvbnN0IHVybHMgPSBnZW5lcmF0ZVJlc3BvbnNpdmVJbWFnZVVybHMoYmFzZVVybCk7XG5cbiAgICAgIGV4cGVjdCh1cmxzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KHVybHNbMF0uc3JjKS50b0NvbnRhaW4oYmFzZVVybCk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5aSE55CG5qih57OK5ZOI5biM5Yib5bu65aSx6LSlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKGdsb2JhbC5IVE1MQ2FudmFzRWxlbWVudCBhcyBhbnkpLnByb3RvdHlwZS5nZXRDb250ZXh0ID0gamVzdC5mbigoKSA9PiBudWxsKTtcblxuICAgICAgY29uc3QgYmx1ckhhc2ggPSBhd2FpdCBjcmVhdGVCbHVySGFzaChuZXcgRmlsZShbJ21vY2snXSwgJ3Rlc3QucG5nJykgYXMgYW55KTtcblxuICAgICAgZXhwZWN0KGJsdXJIYXNoKS50b0JlKCcnKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XmlK/mjIHoh6rlrprkuYnlm77lg4/moLzlvI8nLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb25maWcgPSBjcmVhdGVJbWFnZU9wdGltaXphdGlvbkNvbmZpZyh7XG4gICAgICAgIGZvcm1hdDogJ3dlYnAnLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChjb25maWcuZm9ybWF0KS50b0JlKCd3ZWJwJyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5pSv5oyB6Ieq5a6a5LmJ6LSo6YeP6K6+572uJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0gY3JlYXRlSW1hZ2VPcHRpbWl6YXRpb25Db25maWcoe1xuICAgICAgICBxdWFsaXR5OiAwLjksXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KGNvbmZpZy5xdWFsaXR5KS50b0JlKDAuOSk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5pSv5oyB6Ieq5a6a5LmJ5Zu+5YOP5bC65a+4JywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0gY3JlYXRlSW1hZ2VPcHRpbWl6YXRpb25Db25maWcoe1xuICAgICAgICBtYXhXaWR0aDogMTkyMCxcbiAgICAgICAgbWF4SGVpZ2h0OiAxMDgwLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChjb25maWcubWF4V2lkdGgpLnRvQmUoMTkyMCk7XG4gICAgICBleHBlY3QoY29uZmlnLm1heEhlaWdodCkudG9CZSgxMDgwKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XmlK/mjIHoh6rlrprkuYnmlq3ngrknLCAoKSA9PiB7XG4gICAgICBjb25zdCBicmVha3BvaW50cyA9IFszMjAsIDY0MCwgOTYwLCAxMjgwXTtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IGNyZWF0ZUltYWdlT3B0aW1pemF0aW9uQ29uZmlnKHtcbiAgICAgICAgYnJlYWtwb2ludHMsXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KGNvbmZpZy5icmVha3BvaW50cykudG9FcXVhbChicmVha3BvaW50cyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5pSv5oyB5ZCv55So5Y2g5L2N56ymJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0gY3JlYXRlSW1hZ2VPcHRpbWl6YXRpb25Db25maWcoe1xuICAgICAgICBlbmFibGVQbGFjZWhvbGRlcjogdHJ1ZSxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QoY29uZmlnLmVuYWJsZVBsYWNlaG9sZGVyKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeaUr+aMgeWQr+eUqOWTjeW6lOW8j+WbvuWDjycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IGNyZWF0ZUltYWdlT3B0aW1pemF0aW9uQ29uZmlnKHtcbiAgICAgICAgZW5hYmxlUmVzcG9uc2l2ZUltYWdlczogdHJ1ZSxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QoY29uZmlnLmVuYWJsZVJlc3BvbnNpdmVJbWFnZXMpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCfotYTmupDpooTliqDovb0nLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpemihOWKoOi9veWbvuWDjycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tJbWFnZSA9IHtcbiAgICAgICAgb25sb2FkOiBudWxsIGFzICgoKSA9PiB2b2lkKSB8IG51bGwsXG4gICAgICAgIG9uZXJyb3I6IG51bGwgYXMgKCgpID0+IHZvaWQpIHwgbnVsbCxcbiAgICAgIH07XG5cbiAgICAgIGdsb2JhbC5JbWFnZSA9IGplc3QuZm4oKCkgPT4ge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBpZiAobW9ja0ltYWdlLm9ubG9hZCkge1xuICAgICAgICAgICAgbW9ja0ltYWdlLm9ubG9hZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgMTApO1xuICAgICAgICByZXR1cm4gbW9ja0ltYWdlO1xuICAgICAgfSkgYXMgYW55O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcmVsb2FkSW1hZ2UoJ2h0dHBzOi8vZXhhbXBsZS5jb20vaW1hZ2UuanBnJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucmVzb3VyY2UpLnRvQmUoJ2h0dHBzOi8vZXhhbXBsZS5jb20vaW1hZ2UuanBnJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmR1cmF0aW9uKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeS7jue8k+WtmOWKoOi9veWbvuWDjycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tJbWFnZSA9IHtcbiAgICAgICAgb25sb2FkOiBudWxsIGFzICgoKSA9PiB2b2lkKSB8IG51bGwsXG4gICAgICAgIG9uZXJyb3I6IG51bGwgYXMgKCgpID0+IHZvaWQpIHwgbnVsbCxcbiAgICAgIH07XG5cbiAgICAgIGdsb2JhbC5JbWFnZSA9IGplc3QuZm4oKCkgPT4ge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBpZiAobW9ja0ltYWdlLm9ubG9hZCkge1xuICAgICAgICAgICAgbW9ja0ltYWdlLm9ubG9hZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgMTApO1xuICAgICAgICByZXR1cm4gbW9ja0ltYWdlO1xuICAgICAgfSkgYXMgYW55O1xuXG4gICAgICBjb25zdCBzcmMgPSAnaHR0cHM6Ly9leGFtcGxlLmNvbS9pbWFnZS5qcGcnO1xuICAgICAgaW1hZ2VDYWNoZS5zZXQoc3JjLCBtb2NrSW1hZ2UgYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJlbG9hZEltYWdlKHNyYyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY2FjaGVkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5kdXJhdGlvbikudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XpooTliqDovb1mZXRjaOi1hOa6kCcsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcmVsb2FkUmVzb3VyY2UoJ2h0dHBzOi8vZXhhbXBsZS5jb20vZGF0YS5qc29uJywgJ2ZldGNoJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucmVzb3VyY2UpLnRvQmUoJ2h0dHBzOi8vZXhhbXBsZS5jb20vZGF0YS5qc29uJyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5aSE55CG6aKE5Yqg6L295aSx6LSlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0ltYWdlID0ge1xuICAgICAgICBvbmxvYWQ6IG51bGwgYXMgKCgpID0+IHZvaWQpIHwgbnVsbCxcbiAgICAgICAgb25lcnJvcjogbnVsbCBhcyAoKCkgPT4gdm9pZCkgfCBudWxsLFxuICAgICAgfTtcblxuICAgICAgZ2xvYmFsLkltYWdlID0gamVzdC5mbigoKSA9PiB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGlmIChtb2NrSW1hZ2Uub25lcnJvcikge1xuICAgICAgICAgICAgbW9ja0ltYWdlLm9uZXJyb3IoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIDEwKTtcbiAgICAgICAgcmV0dXJuIG1vY2tJbWFnZTtcbiAgICAgIH0pIGFzIGFueTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJlbG9hZEltYWdlKCdodHRwczovL2V4YW1wbGUuY29tL25vbmV4aXN0ZW50LmpwZycpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5yZXNvdXJjZSkudG9CZSgnaHR0cHM6Ly9leGFtcGxlLmNvbS9ub25leGlzdGVudC5qcGcnKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6Xph43or5XlpLHotKXnmoTpooTliqDovb0nLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgYXR0ZW1wdENvdW50ID0gMDtcbiAgICAgIGNvbnN0IG1vY2tJbWFnZSA9IHtcbiAgICAgICAgb25sb2FkOiBudWxsIGFzICgoKSA9PiB2b2lkKSB8IG51bGwsXG4gICAgICAgIG9uZXJyb3I6IG51bGwgYXMgKCgpID0+IHZvaWQpIHwgbnVsbCxcbiAgICAgIH07XG5cbiAgICAgIGdsb2JhbC5JbWFnZSA9IGplc3QuZm4oKCkgPT4ge1xuICAgICAgICBhdHRlbXB0Q291bnQrKztcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgaWYgKGF0dGVtcHRDb3VudCA8IDMpIHtcbiAgICAgICAgICAgIGlmIChtb2NrSW1hZ2Uub25lcnJvcikge1xuICAgICAgICAgICAgICBtb2NrSW1hZ2Uub25lcnJvcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAobW9ja0ltYWdlLm9ubG9hZCkge1xuICAgICAgICAgICAgICBtb2NrSW1hZ2Uub25sb2FkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCAxMCk7XG4gICAgICAgIHJldHVybiBtb2NrSW1hZ2U7XG4gICAgICB9KSBhcyBhbnk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByZWxvYWRJbWFnZSgnaHR0cHM6Ly9leGFtcGxlLmNvbS9yZXRyeS5qcGcnLCB7XG4gICAgICAgIHJldHJ5Q291bnQ6IDMsXG4gICAgICAgIHJldHJ5RGVsYXk6IDUwLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChhdHRlbXB0Q291bnQpLnRvQmUoMyk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5aSE55CG5peg5pWI55qE6LWE5rqQ57G75Z6LJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJlbG9hZFJlc291cmNlKCdodHRwczovL2V4YW1wbGUuY29tL2RhdGEnLCAnaW52YWxpZCcgYXMgYW55KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZHVyYXRpb24pLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZWFjdCBIb29rcycsICgpID0+IHtcbiAgICBpdCgn5bqU6K+l5L2/55So5Zu+5YOP5LyY5YyWaG9vaycsICgpID0+IHtcbiAgICAgIGNvbnN0IFRlc3RDb21wb25lbnQgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGltYWdlT3B0ID0gdXNlSW1hZ2VPcHRpbWl6YXRpb24oe1xuICAgICAgICAgIG1heFdpZHRoOiA4MDAsXG4gICAgICAgICAgcXVhbGl0eTogMC44LFxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwiY29tcHJlc3MtdHlwZVwiPnt0eXBlb2YgaW1hZ2VPcHQuY29tcHJlc3N9PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwicHJlbG9hZC10eXBlXCI+e3R5cGVvZiBpbWFnZU9wdC5wcmVsb2FkfTwvZGl2PlxuICAgICAgICAgICAgPGRpdiBkYXRhLXRlc3RpZD1cImdlbmVyYXRlLXR5cGVcIj57dHlwZW9mIGltYWdlT3B0LmdlbmVyYXRlUmVzcG9uc2l2ZX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJibHVyaGFzaC10eXBlXCI+e3R5cGVvZiBpbWFnZU9wdC5jcmVhdGVCbHVySGFzaH08L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSByZW5kZXIoPFRlc3RDb21wb25lbnQgLz4pO1xuXG4gICAgICBleHBlY3QoY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRlc3RpZD1cImNvbXByZXNzLXR5cGVcIl0nKSkudG9IYXZlVGV4dENvbnRlbnQoXG4gICAgICAgICdmdW5jdGlvbidcbiAgICAgICk7XG4gICAgICBleHBlY3QoY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRlc3RpZD1cInByZWxvYWQtdHlwZVwiXScpKS50b0hhdmVUZXh0Q29udGVudCgnZnVuY3Rpb24nKTtcbiAgICAgIGV4cGVjdChjb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtdGVzdGlkPVwiZ2VuZXJhdGUtdHlwZVwiXScpKS50b0hhdmVUZXh0Q29udGVudChcbiAgICAgICAgJ2Z1bmN0aW9uJ1xuICAgICAgKTtcbiAgICAgIGV4cGVjdChjb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtdGVzdGlkPVwiYmx1cmhhc2gtdHlwZVwiXScpKS50b0hhdmVUZXh0Q29udGVudChcbiAgICAgICAgJ2Z1bmN0aW9uJ1xuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6Xkvb/nlKjotYTmupDpooTliqDovb1ob29rJywgKCkgPT4ge1xuICAgICAgY29uc3QgVGVzdENvbXBvbmVudCA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzb3VyY2VQcmVsb2FkID0gdXNlUmVzb3VyY2VQcmVsb2FkKHtcbiAgICAgICAgICBwcmVsb2FkUHJpb3JpdHk6ICdoaWdoJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPGRpdiBkYXRhLXRlc3RpZD1cInByZWxvYWQtZnVuYy10eXBlXCI+e3R5cGVvZiByZXNvdXJjZVByZWxvYWQucHJlbG9hZH08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJwcm9ncmVzc1wiPntyZXNvdXJjZVByZWxvYWQucHJvZ3Jlc3N9PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwicmVzdWx0c1wiPntyZXNvdXJjZVByZWxvYWQucmVzdWx0cy5sZW5ndGh9PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwiY2xlYXItY2FjaGUtdHlwZVwiPnt0eXBlb2YgcmVzb3VyY2VQcmVsb2FkLmNsZWFyQ2FjaGV9PC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICBjb25zdCB7IGNvbnRhaW5lciB9ID0gcmVuZGVyKDxUZXN0Q29tcG9uZW50IC8+KTtcblxuICAgICAgZXhwZWN0KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdbZGF0YS10ZXN0aWQ9XCJwcmVsb2FkLWZ1bmMtdHlwZVwiXScpKS50b0hhdmVUZXh0Q29udGVudChcbiAgICAgICAgJ2Z1bmN0aW9uJ1xuICAgICAgKTtcbiAgICAgIGV4cGVjdChjb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtdGVzdGlkPVwicHJvZ3Jlc3NcIl0nKSkudG9IYXZlVGV4dENvbnRlbnQoJzAnKTtcbiAgICAgIGV4cGVjdChjb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtdGVzdGlkPVwicmVzdWx0c1wiXScpKS50b0hhdmVUZXh0Q29udGVudCgnMCcpO1xuICAgICAgZXhwZWN0KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdbZGF0YS10ZXN0aWQ9XCJjbGVhci1jYWNoZS10eXBlXCJdJykpLnRvSGF2ZVRleHRDb250ZW50KFxuICAgICAgICAnZnVuY3Rpb24nXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W6lOivpeiwg+eUqOi1hOa6kOmihOWKoOi9vWhvb2vnmoRwcmVsb2Fk5Ye95pWwJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0ltYWdlID0ge1xuICAgICAgICBvbmxvYWQ6IG51bGwgYXMgKCgpID0+IHZvaWQpIHwgbnVsbCxcbiAgICAgICAgb25lcnJvcjogbnVsbCBhcyAoKCkgPT4gdm9pZCkgfCBudWxsLFxuICAgICAgfTtcblxuICAgICAgZ2xvYmFsLkltYWdlID0gamVzdC5mbigoKSA9PiB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGlmIChtb2NrSW1hZ2Uub25sb2FkKSB7XG4gICAgICAgICAgICBtb2NrSW1hZ2Uub25sb2FkKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCAxMCk7XG4gICAgICAgIHJldHVybiBtb2NrSW1hZ2U7XG4gICAgICB9KSBhcyBhbnk7XG5cbiAgICAgIGNvbnN0IFRlc3RDb21wb25lbnQgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc291cmNlUHJlbG9hZCA9IHVzZVJlc291cmNlUHJlbG9hZCh7fSk7XG4gICAgICAgIGNvbnN0IFtsb2FkZWQsIHNldExvYWRlZF0gPSBSZWFjdC51c2VTdGF0ZShmYWxzZSk7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlTG9hZCA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICBhd2FpdCByZXNvdXJjZVByZWxvYWQucHJlbG9hZChbeyB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL2ltYWdlLmpwZycsIHR5cGU6ICdpbWFnZScgfV0pO1xuICAgICAgICAgIHNldExvYWRlZCh0cnVlKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwibG9hZGVkXCI+e2xvYWRlZCA/ICd5ZXMnIDogJ25vJ308L2Rpdj5cbiAgICAgICAgICAgIDxidXR0b24gZGF0YS10ZXN0aWQ9XCJsb2FkLWJ0blwiIG9uQ2xpY2s9e2hhbmRsZUxvYWR9PlxuICAgICAgICAgICAgICBMb2FkXG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSByZW5kZXIoPFRlc3RDb21wb25lbnQgLz4pO1xuXG4gICAgICBjb25zdCBsb2FkQnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRlc3RpZD1cImxvYWQtYnRuXCJdJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgICBsb2FkQnV0dG9uLmNsaWNrKCk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QoY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRlc3RpZD1cImxvYWRlZFwiXScpKS50b0hhdmVUZXh0Q29udGVudCgneWVzJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCflupTor6XosIPnlKhjbGVhckNhY2hl5Ye95pWwJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgVGVzdENvbXBvbmVudCA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzb3VyY2VQcmVsb2FkID0gdXNlUmVzb3VyY2VQcmVsb2FkKHt9KTtcbiAgICAgICAgY29uc3QgW2NsZWFyZWQsIHNldENsZWFyZWRdID0gUmVhY3QudXNlU3RhdGUoZmFsc2UpO1xuXG4gICAgICAgIGNvbnN0IGhhbmRsZUNsZWFyID0gKCkgPT4ge1xuICAgICAgICAgIHJlc291cmNlUHJlbG9hZC5jbGVhckNhY2hlKCk7XG4gICAgICAgICAgc2V0Q2xlYXJlZCh0cnVlKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwiY2xlYXJlZFwiPntjbGVhcmVkID8gJ3llcycgOiAnbm8nfTwvZGl2PlxuICAgICAgICAgICAgPGJ1dHRvbiBkYXRhLXRlc3RpZD1cImNsZWFyLWJ0blwiIG9uQ2xpY2s9e2hhbmRsZUNsZWFyfT5cbiAgICAgICAgICAgICAgQ2xlYXJcbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgICAgfTtcblxuICAgICAgY29uc3QgeyBjb250YWluZXIgfSA9IHJlbmRlcig8VGVzdENvbXBvbmVudCAvPik7XG5cbiAgICAgIGNvbnN0IGNsZWFyQnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRlc3RpZD1cImNsZWFyLWJ0blwiXScpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgICAgY2xlYXJCdXR0b24uY2xpY2soKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChjb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtdGVzdGlkPVwiY2xlYXJlZFwiXScpKS50b0hhdmVUZXh0Q29udGVudCgneWVzJyk7XG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KGltYWdlQ2FjaGUuc2l6ZSgpKS50b0JlKDApO1xuICAgICAgZXhwZWN0KHJlc291cmNlQ2FjaGUuc2l6ZSgpKS50b0JlKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgn6YWN572u566h55CGJywgKCkgPT4ge1xuICAgIGl0KCflupTor6XliJvlu7rlm77lg4/kvJjljJbphY3nva4nLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb25maWcgPSBjcmVhdGVJbWFnZU9wdGltaXphdGlvbkNvbmZpZyh7XG4gICAgICAgIG1heFdpZHRoOiAxOTIwLFxuICAgICAgICBxdWFsaXR5OiAwLjksXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KGNvbmZpZy5tYXhXaWR0aCkudG9CZSgxOTIwKTtcbiAgICAgIGV4cGVjdChjb25maWcucXVhbGl0eSkudG9CZSgwLjkpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5jYWNoZUVuYWJsZWQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgn5bqU6K+l5Yib5bu66LWE5rqQ6aKE5Yqg6L296YWN572uJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0gY3JlYXRlUmVzb3VyY2VQcmVsb2FkQ29uZmlnKHtcbiAgICAgICAgcHJlbG9hZFByaW9yaXR5OiAnaGlnaCcsXG4gICAgICAgIHByZWxvYWRUaW1lb3V0OiA1MDAwLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChjb25maWcucHJlbG9hZFByaW9yaXR5KS50b0JlKCdoaWdoJyk7XG4gICAgICBleHBlY3QoY29uZmlnLnByZWxvYWRUaW1lb3V0KS50b0JlKDUwMDApO1xuICAgICAgZXhwZWN0KGNvbmZpZy5jYWNoZUVuYWJsZWQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=