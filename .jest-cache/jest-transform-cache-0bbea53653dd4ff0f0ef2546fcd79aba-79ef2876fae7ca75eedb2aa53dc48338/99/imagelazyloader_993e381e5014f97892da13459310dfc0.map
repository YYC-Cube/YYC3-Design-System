{"file":"/Users/yanyu/Downloads/yyc3-Design-System/src/utils/image-lazy-loader.ts","mappings":"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","names":[],"sources":["/Users/yanyu/Downloads/yyc3-Design-System/src/utils/image-lazy-loader.ts"],"sourcesContent":["/**\n * @file 图片懒加载工具\n * @description 提供基于 IntersectionObserver 的图片懒加载功能\n * @module utils/image-lazy-loader\n * @author YYC³\n * @version 1.0.0\n * @created 2026-02-22\n */\n\nexport interface LazyImageOptions {\n  rootMargin?: string;\n  threshold?: number | number[];\n  placeholder?: string;\n  errorPlaceholder?: string;\n  retryCount?: number;\n  retryDelay?: number;\n  onLoad?: (img: HTMLImageElement) => void;\n  onError?: (img: HTMLImageElement) => void;\n}\n\nexport interface LazyImageConfig {\n  enabled: boolean;\n  rootMargin: string;\n  threshold: number;\n  placeholder: string;\n  errorPlaceholder: string;\n  retryCount: number;\n  retryDelay: number;\n}\n\nconst defaultConfig: LazyImageConfig = {\n  enabled: true,\n  rootMargin: '50px',\n  threshold: 0.01,\n  placeholder:\n    'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PC9zdmc+',\n  errorPlaceholder:\n    'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZmZjZGNkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM5OTk5OTkiIGZvbnQtc2l6ZT0iMTQiPuaXoDwvdGV4dD48L3N2Zz4=',\n  retryCount: 3,\n  retryDelay: 1000,\n};\n\nlet globalConfig: LazyImageConfig = { ...defaultConfig };\n\nconst observerMap = new WeakMap<Element, IntersectionObserver>();\n\nexport const setLazyImageConfig = (config: Partial<LazyImageConfig>): void => {\n  globalConfig = { ...globalConfig, ...config };\n};\n\nexport const getLazyImageConfig = (): LazyImageConfig => {\n  return { ...globalConfig };\n};\n\nexport const createLazyImageObserver = (\n  callback: IntersectionObserverCallback,\n  options?: IntersectionObserverInit\n): IntersectionObserver => {\n  const defaultOptions: IntersectionObserverInit = {\n    rootMargin: globalConfig.rootMargin,\n    threshold: globalConfig.threshold,\n  };\n\n  return new IntersectionObserver(callback, { ...defaultOptions, ...options });\n};\n\nexport const observeLazyImage = (\n  element: HTMLImageElement,\n  options?: LazyImageOptions\n): (() => void) => {\n  if (!globalConfig.enabled || !('IntersectionObserver' in window)) {\n    loadImage(element, options);\n    return () => {};\n  }\n\n  const dataSrc = element.getAttribute('data-src');\n  if (!dataSrc) {\n    return () => {};\n  }\n\n  const observer = createLazyImageObserver((entries) => {\n    entries.forEach((entry) => {\n      if (entry.isIntersecting) {\n        loadImage(entry.target as HTMLImageElement, options);\n        observer.unobserve(entry.target);\n      }\n    });\n  });\n\n  observer.observe(element);\n  observerMap.set(element, observer);\n\n  return () => {\n    observer.unobserve(element);\n    observerMap.delete(element);\n  };\n};\n\nexport const loadImage = (\n  element: HTMLImageElement,\n  options?: LazyImageOptions,\n  retryCount: number = 0\n): void => {\n  const dataSrc = element.getAttribute('data-src');\n  if (!dataSrc) {\n    return;\n  }\n\n  const {\n    placeholder = globalConfig.placeholder,\n    errorPlaceholder = globalConfig.errorPlaceholder,\n    retryCount: maxRetries = globalConfig.retryCount,\n    retryDelay = globalConfig.retryDelay,\n    onLoad,\n    onError,\n  } = options || {};\n\n  const originalSrc = element.src;\n  element.src = placeholder;\n\n  const img = new Image();\n\n  img.onload = () => {\n    element.src = dataSrc;\n    element.removeAttribute('data-src');\n    element.classList.add('lazy-loaded');\n    onLoad?.(element);\n  };\n\n  img.onerror = () => {\n    if (retryCount < maxRetries) {\n      setTimeout(() => {\n        loadImage(element, options, retryCount + 1);\n      }, retryDelay);\n    } else {\n      element.src = errorPlaceholder;\n      element.classList.add('lazy-error');\n      onError?.(element);\n    }\n  };\n\n  img.src = dataSrc;\n};\n\nexport const unobserveLazyImage = (element: HTMLImageElement): void => {\n  const observer = observerMap.get(element);\n  if (observer) {\n    observer.unobserve(element);\n    observerMap.delete(element);\n  }\n};\n\nexport const observeAllLazyImages = (\n  selector: string = 'img[data-src]',\n  options?: LazyImageOptions\n): (() => void) => {\n  const images = document.querySelectorAll<HTMLImageElement>(selector);\n  const unobserveFunctions: Array<() => void> = [];\n\n  images.forEach((img) => {\n    unobserveFunctions.push(observeLazyImage(img, options));\n  });\n\n  return () => {\n    unobserveFunctions.forEach((unobserve) => unobserve());\n  };\n};\n\nexport const resetLazyImage = (element: HTMLImageElement, originalSrc: string): void => {\n  element.src = globalConfig.placeholder;\n  element.setAttribute('data-src', originalSrc);\n  element.classList.remove('lazy-loaded', 'lazy-error');\n  unobserveLazyImage(element);\n};\n\nexport const preloadLazyImage = (\n  src: string,\n  options?: LazyImageOptions\n): Promise<HTMLImageElement> => {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n\n    img.onload = () => {\n      options?.onLoad?.(img);\n      resolve(img);\n    };\n\n    img.onerror = () => {\n      options?.onError?.(img);\n      reject(new Error(`Failed to load image: ${src}`));\n    };\n\n    img.src = src;\n  });\n};\n\nexport const createLazyImageBatchLoader = (batchSize: number = 5, delay: number = 100) => {\n  let queue: HTMLImageElement[] = [];\n  let processing = false;\n\n  const processBatch = async () => {\n    if (processing || queue.length === 0) {\n      return;\n    }\n\n    processing = true;\n    const batch = queue.splice(0, batchSize);\n\n    await Promise.all(\n      batch.map((img) => {\n        return new Promise<void>((resolve) => {\n          const dataSrc = img.getAttribute('data-src');\n          if (dataSrc) {\n            const tempImg = new Image();\n            tempImg.onload = () => {\n              img.src = dataSrc;\n              img.removeAttribute('data-src');\n              img.classList.add('lazy-loaded');\n              resolve();\n            };\n            tempImg.onerror = () => {\n              img.src = globalConfig.errorPlaceholder;\n              img.classList.add('lazy-error');\n              resolve();\n            };\n            tempImg.src = dataSrc;\n          } else {\n            resolve();\n          }\n        });\n      })\n    );\n\n    processing = false;\n\n    if (queue.length > 0) {\n      setTimeout(processBatch, delay);\n    }\n  };\n\n  return {\n    add: (img: HTMLImageElement) => {\n      queue.push(img);\n      processBatch();\n    },\n    addBatch: (images: HTMLImageElement[]) => {\n      queue.push(...images);\n      processBatch();\n    },\n    clear: () => {\n      queue = [];\n    },\n    getQueueSize: () => queue.length,\n  };\n};\n\nexport const createProgressiveImageLoader = (\n  lowQualitySrc: string,\n  highQualitySrc: string,\n  element: HTMLImageElement,\n  options?: LazyImageOptions\n): void => {\n  element.src = lowQualitySrc;\n  element.classList.add('progressive-loading');\n\n  const highQualityImg = new Image();\n\n  highQualityImg.onload = () => {\n    element.src = highQualitySrc;\n    element.classList.remove('progressive-loading');\n    element.classList.add('progressive-loaded');\n    options?.onLoad?.(element);\n  };\n\n  highQualityImg.onerror = () => {\n    element.classList.remove('progressive-loading');\n    element.classList.add('progressive-error');\n    options?.onError?.(element);\n  };\n\n  highQualityImg.src = highQualitySrc;\n};\n\nexport const createLazyImageWithPlaceholder = (\n  element: HTMLImageElement,\n  placeholderColor: string = '#f0f0f0',\n  placeholderText: string = 'Loading...'\n): void => {\n  const canvas = document.createElement('canvas');\n  canvas.width = 100;\n  canvas.height = 100;\n  const ctx = canvas.getContext('2d');\n\n  if (ctx) {\n    ctx.fillStyle = placeholderColor;\n    ctx.fillRect(0, 0, 100, 100);\n\n    ctx.fillStyle = '#999';\n    ctx.font = '14px Arial';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillText(placeholderText, 50, 50);\n\n    element.src = canvas.toDataURL('image/png');\n  }\n\n  observeLazyImage(element);\n};\n\nexport const getLazyImageStats = (): {\n  total: number;\n  loaded: number;\n  error: number;\n  pending: number;\n} => {\n  const images = document.querySelectorAll<HTMLImageElement>(\n    'img[data-src], img.lazy-loaded, img.lazy-error'\n  );\n  const total = images.length;\n  const loaded = document.querySelectorAll<HTMLImageElement>('img.lazy-loaded').length;\n  const error = document.querySelectorAll<HTMLImageElement>('img.lazy-error').length;\n  const pending = total - loaded - error;\n\n  return { total, loaded, error, pending };\n};\n\nexport const destroyAllLazyImages = (): void => {\n  const images = document.querySelectorAll<HTMLImageElement>('img[data-src]');\n  images.forEach((img) => {\n    unobserveLazyImage(img);\n  });\n};\n\nexport const clearImageCache = (): void => {\n  const images = document.querySelectorAll<HTMLImageElement>('img[data-src]');\n  images.forEach((img) => {\n    unobserveLazyImage(img);\n    img.src = '';\n    img.removeAttribute('data-src');\n  });\n};\n\nexport default {\n  setLazyImageConfig,\n  getLazyImageConfig,\n  observeLazyImage,\n  unobserveLazyImage,\n  observeAllLazyImages,\n  loadImage,\n  resetLazyImage,\n  preloadLazyImage,\n  createLazyImageBatchLoader,\n  createProgressiveImageLoader,\n  createLazyImageWithPlaceholder,\n  getLazyImageStats,\n  destroyAllLazyImages,\n  clearImageCache,\n};\n"],"version":3}